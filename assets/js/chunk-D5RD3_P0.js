import{B as e}from"./chunk-C9B8R0dj.js";import{d as t,a}from"./chunk-DqV-AFJT.js";import{f as l,j as o,a as s,w as r,r as c,o as u,d as n,l as d,z as i,E as m,F as p,G as h,_ as v}from"./index-CxMgZ7OK.js";const f={class:"container"},b={class:"my_3"};function g(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!h(e)}const y=v({__name:"table1-el",setup(h){const v=4,y=10,k={HAD:{HADh:"列表1",HADd:"列表2",HADa:"列表3"},HHAD:{HHADh:"列表4",HHADd:"列表5",HHADa:"列表6"},crsList:{s00s00:"0.0",s00s01:"0.1",s00s02:"0.2",s00s03:"0.3",s00s04:"0.4",s00s05:"0.5",s01s00:"1.0",s01s01:"1.1",s01s02:"1.2",s01s03:"1.3",s01s04:"1.4",s01s05:"1.5",s02s00:"2.0",s02s01:"2.1",s02s02:"2.2",s02s03:"2.3",s02s04:"2.4",s02s05:"2.5",s03s00:"3.0",s03s01:"3.1",s03s02:"3.2",s03s03:"3.3",s04s00:"4.0",s04s01:"4.1",s04s02:"4.2",s05s00:"5.0",s05s01:"5.1",s05s02:"5.2","s-1sh":"a其他","s-1sd":"b其他","s-1sa":"c其他"},hafuList:{hh:"aa",hd:"ab",ha:"ac",dh:"ba",dd:"bb",da:"bc",ah:"ca",ad:"cb",aa:"cc"},ttgList:{s0:"00",s1:"01",s2:"02",s3:"03",s4:"04",s5:"05",s6:"06",s7:"07"}},D=[{prop:"matchNumStr",label:"编号",group:0,minWidth:100,disabled:!0,fixed:"left",color:!0},{prop:"matchDate",label:"时间",group:0,minWidth:120,disabled:!0,fixed:"left"},{prop:"allName",label:"菜系",group:0,minWidth:120},...Object.entries(k).map((([e,t])=>Object.entries(t).map((([t,a])=>({prop:t,label:a,group:e,minWidth:85,checkbox:!0}))))).flat(1)],x=l([]),A=l([]);(async()=>{const{value:{matchInfoList:e}}=await new Promise(((e,a)=>{setTimeout((()=>{e(t)}),300)})),l=e.flatMap((e=>e.subMatchList)).filter((e=>"Selling"===e.matchStatus)).map((e=>new Promise((async(t,l)=>{const o={matchId:e.matchId,matchNumStr:e.matchNumStr,matchDate:e.matchDate,homeTeamAllName:e.homeTeamAllName,leagueAllName:e.leagueAllName,backColor:e.backColor};e.oddsList.forEach((e=>{["HAD","HHAD"].includes(e.poolCode)&&(o[`${e.poolCode}a`]={value:e.a,prop:`${e.poolCode}a`,checked:!1},o[`${e.poolCode}d`]={value:e.d,prop:`${e.poolCode}d`,checked:!1},o[`${e.poolCode}h`]={value:e.h,prop:`${e.poolCode}h`,checked:!1})}));const{value:{oddsHistory:s}}=await new Promise(((e,t)=>{setTimeout((()=>{e(a)}),300)}));["crsList","hafuList","ttgList"].forEach((e=>{var t;const a=null==(t=s[e])?void 0:t.reduce(((e,t)=>new Date(`${e.updateDate} ${e.updateTime}`)<new Date(`${t.updateDate} ${t.updateTime}`)?t:e),{updateDate:"1970",updateTime:"0:0"});Object.keys(a).forEach((e=>{o[e]={value:a[e],prop:e,checked:!1}}))})),t(o)})))),o=await Promise.all(l);x.value=D.map((e=>({...e,align:"center",active:e.active??e.disabled??!0,render:({row:t,column:a})=>e.checkbox&&t[a.property]?s(c("el-checkbox"),{modelValue:t[a.property].checked,"onUpdate:modelValue":e=>t[a.property].checked=e},{default:()=>[t[a.property].value]}):"allName"===a.property?`${t.homeTeamAllName} ${t.leagueAllName}`:t[a.property]}))),A.value=o})();const S=()=>{const e=l(x.value.map((e=>({...e,value:e.prop})))),t=e.value.filter((e=>e.disabled)).map((e=>e.value)),a=l(e.value.filter((e=>e.active)).map((e=>e.value))),o=i((()=>a.value.length===e.value.length)),r=i((()=>a.value.length>0&&a.value.length<e.value.length)),u=i((()=>{const t=a.value,l=e.value,o={};return Object.keys(k).forEach((e=>{const a=l.filter((t=>t.group===e)),s=t.filter((e=>a.find((t=>e===t.prop))));o[e]={checkAll:s.length===a.length,indeterminate:s.length>0&&s.length<a.length}})),o}));m({customStyle:{maxWidth:"60%"},message:()=>{let l;return s(p,null,[s("div",null,[s(c("el-checkbox"),{"model-value":o.value,indeterminate:r.value,onChange:()=>o.value?a.value=JSON.parse(JSON.stringify(t)):a.value=e.value.filter((e=>e.active)).map((e=>e.value))},{default:()=>[d("全选")]}),Object.keys(k).map((t=>s(c("el-checkbox"),{"model-value":u.value[t].checkAll,indeterminate:u.value[t].indeterminate,onChange:()=>u.value[t].checkAll?a.value=a.value.filter((a=>{var l;return(null==(l=e.value.find((e=>e.prop===a)))?void 0:l.group)!==t})):a.value=[...new Set([...a.value,...e.value.filter((e=>e.group===t)).map((e=>e.prop))])]},g(t)?t:{default:()=>[t]})))]),s(c("el-divider"),{class:"my_3"},null),s(c("el-checkbox-group"),{modelValue:a.value,"onUpdate:modelValue":e=>a.value=e},g(l=e.value.map((e=>s(c("el-checkbox"),{label:e.value,disabled:e.disabled},{default:()=>[e.label]}))))?l:{default:()=>[l]})])}}).then((()=>{const e=a.value;x.value.forEach((t=>t.active=e.includes(t.prop)))}))},w=({row:e,column:t})=>"matchNumStr"===t.property&&{backgroundColor:`#${e.backColor}`,color:"#fff"},N=()=>{const e={Table:[{MemoBox3:(()=>{const e=JSON.parse(JSON.stringify(x.value));return A.value.filter((t=>Object.values(t).find((t=>{var a;return(null==t?void 0:t.checked)&&(null==(a=e.find((e=>e.prop===(null==t?void 0:t.prop))))?void 0:a.active)})))).map((t=>({matchDate:t.matchDate,matchId:t.matchId,matchNumStr:t.matchNumStr,checkList:e.filter((e=>{var a;return(null==(a=t[e.prop])?void 0:a.checked)&&(null==e?void 0:e.active)})).map((e=>t[e.prop]))})))})().map((e=>[e.matchNumStr,...e.checkList.reduce(((e,t,a)=>{let l=e;return a%v?l[l.length-1]+=`+${t.value}`:l?l[l.length]=`+${t.value}`:l=[t.value],l}),"")])).concat(Array.from({length:y},(()=>"xxx"))).flat().slice(0,y).join("</br>"),MemoBox6:"标题内容",MemoBox11:(new Date).toFormat("YYYY/MM/DD")}]};m({customStyle:{maxWidth:"80%"},center:!0,message:()=>s("div",{id:"report_holder",class:"d_inline_block border_all"},null),confirmButtonText:"打印"}).then((()=>{const e=document.querySelector("#report_holder"),t=document.querySelectorAll('[id^="_gridcss"]'),a=e.outerHTML,l=document.createElement("iframe");document.body.appendChild(l),l.contentDocument.write([...t].map((e=>e.outerHTML)).join("")),l.contentDocument.write('<style media="print">@page{size:auto;margin:0;}</style>'),l.contentDocument.write(a),l.setAttribute("style","position:absolute;width:0px;height:0px;left:-500px;top:-500px;"),l.contentDocument.body.setAttribute("style","margin:0px"),l.contentDocument.close(),l.contentWindow.print(),setTimeout((()=>{document.body.removeChild(l)}),1e3)})),window.rubylong.grhtml5.insertReportViewer("report_holder","./file/table1Grf.grf",e).start()},_=({data:e,columns:t,cellStyle:a})=>s(c("el-table"),{data:e,cellStyle:a,border:!0,stripe:!0},{default:()=>[i((()=>t.filter((e=>e.active)).map((e=>s(c("el-table-column"),e,{default:e.render}))))).value]});return(t,a)=>{const l=c("el-button"),i=c("a-layout-content");return u(),o("div",f,[s(e,{overlayShow:""}),s(i,null,{default:r((()=>[s(_,{data:A.value,columns:x.value,cellStyle:w},null,8,["data","columns"]),n("div",b,[s(l,{class:"mx_2",onClick:S},{default:r((()=>[d("修改显示列")])),_:1}),s(l,{class:"mx_2",onClick:N},{default:r((()=>[d("导出预览")])),_:1})])])),_:1})])}}},[["__scopeId","data-v-dea34058"]]);export{y as default};
