var gr={},DEBUG=0;!function(){gr.const_={VERSION:"6.8.23.0315",ID_REPORT_STYLE:"_gridcss",ID_DETAILGRID:"_griddg",ATTR_CONTENT_RECNO:"_grRecNo",ATTR_GROUPH_INDEX:"_grGHIndex",ATTR_GROUPF_INDEX:"_grGFIndex",ATTR_GROUP_RECNO:"_grGRecNo",ATTR_FIELD:"_grfld",CSS_DG:"_grdg",CSS_SH:"_grcsssh",CSS_CB:"_grcsscb",BIG_AMT_NUMBER:"零壹贰叁肆伍陆柒捌玖",HZ_NUMBER:"一二三四五六七八九十零",HZ_NEGATIVE:"负",HZ_ZERO_YUAN:"零元整",HZ_AMT_STEP:"元拾佰仟万拾佰仟亿拾佰仟",HZ_AMT_UNIT:"整角分",HZ_DATETIME_UNIT:"周日星期天",MILLISECONDS_DAY:864e5,TIMEZONE_OFFSET:6e4*(new Date).getTimezoneOffset()},gr.enum_={PenStyle:{Solid:0,Dash:1,Dot:2,DashDot:3,DashDotDot:4},BorderStyle:{DrawLeft:1,DrawTop:2,DrawRight:4,DrawBottom:8},BackStyle:{Normal:1,Transparent:2},TextAlign:{TopLeft:17,TopCenter:18,TopRight:20,TopJustiy:144,BottomLeft:65,BottomCenter:66,BottomRight:68,BottomJustiy:192,MiddleLeft:33,MiddleCenter:34,MiddleRight:36,MiddleJustiy:160},TextOrientation:{Default:0,U2DL2R0:5,D2UL2R1:22,U2DR2L0:9,U2DR2L1:25,Invert:58,L2RD2U0:38,L2RD2U1:54},ParameterDataType:{String:1,Integer:2,Float:3,Boolean:5,DateTime:6},FieldType:{String:1,Integer:2,Float:3,Currency:4,Boolean:5,DateTime:6,Binary:7},ControlType:{StaticBox:1,ShapeBox:2,SystemVarBox:3,FieldBox:4,SummaryBox:5,RichTextBox:6,PictureBox:7,MemoBox:8,SubReport:9,Line:10,Chart:11,Barcode:12,FreeGrid:13},SummaryFun:{Sum:1,Avg:2,Count:3,Min:4,Max:5,Var:6,VarP:7,StdDev:8,StdDevP:9,AveDev:10,DevSq:11,CountBlank:12,CountA:13,Distinct:14,AvgA:15,MinN:16,MaxN:17,StrMin:18,StrMax:19,VarA:20,VarPA:21,StdDevA:22,StdDevPA:23,AveDevA:24,DevSqA:25,SumAbs:26,SumAcc:27,GroupSumAcc:28},MathFun:{round45:1,round465:2,abs:5,acos:6,asin:7,atan:8,atan2:9,ceil:15,cos:16,exp:17,floor:18,log:19,maxArray:20,minArray:21,pow:22,round:23,sin:24,sqrt:25,tan:26},SystemVarType:{CurrentDateTime:1,RecordNo:4,RowNo:8,RecordCount:19,GroupNo:20,GroupCount:21,GroupRowNo:22,GroupRowCount:23},AnchorStyle:{Left:1,Top:2,Right:4,Bottom:8},AlignColumnSideStyle:{Left:1,Right:2,Both:3},DockStyle:{None:0,Left:1,Top:2,Right:3,Bottom:4,Fill:5},CenterStyle:{None:0,Horizontal:1,Vertical:2,Both:3},ShiftMode:{Never:0,Always:1,WhenOverLapped:2},Unit:{Cm:1,Inch:2},ShapeBoxType:{Circle:1,Ellipse:2,Rectangle:3,RoundRect:4,RoundSquare:5,Square:6,Line:7},PictureAlignment:{TopLeft:1,TopRight:2,Center:3,BottomLeft:4,BottomRight:5},PictureSizeMode:{Clip:1,Stretch:2,Zoom:3,EnsureFullView:4,Tile:5},PictureTransparentMode:{None:0,Overlying:1,Background:2},PictureRotateMode:{None:0,Left:1,Right:2,Flip:3,Mirror:4},ChartType:{BarChart:1,PieChart:2,LineChart:3,StackedBarChart:4,XYScatterChart:5,XYLineChart:6,CurveLineChart:7,XYCurveLineChart:8,Bubble:9,StackedBar100Chart:10,ColumnChart:11,StackedColumnChart:12,StackedColumn100Chart:13},ChartVarType:{XVal:1,YVal:2,ZVal:3,YVal100ByGroup:4,YVal100BySeries:5,YValTotalByGroup:6,YValTotalBySeries:7,SeriesLabel:8,GroupLabel:9},PointMarkerStyle:{None:-1,Square:0,SquareCheck:1,SquareCross:2,Circle:3,CirclePoint:4,CircleCross:5,Dimond:6,Triangle:7,Cross:8,Cross4:9,Star4:10,Star5:11,Star6:12,Star10:13},BarcodeType:{Code25Intlv:1,Code25Ind:2,Code25Matrix:3,Code39:4,Code39X:5,Code128A:6,Code128B:7,Code128C:8,Code93:9,Code93X:10,CodeMSI:11,CodePostNet:12,CodeCodabar:13,CodeEAN8:14,CodeEAN13:15,CodeUPC_A:16,CodeUPC_E0:17,CodeUPC_E1:18,CodeUPC_Supp2:19,CodeUPC_Supp5:20,CodeEAN128A:21,CodeEAN128B:22,CodeEAN128C:23,Code128Auto:24,PDF417:50,QRCode:51,DataMatrix:52,GS1DataMatrix:53,GS1QRCode:54},BarcodeCaptionPosition:{None:1,Above:2,Below:3},BarcodeDirection:{LeftToRight:1,RightToLeft:2,TopToBottom:3,BottomToTop:4},DtmxEncoding:{Auto:2,Ascii:3,C40:4,Text:5,X12:6,Edifact:7,Base256:8},DtmxMatrixSize:{Auto:2,"10x10":4,"12x12":5,"14x14":6,"16x16":7,"18x18":8,"20x20":9,"22x22":10,"24x24":11,"26x26":12,"32x32":13,"36x36":14,"40x40":15,"44x44":16,"48x48":17,"52x52":18,"64x64":19,"72x72":20,"80x80":21,"88x88":22,"96x96":23,"104x104":24,"120x120":25,"132x132":26,"144x144":27,"8x18":28,"8x32":29,"12x26":30,"12x36":31,"16x36":32,"16x48":33},StringAlignment:{Near:1,Center:2,Far:3},PeriodType:{None:0,Day:1,Week:2,ThirdMonth:3,HalfMonth:4,Month:5,Quarter:6,HalfYear:7,Year:8,Calendar:9},OCGroupHeaderVAlign:{Top:1,Bottom:2,Middle:3},controlLayout:{auto:0,table:1,absolute:2},detailgridResize:{asDesign:0,fitWidth:1,onlyGrow:2}},gr.locale={supportIntl:!!window.Intl,decimalSep:".",thousandSep:",",dateSep:"-",timeSep:":",textAM:"上午",textPM:"下午",currencySymbol:"￥"},gr.script={calcExp:function(expText){var result=NaN;expText="result="+expText;try{eval(expText)}catch(e){result=NaN}return result},execEvent:function(scriptText,scriptName,Sender,Report){var globalScript=Report.GlobalScript;try{globalScript&&(scriptText+="\n"+globalScript),eval(scriptText)}catch(e){Sender.report.root._scriptFailed||(alert("执行报表脚本 '"+scriptName+"' 失败"+(Sender.Name?"\n对象名称: "+Sender.Name:"")+"\n错误信息: "+e.toString()+"\n脚本代码:\n"+scriptText),Sender.report.root._scriptFailed=1)}}}}(),function(e){var t=gr.enum_,r=gr.const_,o=gr.helper={},a=gr.common={},n=r.MILLISECONDS_DAY,i=r.TIMEZONE_OFFSET,l=o.assignJSONMembers=function(t,r,o){var a,n,i;for(n in o===e&&(o=t.report.isWR),o&&(i=gr.wr.wrPropNameDecode),r)"object"!=typeof(a=r[n])&&(o&&(n=i(n)),t.hasOwnProperty(n)&&(t[n]=a))},s=o.enumMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=x(r,e[t]))},u=o.enumBitMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=S(r,e[t]))},c=o.colorMemberValid=function(e,t,r){"number"!=typeof e[t]&&(e[t]=parseInt("0x"+e[t],16)|Math.max(0,Math.min(Math.round(255*r),255))<<24)},d=o.penStyleText=function(e){return g(e.Width)+" "+{Solid:"solid",Dash:"dashed",Dot:"dotted",DashDot:"dashed",DashDotDot:"dotted"}[b(t.PenStyle,e.Style)]+" "+w(e.Color)},h=o.fontHeight=function(e){return 4*e.Size/3e4},p=(o.fontString=function(e,t,r){return t+" "+g(e)+" "+r},o.fontCSSText=function(e){var t="",r=[];return e.Italic&&r.push("italic"),e.Bold&&r.push("bold"),r.push(g(h(e)),e.Name),r.forEach((function(e){t&&(t+=" "),t+=e})),t}),f=(o.intFixed=function(e,t){var r,o=e+"";if(t>0)if(0>(r=t-o.length))o=o.substr(-r);else for(;r-- >0;)o="0"+o;return o},function(e){var t=e.toFixed(2),r=t.length-1;return"0"===t.charAt(r)&&("0"===t.charAt(r-1)&&(r-=2),t=t.substr(0,r)),t}),g=o.pixelsToHtml=function(e){return f(e)+"px"},m=(o.percentToHtml=function(e){return f(e)+"%"},o.cloneDate=function(e){return new Date(e)}),C=o.confirmDateValue=function(t){return Date.prototype.isPrototypeOf(t)||("string"==typeof t?(o=Date.parse(t),t=t?isNaN(o)?(a=t.indexOf(":"),n=a>0&&8>a,i=t.split(/[\:\-\/ ]/g),l=i.length,s=l>0?+i[0]:0,u=l>1?+i[1]:0,c=l>2?+i[2]:0,d=l>3?+i[3]:0,h=l>4?+i[4]:0,p=l>5?+i[5]:0,isNaN(u)&&(a=i[1],u=r.HZ_NUMBER.indexOf(a.charAt(0))+1,a.length>=3&&(u+=r.HZ_NUMBER.indexOf(a.charAt(1))+1)),n&&(a=s,s=d,d=a,a=u,u=h,h=a,a=c,c=p,p=a),c>31&&(a=s,s=c,c=a,a=u,u=c,c=a),u>12&&(a=u,u=c,c=a),new Date(s,--u,c,d,h,p)):new Date(o):e):((o=new L).AsFloat=+t,t=o.value)),t;var o,a,n,i,l,s,u,c,d,h,p},T=(o.confirmCloneDateValue=function(e){return Date.prototype.isPrototypeOf(e)?m(e):C(e)},o.strimDate=function(e){var t=e.getTime();e.setTime(t-(t-6e4*e.getTimezoneOffset())%n)},o.incDate=function(e){e.setTime(e.getTime()+n)},o.incDate2=function(e,t){e.setTime(e.getTime()+t*n)}),x=(o.periodRangeBy=function(e,t){function r(){11>s?++s:(++u,s=0)}var o,a=e.getDate(),n=e.getMonth(),i=e.getFullYear(),l=a,s=n,u=i;if(2>=t)o={begin:m(e),end:m(e)},T(o.end,1===t?1:7);else{switch(t){case 3:10>=a?(a=1,l=11):20>=a?(a=11,l=21):(a=21,r(),l=1);break;case 4:15>=a?(a=1,l=16):(a=16,r(),l=1);break;case 5:a=l=1,r();break;case 6:a=l=1,s=n-=n%3,r(),r(),r();break;case 7:a=l=1,(s=6>(n=6>n?0:6)?6:0)||u++;break;case 8:a=l=1,n=s=0,u++}o={begin:new Date(i,n,a),end:new Date(u,s,l)}}return o},o.periodRangeNext=function(e,t){function r(){11>s?++s:(++u,s=0)}var o,a=e.begin.getDate(),n=e.begin.getMonth(),i=e.begin.getFullYear(),l=a,s=n,u=i;if(2>=t)o={begin:m(e.end),end:m(e.end)},T(o.end,1===t?1:7);else{switch(t){case 3:10>=a?(a=11,l=21):20>=a?(a=21,l=1,r()):(a=1,l=11,r(),i=u,n=s);break;case 4:15>=a?(a=16,l=1,r()):(a=1,l=16,r(),i=u,n=s);break;case 5:r(),i=u,n=s,r();break;case 6:r(),r(),r(),i=u,n=s,a=l,r(),r(),r();break;case 7:n?(n=0,i++,s=6):(n=6,s=0),u++;break;case 8:i++,u++,u++}o={begin:new Date(i,n,a),end:new Date(u,s,l)}}return o},o.confirmBooleanValue=function(e){if(e.constructor===Boolean.prototype.constructor)return e;if("string"==typeof e){if(e.toLowerCase(),"TRUE"===e||"true"===e)return!0;e=parseInt(e)}return!!e},o.ensureNameText=function(e){return/^[A-Za-z_\u0100-\uffff][\w\u0100-\uffff]*$/.test(e)||(e="["+e+"]"),e},o.enumName2Value=function(t,r){var o=t[r];if(o===e){for(var a in r=r.toUpperCase(),t)if(a.toUpperCase()===r)return t[a];o=-1}return o}),b=o.enumValue2Name=function(e,t){for(var r in e)if(e[r]===t)return r;return""},S=function(e,t){var r,o,a,n=0;for(a=(r=(t=t.substring(1,t.length-1)).split("|")).length,o=0;a>o;o++)n+=e[r[o]]||0;return n},v=o.rgba2color=function(e,t,r,o){return y(e|t<<8|r<<16,o)},y=o.colorAlpha=function(e,t){return e|Math.max(0,Math.min(Math.round(255*t)))<<24},F=o.color2rgba=function(e){return{r:255&e,g:e>>8&255,b:e>>16&255,a:4278190080&e?(e>>24&255)/255:1}},w=o.colorValue2Html=function(e){function t(e){return(16>e?"0":"")+e.toString(16)}var r=F(e);return 1===r.a?"#"+t(r.r)+t(r.g)+t(r.b):"rgba("+r.r+","+r.g+","+r.b+","+f(r.a)+")"},D=o.colorIsBlack=function(e){return 16777215&e},A=(o.decodeTextColor=function(e){var t,r,o,a,n;return"rgb("===e.substr(0,4)&&(-1!==(t=e.indexOf(")",4))&&(3===(r=(e=e.substring(4,t)).split(",")).length&&(o=parseInt(r[0]),a=parseInt(r[1]),n=parseInt(r[2]),o>=0&&255>=o&&a>=0&&255>=a&&n>=0&&255>=n)))&&{color:rgb(o,a,n),index:t+1}},o.colorGradientLight=function(e){var t=F(e),r=120/255;return t.r+=(255-t.r)*r,t.g+=(255-t.g)*r,t.b+=(255-t.b)*r,t.r>255&&(t.r=255),t.g>255&&(t.g=255),t.b>255&&(t.b=255),v(t.r,t.g,t.b,t.a)},o.colorGradientDark=function(e){var t=F(e),r=30/255;return t.r-=t.r*r,t.g-=t.g*r,t.b-=t.b*r,t.r<0&&(t.r=0),t.g<0&&(t.g=0),t.b<0&&(t.b=0),v(t.r,t.g,t.b,t.a)},o.prototypeLinkExtend=function(e,t){function r(){}var o,a=e.prototype;for(var n in r.prototype=t.prototype,o=new r,a)o[n]=a[n];e.prototype=o,e.prototype.constructor=e},o.prototypeCopyExtend=function(e,t){var r=t.prototype,o=e.prototype;for(var a in r)o.hasOwnProperty(a)||(o[a]=r[a]);o.constructor=e},o.createArray=function(e,t){for(var r=[],o=0;o++<e;)r.push(t);return r},o.assignObjectEx=function(e,t,r){var o;for(var a in t)t.hasOwnProperty(a)&&(o=t[a],r&&"object"===typeof o?(e[a]||(e[a]={}),P(e[a],o)):e[a]=o);return e}),P=o.assignObject=function(e,t){A(e,t,1)},R=(o.assignObjectAtom=function(e,t){var r;for(var o in t)t.hasOwnProperty(o)&&("object"!=typeof(r=t[o])&&(e[o]=r));return e},o.compareObject=function(e,t){var r;if(e===t)return 1;if(!e||!t)return 0;for(var o in e)if("object"===(r=typeof e[o])){if(!R(e[o],t[o]))return 0}else if("function"!==r&&e[o]!==t[o])return 0;return 1}),B=(o.parseXML=function(t){var r;/\s/g.test(t)&&(t=function(){for(var e,r=0,o=t.indexOf("<",r),a=[];o>=0;)o>r&&(e=t.substring(r,o),/\S/g.test(e)&&a.push(e)),r=o,o=t.indexOf(">",r+1),a.push(t.substring(r,++o)),r=o,o=t.indexOf("<",r);return a}().join(""));try{r=(new DOMParser).parseFromString(t,"text/xml")}catch(o){r=e}return r},o.xmlToReportDataJSON=function(e){var t,r,o,a,n="",i={};for(o=e.childNodes[0].firstChild;o;){for(o.nodeName!==n&&(n=o.nodeName,r=[],i[o.nodeName]=r),t={},a=o.firstChild;a;)t[a.nodeName]=a.hasOwnProperty("text")?a.text:a.textContent,a=a.nextSibling;r.push(t),o=o.nextSibling}return i},o.getRelativePosition=function(e){var t,r,o=e.originalEvent||e,a=(e.currentTarget||e.srcElement).getBoundingClientRect();return o.touches?(t=o.touches[0].clientX-a.left,r=o.touches[0].clientY-a.top):(t=o.clientX-a.left,r=o.clientY-a.top),{x:t,y:r}},o.addEvent=function(e,t,r){e.addEventListener?e.addEventListener(t,r):e.attachEvent?e.attachEvent("on"+t,r):e["on"+t]=r}),N=o.removeEvent=function(e,t,r){e.removeEventListener?e.removeEventListener(t,r,!1):e.detachEvent?e.detachEvent("on"+t,r):e["on"+t]=noop},I=(o.bindEvents=function(e,t,r){e.events||(e.events={}),t.forEach((function(t){e.events[t]=function(){r.apply(e,arguments)},B(e.canvas,t,e.events[t])}))},o.unbindEvents=function(e,t){t.forEach((function(t,r){N(e.canvas,r,t)}))},o.toRadians=function(e){return e*Math.PI/180}),L=(o.toDegree=function(e){return 180*e/Math.PI},a.DateTime=function(){this.value=new Date});a.DateTime.prototype={get Year(){return this.value.getFullYear()},get Month(){return this.value.getMonth()+1},get Day(){return this.value.getDate()},get Hour(){return this.value.getHours()},get Minute(){return this.value.getMinutes()},get Second(){return this.value.getSeconds()},get DayOfWeek(){return this.value.getDay()},get DayOfYear(){var e=this.value,t=e.getFullYear();return(new Date(t,e.getMonth(),e.getDate()).getTime()-new Date(t,0,1).getTime())/n+1},get AsFloat(){return(this.value.getTime()+new Date(1970,0,1).getTime()-new Date(1899,11,30).getTime()-i)/n},set AsFloat(e){this.value.setTime(e*n+new Date(1899,11,30).getTime()-new Date(1970,0,1).getTime()+i)},ValueFromDate:function(e,t,r){this.value=new Date(e,t-1,r)},ValueFromDateTime:function(e,t,r,o,a,n){this.value=new Date(e,t-1,r,o,a,n)},Format:function(e){return new gr.format.DateTimeFormatter(e).format(this.value)}};var E=a.Rect=function(e,t,r,o){var a=this;a.left=e,a.top=t,a.right=r,a.bottom=o};a.Rect.prototype={clone:function(){var e=this;return new a.Rect(e.left,e.top,e.right,e.bottom)},IsRectEmpty:function(){var e=this;return e.left>=e.right||e.top>=e.bottom},PtInRect:function(e,t){var r=this;return r.left<=e&&e<r.right&&r.top<=t&&t<r.bottom},Width:function(){return this.right-this.left},Height:function(){return this.bottom-this.top},SetRect:function(e,t,r,o){var a=this;a.left=e,a.top=t,a.right=r,a.bottom=o},InflateRect:function(e,t){var r=this;r.left-=e,r.top-=t,r.right+=e,r.bottom+=t},OffsetRect:function(e,t){var r=this;r.left+=e,r.top+=t,r.right+=e,r.bottom+=t},IntersectRect:function(e){var t=this;t.left=Math.max(t.left,e.left),t.top=Math.max(t.top,e.top),t.right=Math.min(t.right,e.right),t.bottom=Math.min(t.bottom,e.bottom)}};var V=a.Pen=function(t,r,o){var a=this;t===e&&(t=1),r===e&&(r=0),o===e&&(o=0),a.Width=t,a.Color=y(r,1),a.Style=o};V.prototype={clone:function(){var e=this,t=new V;return t.Width=e.Width,t.Style=e.Style,t.Color=e.Color,t},loadFromJSON:function(e,r,o){e&&(l(this,e,o),s(this,"Style",t.PenStyle),c(this,"Color",r))},getDashStyle:function(){var e;switch(this.Style){case 1:e=[2,2];break;case 2:e=[1,1];break;case 3:e=[2,1,1,1];break;case 4:e=[2,1,1,1,1,1];break;default:e=[]}return e}};var M=a.Border=function(e){var t=this;t.Styles=e,t.Shadow=!1,t.ShadowWidth=4,t.ShadowColor=0,t.Pen=new V};a.Border.prototype={loadFromJSON:function(e,r,o){var a=this;e&&(l(a,e,o),u(a,"Styles",t.BorderStyle),c(a,"ShadowColor"),e.Pen&&a.Pen.loadFromJSON(e.Pen,r,o))},clone:function(){var e=this,t=new M;return t.Styles=e.Styles,t.Shadow=e.Shadow,t.ShadowWidth=e.ShadowWidth,t.ShadowColor=e.ShadowColor,t.Pen=e.Pen.clone(),t},getLeftWidth:function(){return 1&this.Styles?this.Pen.Width:0},getRightWidth:function(){var e=this;return(4&e.Styles?e.Pen.Width:0)+(e.Shadow?e.ShadowWidth:0)},getTopWidth:function(){return 2&this.Styles?this.Pen.Width:0},getBottomWidth:function(){var e=this;return(8&e.Styles?e.Pen.Width:0)+(e.Shadow?e.ShadowWidth:0)}};var k=a.Font=function(){var e=this;e.Size=97500,e.Bold=!1,e.Italic=!1,e.Underline=!1,e.Strikethrough=!1,e.Name=""};k.prototype={loadFromJSON:function(e,t){e&&l(this,e,t)},clone:function(){var e=this,t=new k;return t.Size=e.Size,t.Bold=e.Bold,t.Italic=e.Italic,t.Underline=e.Underline,t.Strikethrough=e.Strikethrough,t.Name=e.Name,t}},a.FontWrapper=function(e){this.parentFont=e},a.FontWrapper.prototype={loadFromJSON:function(e,t){e&&(this.prepareModify(),this.font.loadFromJSON(e,t))},assign:function(e){e.font?this.font=e.font.clone():delete this.font},prepareModify:function(){var e=this;e.font||(e.font=e.parentFont.UsingFont().clone())},Clone:function(){var e=new a.FontWrapper(this.parentFont);return e.font=this.UsingFont().clone(),e},UsingFont:function(){var e=this;return e.font?e.font:e.parentFont.UsingFont()},get Name(){return this.UsingFont().Name},set Name(e){this.prepareModify(),this.font.Name=e},get Point(){return this.UsingFont().Size/1e4},set Point(e){this.prepareModify(),this.font.Size=1e4*e},get Bold(){return this.UsingFont().Bold},set Bold(e){this.prepareModify(),this.font.Bold=e},get Italic(){return this.UsingFont().Italic},set Italic(e){this.prepareModify(),this.font.Italic=e},get Underline(){return this.UsingFont().Underline},set Underline(e){this.prepareModify(),this.font.Underline=e},get Strikethrough(){return this.UsingFont().Strikethrough},set Strikethrough(e){this.prepareModify(),this.font.Strikethrough=e}};var H=a.TextFormat=function(){var e=this;e.WordWrap=!1,e.EndEllipsis=!1,e.TextAlign=33,e.TextOrientation=0,e.TextAngle=0,e.CharacterSpacing=0,e.LineSpacing=0,e.FirstCharIndent=0,e.HtmlTags=!1};H.prototype={loadFromJSON:function(e,r){var o=this,a="CharSpacing",n="LnSpacing";e&&(l(o,e,r),r&&(a=gr.wr.wrPropNameEncode(a),n=gr.wr.wrPropNameEncode(n)),(a=e[a])&&(o.CharacterSpacing=a),(n=e[n])&&(o.LineSpacing=n),s(o,"TextAlign",t.TextAlign),s(o,"TextOrientation",t.TextOrientation))},Clone:function(){var e=this,t=new H;return t.WordWrap=e.WordWrap,t.EndEllipsis=e.EndEllipsis,t.TextAlign=e.TextAlign,e.TextOrientation=e.TextOrientation,e.TextAngle=e.TextAngle,t.CharacterSpacing=e.CharacterSpacing,t.LineSpacing=e.LineSpacing,t.FirstCharIndent=e.FirstCharIndent,t}},a.Context=function(e){var t=this;t.ctx=e,e.textBaseline="top",t.pens=[new V],t.fills=[e.fillStyle],t.fonts=[],t.clips=[]},a.Context.prototype={get width(){return this.ctx.canvas.width},get height(){return this.ctx.canvas.height},get usingFont(){var e=this.fonts;return e[e.length-1]},selectFillStyle:function(e){this.fills.push(e),this.ctx.fillStyle=e},selectFillColor:function(e){this.selectFillStyle(w(e))},restoreFillStyle:function(){var e=this.fills;e.pop(),this.ctx.fillStyle=e[e.length-1]},selectPen:function(e){this.pens.push(e),this._applyPen()},selectPen2:function(e,t,r){this.selectPen(new V(e,t,r))},restorePen:function(){this.pens.pop(),this._applyPen()},selectFont:function(e){var t=this.fonts;e!==t[t.length-1]&&(this.ctx.font=p(e)),t.push(e)},restoreFont:function(){var e=this,t=e.fonts,r=t.pop(),o=t[t.length-1];t.length>0?o!==r&&(e.ctx.font=p(o)):e.ctx.font=""},fontSizeTo:function(e){var t=this.usingFont.clone();t.Size=e,this.selectFont(t)},pushClipRect:function(e,t,r,o){var a=this.ctx,n=this.clips,i=n.length,l=new E(e,t,e+r,t+o);i&&l.IntersectRect(n[i-1]),n.push(l),a.beginPath(),a.rect(l.left,l.top,l.Width(),l.Height()),a.clip()},popClipRect:function(){var e=this.ctx,t=e.canvas,r=this.clips,o=r.length;rect,r.pop(rect),rect=o>1?r[o-2]:new E(0,0,t.width,t.height),e.beginPath(),e.rect(rect.left,rect.top,rect.Width(),rect.Height()),e.clip()},measureTextWidth:function(e){return this.ctx.measureText(e).width},measureTextHeight:function(e){return h(this.usingFont)},drawText:function(e,t,r){this.ctx.fillText(e,t,r)},drawTextCenter:function(e,t,r){var o=this.ctx;o.textAlign="center",o.fillText(e,t,r),o.textAlign="start"},drawTextAlign:function(e,t,r,o,a,n,i){var l,s=this,u=h(s.usingFont),c=2&n;32&n?r+=(a-u)/2:64&n&&(r+=a-u),(c||4&n)&&(l=s.measureTextWidth(e),(!i||o>l)&&(t+=c?(o-l)/2:o-l)),i?s.ctx.fillText(e,t,r,o):s.ctx.fillText(e,t,r)},drawTextAlign2:function(e,t,r,o){this.drawTextAlign(e,t.left,t.top,t.Width(),t.Height(),r,o)},drawFormatText:function(e,t,r,o,a,n){var i=this;0===n.TextOrientation?n.TextAngle?i.drawTextRotate(e,t,r,n.TextAngle):(n.CharacterSpacing||n.LineSpacing||n.FirstCharIndent||n.ParagraphSpacing||1!==n.FontWidthRatio||n.TextAlign,i.drawTextAlign(e,t,r,o,a,n.TextAlign)):i.drawOrientationText(e,t,r,o,a,n)},drawOrientationText:function(e,t,r,o,a,n){var i=this,l=i.ctx,s=0,u=e.length,c=h(i.usingFont);if(32&n.TextOrientation)i.drawTextAlign(e,t,r,o,a,n.TextAlign);else for(;u>s;)l.fillText(e[s++],t,r),r+=c},drawTextRotate:function(e,t,r,o){var a=this.ctx;a.translate(t,r),a.rotate(I(-o)),this.ctx.fillText(e,0,0),a.setTransform(1,0,0,1,0,0)},drawEqualSpaceText:function(e,t,r,o){for(var a,n,i=t,l=e.length,s=0,u=(r-t)/l;l>s;)a=t+u*(s+1),n=e.substr(s++,1),this.drawText(n,(a+i-this.measureTextWidth(n))/2,o),i=a},beginPath:function(){this.ctx.beginPath(),this.inpath=1},closePath:function(){this.ctx.closePath()},stroke:function(){this.ctx.stroke(),this.inpath=0},fill:function(){this.ctx.fill(),this.inpath=0},strokefill:function(){var e=this;e.ctx.stroke(),e.ctx.fill(),e.inpath=0},fillRect:function(e,t,r,o,a){var n=this;n.selectFillColor(a),n.ctx.fillRect(e,t,r,o),n.restoreFillStyle(a)},fillRect2:function(e,t){this.fillRect(e.left,e.top,e.Width(),e.Height(),t)},moveTo:function(e,t){var r=this.ctx;!this.inpath&&r.beginPath(),r.moveTo(e,t)},lineTo:function(e,t){var r=this.ctx;r.lineTo(e,t),!this.inpath&&r.stroke()},drawLine:function(e,t,r,o){var a=this.ctx;a.beginPath(),a.moveTo(e,t),a.lineTo(r,o),a.stroke()},drawPolyLine:function(e,t,r){var o=this.ctx,a=0,n=e.length;for(o.beginPath(),o.moveTo(e[a++],e[a++]);n>a;)o.lineTo(e[a++],e[a++]);r&&o.closePath(),o.stroke(),t&&o.fill()},bezierCurveTo:function(e,t,r,o,a,n){this.ctx.bezierCurveTo(e,t,r,o,a,n)},polyBezier:function(e){var t,r=this.ctx,o=e.length;for(r.beginPath(),r.moveTo(e[0].x,e[0].y),t=1;o>t;t++)r.bezierCurveTo(e[t].x,e[t++].y,e[t].x,e[t++].y,e[t].x,e[t].y);r.stroke()},circle:function(e,t,r,o,a){var n=this.ctx,i=(o>r?r:o)/2;e+=r/2,t+=o/2,n.beginPath(),n.arc(e,t,i,0,2*Math.PI),n.stroke(),a&&n.fill()},ellipse:function(e,t,r,o,a){var n=this.ctx,i=r>o?r:o,l=r/i,s=o/i;e+=r/2,t+=o/2,i/=2,n.beginPath(),n.save(),n.scale(l,s),n.arc(e/l,t/s,i,0,2*Math.PI),n.restore(),n.stroke(),a&&n.fill()},rectangle:function(e,t,r,o,a){this.ctx.strokeRect(e,t,r,o),a&&this.ctx.fillRect(e,t,r,o)},rectangle2:function(e,t){this.rectangle(e.left,e.top,e.Width(),e.Height(),t)},square:function(e,t,r,o,a){var n=o>r?r:o;e+=(r-n)/2,t+=(o-n)/2,this.rectangle(e,t,n,n,a)},roundRectangle:function(e,t,r,o,a,n,i){var l=this.ctx;l.beginPath(),l.moveTo(e+a,t),l.lineTo(e+r-a,t),l.quadraticCurveTo(e+r,t,e+r,t+n),l.lineTo(e+r,t+o-n),l.quadraticCurveTo(e+r,t+o,e+r-a,t+o),l.lineTo(e+a,t+o),l.quadraticCurveTo(e,t+o,e,t+o-n),l.lineTo(e,t+n),l.quadraticCurveTo(e,t,e+a,t),l.stroke(),i&&l.fill()},roundSquare:function(e,t,r,o,a,n,i){var l=o>r?r:o;e+=(r-l)/2,t+=(o-l)/2,this.roundRectangle(e,t,l,l,a,n,i)},arc:function(e,t,r,o,a){var n=this.ctx,i=!this.inpath;i&&n.beginPath(),n.arc(e,t,r,-I(o),-I(a),a>=o),i&&n.stroke()},ellipseArc:function(e,t,r,o,a,n){var i=this.ctx,l=!this.inpath,s=i.ellipse,u=r/2,c=o/2,d=e+u,h=t+c,p=n>=a;a=-I(a),n=-I(n);l&&i.beginPath(),s?i.ellipse(d,h,u,c,0,a,n,p):i.arc(d,h,Math.min(u,c),a,n,p),l&&i.stroke()},pie:function(e,t,r,o,a,n){var i=this.ctx;o=I(o),a=I(a),i.beginPath(),i.moveTo(e,t),i.arc(e,t,r,-o,-a,1),i.closePath(),i.stroke(),n&&i.fill()},ellipsePie:function(e,t,r,o,a,n,i){var l,s,u=this.ctx,c=u.ellipse,d=r/2,h=o/2,p=e+d,f=t+h,g=n>=a;a=I(a),n=I(n),c||(d=h=Math.min(d,h)),l=p+Math.cos(a)*d,s=f-Math.sin(a)*h,u.beginPath(),u.moveTo(p,f),u.lineTo(l,s),c?u.ellipse(p,f,d,h,0,-a,-n,g):u.arc(p,f,d,-a,-n,g),u.closePath(),u.stroke(),i&&u.fill()},drawBar:function(e,t,r,o){var a,n=this,i=n.ctx,l=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}];n.selectFillColor(r),n.selectPen(t),i.fillRect(e.left,e.top,e.Width(),e.Height()),i.beginPath(),a=l[o],i.moveTo(a.x,a.y),a=l[++o%4],i.lineTo(a.x,a.y),a=l[++o%4],i.lineTo(a.x,a.y),a=l[++o%4],i.lineTo(a.x,a.y),i.stroke(),n.restorePen(),n.restoreFillStyle()},DrawHorzLine:function(e,t,r){this.drawLine(t,e,r,e)},DrawVertLine:function(e,t,r){this.drawLine(e,t,e,r)},DrawPointMarker:function(t,r,o,a){var n,i,l,s,u=this,c=a!==e,d=t.Width(),h=Math.min(4,(d-4)/2);switch(c&&u.selectFillColor(a),o&&u.selectPen(o),r){case 3:case 4:case 5:u.ellipse(t.left,t.top,t.Width(),t.Height(),1),4===r?u.circle((t.left+t.right)/2-1,(t.top+t.bottom)/2-1,2,2,0):5===r&&(d=Math.min(4,d/3),u.drawLine(t.left+d,t.top+d,t.right-d,t.bottom-d),u.drawLine(t.right-d,t.top+d,t.left+d,t.bottom-d));break;case 0:case 1:case 2:u.rectangle(t.left,t.top,t.Width(),t.Height(),1),1===r?u.drawPolyLine([t.left+h,t.top+d/2,t.left+d/2,t.bottom-h,t.right-h,t.top+h]):2===r&&(u.drawLine(t.left+h,t.top+h,t.right-h,t.bottom-h),u.drawLine(t.right-h,t.top+h,t.left+h,t.bottom-h));break;case 8:case 9:(s=o&&c)&&((l=o.clone()).Color=a,u.selectPen(l)),u.drawLine(t.left,t.top,t.right,t.bottom),u.drawLine(t.left,t.bottom,t.right,t.top),9===r&&(n=(t.left+t.right)/2,u.drawLine(n,t.top,n,t.bottom),i=(t.top+t.bottom)/2,u.drawLine(t.left,i,t.right,i)),s&&u.restorePen();break;case 6:u.drawPolyLine([(t.left+t.right)/2,t.top,t.left,(t.top+t.bottom)/2,(t.left+t.right)/2,t.bottom,t.right,(t.top+t.bottom)/2],1,1);break;case 7:u.drawPolyLine([(t.left+t.right)/2,t.top,t.left,t.bottom,t.right,t.bottom],1,1);break;case 10:case 11:case 12:case 13:!function(){var e,o=10===r?4:11===r?5:12===r?6:10,a=2*Math.PI/o/2,n=t.Width()/2,i=n/2,l=t.left+n,s=t.top+n,c=Math.PI/2,d=[];for(e=0;o>e;e++)d.push(l+Math.cos(c)*n,s-Math.sin(c)*n),c+=a,d.push(l+Math.cos(c)*i,s-Math.sin(c)*i),c+=a;u.drawPolyLine(d,1,1)}()}o&&u.restorePen(),c&&u.restoreFillStyle()},_applyPen:function(){var e=this.ctx,t=this.pens,r=t[t.length-1];e.lineWidth=r.Width,e.strokeStyle=w(r.Color),e.setLineDash(r.getDashStyle())}},a.Graphics=function(e){this.report=e,this.ByUnit=0},a.Graphics.prototype={toPixels:function(e){return this.ByUnit?this.report.UnitToPixels(e):e},pixelsTo:function(e){return this.ByUnit?this.report.PixelsToUnit(e):e},get Left(){return 0},get Top(){return 0},get Width(){return this.pixelsTo(this.ctx.width)},get Height(){return this.pixelsTo(this.ctx.height)},attach:function(e){this.ctx=e},MoveTo:function(e,t){var r=this;r.ctx.moveTo(r.toPixels(e),r.toPixels(t))},LineTo:function(e,t){var r=this;r.ctx.lineTo(r.toPixels(e),r.toPixels(t))},FillRect:function(e,t,r,o,a){var n=this;n.ctx.fillRect(n.toPixels(e),n.toPixels(t),n.toPixels(r),n.toPixels(o),a)},Rectangle:function(e,t,r,o,a){var n=this;n.ctx.rectangle(n.toPixels(e),n.toPixels(t),n.toPixels(r),n.toPixels(o),a)},RoundRect:function(e,t,r,o,a,n,i){var l=this;l.ctx.roundRectangle(l.toPixels(e),l.toPixels(t),l.toPixels(r),l.toPixels(o),l.toPixels(a),l.toPixels(n),i)},Ellipse:function(e,t,r,o,a){var n=this;n.ctx.ellipse(n.toPixels(e),n.toPixels(t),n.toPixels(r),n.toPixels(o),a)},Pie:function(e,t,r,o,a,n){var i=this;i.ctx.pie(i.toPixels(e),i.toPixels(t),i.toPixels(r),o,a,n)},Arc:function(e,t,r,o,a){var n=this;n.ctx.arc(n.toPixels(e),n.toPixels(t),n.toPixels(r),o,a)},EllipseArc:function(e,t,r,o,a,n){var i=this;i.ctx.ellipseArc(i.toPixels(e),i.toPixels(t),i.toPixels(r),i.toPixels(o),a,n)},EllipsePie:function(e,t,r,o,a,n,i){var l=this;l.ctx.ellipsePie(l.toPixels(e),l.toPixels(t),l.toPixels(r),l.toPixels(o),a,n,i)},DrawLabelText:function(e,t,r){var o=this;o.ctx.drawText(e,o.toPixels(t),o.toPixels(r))},DrawRotateText:function(e,t,r,o){var a=this;a.ctx.drawTextRotate(e,a.toPixels(t),a.toPixels(r),o)},DrawText:function(e,t,r,o,a,n,i){var l=this;l.ctx.drawTextAlign(e,l.toPixels(t),l.toPixels(r),l.toPixels(o),l.toPixels(a),n)},DrawFormatText:function(e,t,r,o,a,n){var i=this;i.ctx.drawFormatText(e,i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(a),n)},DrawFormatTextShrinkToFit:function(e,t,r,o,a,n){var i=this;i.ctx.drawTextAlign(e,i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(a),n.TextAlign,1)},CalcLabelTextWidth:function(e){return this.pixelsTo(this.ctx.measureTextWidth(e))},CalcLabelTextHeight:function(e){return this.pixelsTo(this.ctx.measureTextHeight(e))},CalcTextOutLen:function(e,t,r,o){return r.length},CalcDrawFormatTextHeight:function(e,t,r){return this.pixelsTo(this.ctx.measureTextHeight(e))},CalcDrawFormatTextWidth:function(e,t){return this.pixelsTo(this.ctx.measureTextWidth(e))},CalcDrawFormatTextOutLen:function(e,t,r,o){return e.length},DrawPicture:function(e,t,r,o,a,n,i,l){},SelectFont:function(e){this.ctx.selectFont(e.font)},RestoreFont:function(){this.ctx.restoreFont()},FontPointChangeTo:function(e){this.ctx.fontSizeTo(e)},FontSizeRestore:function(){this.ctx.restoreFont()},SelectTextColor:function(e){this.ctx.selectFillColor(e)},RestoreTextColor:function(){this.ctx.restoreFillStyle()},SelectPen:function(e,t,r){this.ctx.selectPen2(e,t,r)},RestorePen:function(){this.ctx.restorePen()},SelectFillColor:function(e){this.ctx.selectFillColor(e)},RestoreFillColor:function(){this.ctx.restoreFillStyle()},PushClipRect:function(e,t,r,o){var a=this;a.ctx.pushClipRect(a.toPixels(e),a.toPixels(t),a.toPixels(r),a.toPixels(o))},PopClipRect:function(){this.ctx.popClipRect()},CurveTo:function(e,t,r,o,a,n){var i=this;i.ctx.bezierCurveTo(i.toPixels(e),i.toPixels(t),i.toPixels(r),i.toPixels(o),i.toPixels(a),i.toPixels(n))},CalcCurveControlPoints:function(e,t,r,o,a,n){var i=this,l=Math.sqrt(Math.pow(r-e,2)+Math.pow(o-t,2)),s=Math.sqrt(Math.pow(a-r,2)+Math.pow(n-o,2)),u=l+s,c=1,d=1;u>0&&(c=.4*l/u,d=.4*s/u),i.CCPInnerX=r-c*(a-e),i.CCPInnerY=o-c*(n-t),i.CCPOuterX=r+d*(a-e),i.CCPOuterY=o+d*(n-t)},DrawPointMarker:function(e,t,r,o){var a=this;t=a.toPixels(t),r=a.toPixels(r),o=a.toPixels(o/2),a.ctx.DrawPointMarker(new E(t-o,r-o,t+o,r+o),e)},BeginPath:function(){this.ctx.beginPath()},ClosePath:function(){this.ctx.closePath()},EndPath:function(){},StrokePath:function(){this.stroke()},FillPath:function(){this.fill()},StrokeAndFillPath:function(){this.strokefill()}},a.HtmlStyles=function(){this.items=[]},a.HtmlStyles.prototype={add:function(e,t){this.items.push({name:e,value:t})},addBackColor:function(e){this.add("background-color",w(e))},addCellBorder:function(e){var t=this;e.ShowColLine&&e.ShowRowLine&&R(e.ColLinePen,e.RowLinePen)?t.add("border",d(e.ColLinePen)):(e.ShowRowLine&&t.add("border-bottom",d(e.ColLinePen)),e.ShowColLine&&t.add("border-right",d(e.RowLinePen)))},addObjectPadding:function(e){var t=e.padding,r="";return t.Right===t.Left&&t.Top===t.Bottom?(t.Right!==t.Top&&(r=g(t.Top)+" "),r+=g(t.Right)):r=g(t.Top)+" "+g(t.Right)+" "+g(t.Bottom)+" "+g(t.Left),this.add("padding",r)},addBorder:function(e){var t,r=this;e.Styles&&(t=d(e.Pen),15===e.Styles?r.add("border",t):(1&e.Styles&&r.add("border-left",t),4&e.Styles&&r.add("border-right",t),2&e.Styles&&r.add("border-top",t),8&e.Styles&&r.add("border-bottom",t))),e.Shadow&&(t=g(e.ShadowWidth)+" ",r.add("box-shadow",t+t+w(e.ShadowColor)))},addTextFormat:function(e,t){var r,o=this,a=e.TextFormat,n=a.LineSpacing,i="text-align",l=a.WordWrap;1&a.TextAlign?o.add(i,"left"):2&a.TextAlign?o.add(i,"center"):4&a.TextAlign?o.add(i,"right"):o.add(i,"justify"),t&&(i="vertical-align",16&a.TextAlign?o.add(i,"top"):32&a.TextAlign?o.add(i,"middle"):o.add(i,"bottom")),a.EndEllipsis&&(o.add("text-overflow","ellipsis"),l=!1),l?o.add("white-space","normal"):(o.add("overflow","hidden"),o.add("white-space","nowrap")),a.CharacterSpacing&&o.add("letter-spacing",g(a.CharacterSpacing)),n&&(r=h(e.obj.getUsingFont()),o.add("line-height",f((r+n)/r))),a.FirstCharIndent&&o.add("text-indent",g(a.FirstCharIndent)),D(a.ForeColor)&&o.add("color",w(a.ForeColor))},getText:function(){var e="";return this.items.forEach((function(t){e+=t.name+":"+t.value+";"})),e},clear:function(){this.items=[]}};var G=a.HtmlStyles;a.HtmlElement=function(e,t){this.tag=e,this.classes=[],t.addChild(this)},a.HtmlElement.prototype={get styles(){var e=this;return e._styles||(e._styles=new G),e._styles},addClass:function(e){this.classes.push(e)},addStyle:function(e,t){this.styles.add(e,t)},addBackColorStyle:function(e){this.addStyle("background-color",w(e))},addAttribute:function(e,t){var r=this;r._attributes||(r._attributes=[]),r._attributes.push({name:e,value:t})},addChild:function(e){var t=this;t.children||(t.children=[]),t.children.push(e)},beginText:function(){var t=this,r="<"+t.tag;return t.classes.length>0&&(r+=' class="',t.classes.forEach((function(e,t){t>0&&(r+=" "),r+=e})),r+='"'),t._styles&&(r+=' style="'+t._styles.getText()+'"'),t._attributes&&t._attributes.forEach((function(t){var o=t.value;r+=" "+t.name,o!==e&&(r+='="'+o+'"')})),t.skipend&&(r+="/"),r+=">"},endText:function(){return this.skipend?"":"</"+this.tag+">"}}}(),gr.wr={WRZipSource:['":"','","','"},{"','":{"','},{"','":',',"',"false"],WRZipDest:"!$%&@^`~",WRAsciiMap_R:"r<~VH6SAZ?yiO %1#Ek>]`+|F_t/$RgQnX=YbqL)7uU9,oaB5}-'ev4;JD.2WsP@3zhl\"cfC^(K0mx!&Td{*GM:[pIj8\\Nw",propNameMap:{AlternatingBackColor:"G",BackColor:"Q",BarcodeType:"b",BorderCustom:"i",CharSpacing:"x",DBFieldName:"WA",FreeCell:"AB",GroupLabel:"OB",GroupTitle:"PB",Height:"ZB",IsCrossTab:"jB",LeftMargin:"tB",LnSpacing:"JC",Name:"YC",Oriention:"eC",RightMargin:"qD",SeriesLabel:"HE",Type:"LF",Value:"UF",Width:"eF"},propNameMap_R:{A:"AdjustRowHeight",B:"AlignColumn",C:"AlignColumnEx",D:"AlignColumnSide",E:"AlignToGrid",F:"Alignment",G:"AlternatingBackColor",H:"AlwaysShowHScrollBar",I:"AlwaysShowVScrollBar",J:"Anchor",K:"AppendBlankCol",L:"AppendBlankColWidth",M:"AppendBlankRow",N:"AppendBlankRowAtLast",O:"AppendBlankRowExclude",P:"Author",Q:"BackColor",R:"BackImage",S:"BackImageFile",T:"BackImagePreview",U:"BackImagePrint",V:"BackStyle",W:"BackgroundColor",X:"BarRatio",Y:"BarSingleSeriesColor",Z:"BarWidth",a:"BarWidthPercent",b:"BarcodeType",c:"BeforePostRecordScript",d:"BeforeSortScript",e:"BeginDateParameter",f:"Bold",g:"BookmarkText",h:"BorderColor",i:"BorderCustom",j:"BorderPrintType",k:"BorderStyles",l:"BorderWidth",m:"BottomMargin",n:"BubbleScalePerCm",o:"ByFields",p:"ByY2Axis",q:"CanGrow",r:"CanShrink",s:"CaptionAlignment",t:"CaptionPosition",u:"Center",v:"CenterView",w:"CenterWithDetailGrid",x:"CharSpacing",y:"CharacterSpacing",z:"Charset",AA:"Chart3D",BA:"ChartType",CA:"CheckSum",DA:"CodePage",EA:"ColLineColor",FA:"ColLineWidth",GA:"ColSpan",HA:"Color",IA:"Column",JA:"ColumnCount",KA:"ColumnMove",LA:"ColumnResize",MA:"ConditionScript",NA:"ConnectionString",OA:"ContinuePrint",PA:"CoordLineColor",QA:"CoordLineVisible",RA:"CornerDx",SA:"CornerDy",TA:"Cursor",UA:"CustomDraw",VA:"CustomDrawScript",WA:"DBFieldName",XA:"DataField",YA:"DataName",ZA:"DataType",aA:"Description",bA:"Direction",cA:"DisabledSumFields",dA:"DisplayField",eA:"Dock",fA:"DtmxEncoding",gA:"DtmxMatrixSize",hA:"DtmxModuleSize",iA:"Editable",jA:"EndDateParameter",kA:"EndEllipsis",lA:"ExportBeginScript",mA:"ExportEndScript",nA:"FalseText",oA:"FetchRecordScript",pA:"FillColor",qA:"FillColorAuto",rA:"FillStyle",sA:"FirstCharIndent",tA:"FixCols",uA:"FixedWidth",vA:"FlowTo",wA:"FontWidthRatio",xA:"ForeColor",yA:"Format",zA:"FormatScript",AB:"FreeCell",BB:"GetDisplayTextScript",CB:"GlobalScript",DB:"GridColsPerUnit",EB:"GridLinePrintType",FB:"GridRowsPerUnit",GB:"GroupAuto",HB:"GroupAutoSum",IB:"GroupBeginScript",JB:"GroupCount",KB:"GroupEndScript",LB:"GroupField",MB:"GroupIndex",NB:"GroupKeepTogether",OB:"GroupLabel",PB:"GroupTitle",QB:"GrowToBottom",RB:"GrowToNextRow",SB:"HCrossFields",TB:"HCrossPeriodType",UB:"HNewPageFixed",VB:"HPercentColumns",WB:"HResort",XB:"HSortAsc",YB:"HTotalAtFirst",ZB:"Height",aB:"HideOnRecordsetEmpty",bB:"HtmlTags",cB:"Image",dB:"ImageFile",eB:"ImageIndex",fB:"IncludeFooter",gB:"InitializeScript",hB:"InnerIndent",iB:"InnerStyles",jB:"IsCrossTab",kB:"Italic",lB:"KeepTogether",mB:"L2R",nB:"Label",oB:"LabelAsGroup",pB:"LabelInBar",qB:"LabelText",rB:"LabelTextAngle",sB:"Left",tB:"LeftMargin",uB:"LegendAtBottom",vB:"LegendColumnCount",wB:"LegendCursor",xB:"LegendShowSum",yB:"LegendSumLabel",zB:"LegendValueVisible",AC:"LegendVisible",BC:"Length",CC:"LimitsPerPage",DC:"LineColor",EC:"LineSpacing",FC:"LineType",GC:"LineVisible",HC:"LineWeight",IC:"ListCols",JC:"LnSpacing",KC:"Lock",LC:"Locked",MC:"MarginBeginWeight",NC:"MarginEndWeight",OC:"MarginGap",PC:"MarkerColor",QC:"MarkerColorAuto",RC:"MarkerLegendShow",SC:"MarkerSize",TC:"MarkerStyle",UC:"Max",VC:"Min",WC:"MirrorMargins",XC:"MonoPrint",YC:"Name",ZC:"NegativeAsZero",aC:"NewPage",bC:"NewPageColumn",cC:"OccupiedColumns",dC:"OccupyColumn",eC:"Oriention",fC:"PDF417Columns",gC:"PDF417ErrorLevel",hC:"PDF417Rows",iC:"PDF417Simple",jC:"PaddingBottom",kC:"PaddingLeft",lC:"PaddingRight",mC:"PaddingTop",nC:"PageColumnCount",oC:"PageColumnDirection",pC:"PageColumnGroupNA",qC:"PageColumnSpacing",rC:"PageDivideCount",sC:"PageDivideLine",tC:"PageDivideSpacing",uC:"PageEndScript",vC:"PageGroup",wC:"PageProcessRecordScript",xC:"PageStartScript",yC:"ParagraphSpacing",zC:"Parameter",AD:"ParentPageSettings",BD:"PenColor",CD:"PenStyle",DD:"PenWidth",ED:"PercentFormat",FD:"Picture",GD:"Pitch",HD:"PointWeight",ID:"PrintAdaptFitText",JD:"PrintAdaptMethod",KD:"PrintAdaptRFCStep",LD:"PrintAdaptRepeat",MD:"PrintAdaptTryToOnePage",ND:"PrintAsDesignPaper",OD:"PrintAtBottom",PD:"PrintBeginScript",QD:"PrintEndScript",RD:"PrintGridBorder",SD:"PrintOffsetSaveToLocal",TD:"PrintOffsetX",UD:"PrintOffsetY",VD:"PrintPageScript",WD:"PrintRotation",XD:"PrintToStretch",YD:"PrintType",ZD:"PrinterName",aD:"ProcessBeginScript",bD:"ProcessEndScript",cD:"ProcessRecordScript",dD:"QRCodeErrorLevel",eD:"QRCodeMask",fD:"QRCodeVersion",gD:"QuerySQL",hD:"RTF",iD:"RTrimBlankChars",jD:"RankNo",kD:"RegisterNo",lD:"RelationFields",mD:"RepeatOnPage",nD:"RepeatStyle",oD:"ReportFile",pD:"ResetPageNumber",qD:"RightMargin",rD:"RotateMode",sD:"RowCount",tD:"RowLineColor",uD:"RowLineWidth",vD:"RowSelection",wD:"RowSpan",xD:"RowsIncludeGroup",yD:"RowsPerPage",zD:"SameAsColumn",AE:"ScriptType",BE:"SelectionBackColor",CE:"SelectionForeColor",DE:"SeriesAuto",EE:"SeriesCount",FE:"SeriesCursor",GE:"SeriesField",HE:"SeriesLabel",IE:"SeriesName",JE:"Shadow",KE:"ShadowColor",LE:"ShadowWidth",ME:"ShapeType",NE:"SharePrintSetupOptions",OE:"ShiftMode",PE:"ShowColLine",QE:"ShowGrid",RE:"ShowMoneyDigit",SE:"ShowMoneyLabel",TE:"ShowMoneyLine",UE:"ShowMoneyLineColor",VE:"ShowMoneySepLineColor",WE:"ShowMoneyWidth",XE:"ShowPreviewWndScript",YE:"ShowRowLine",ZE:"ShrinkFontToFit",aE:"SingleSeriesColored",bE:"Size",cE:"SizeMode",dE:"SkipQuery",eE:"SortAsc",fE:"SortCaseSensitive",gE:"SortFields",hE:"SortSummaryBox",iE:"Space",jE:"SpanToNewPage",kE:"Strikethrough",lE:"Style",mE:"Styles",nE:"SubtotalCols",oE:"SummaryFun",pE:"SystemVar",qE:"Tag",rE:"Text",sE:"TextAlign",tE:"TextAngle",uE:"TextFormat",vE:"TextOrientation",wE:"TextVisible",xE:"Title",yE:"TitleRepeat",zE:"TitleRows",AF:"ToNewExcelSheet",BF:"TooltipText",CF:"Top",DF:"TopMargin",EF:"TotalCols",FF:"TotalExcludeColumns",GF:"TotalHPercentColumns",HF:"TotalVPercentColumns",IF:"Transparent",JF:"TransparentMode",KF:"TrueText",LF:"Type",MF:"U2D",NF:"Underline",OF:"Unit",PF:"VAlign",QF:"VCrossFields",RF:"VPercentColumns",SF:"VResort",TF:"VSortAsc",UF:"Value",VF:"ValueAsPercent",WF:"ValueFormat",XF:"ValueVisible",YF:"Version",ZF:"Visible",aF:"Watermark",bF:"WatermarkAlignment",cF:"WatermarkSizeMode",dF:"Weight",eF:"Width",fF:"WordWrap",gF:"XAxisLabel",hF:"XAxisMaximum",iF:"XAxisMinimum",jF:"XAxisSpace",kF:"XAxisTextAngle",lF:"XAxisTextFormat",mF:"XAxisTextVisible",nF:"XAxisVisible",oF:"XValueField",pF:"XmlTableName",qF:"YAxisLabel",rF:"YAxisMaximum",sF:"YAxisMinimum",tF:"YAxisSpace",uF:"YAxisTextFormat",vF:"YAxisTextVisible",wF:"YAxisVisible",xF:"YValueField",yF:"ZValueField",zF:"ZValueFormat"},wrPropNameEncode:function(e){var t=gr.wr.propNameMap[e];return t||e},wrPropNameDecode:function(e){var t=gr.wr.propNameMap_R[e];return t||e},decodeWR:function(e){for(var t,r,o,a,n,i="",l=4,s=e.length,u=gr.wr,c=u.WRAsciiMap_R,d=u.WRZipSource,h=u.WRZipDest,p=[];s>l;)i+=((f=e[l++])>=" "&&"~">=f&&(f=c[f.charCodeAt(0)-32]),f);var f;for(s=0,a=i[l=0];"["==a;){for(n={},t=++l;","!=a&&!("0">(a=i[++l])||a>"9"););if(","!=a)break;for(n.f=+i.substring(t,l),t=++l;"]"!=a&&!("0">(a=i[++l])||a>"9"););if("]"!=a)break;n.s=+i.substring(t,l++),p.push(n),s=l,a=i[l]}for(e=i.substr(s).split(""),n=p.length;n-- >0;)r=p[n].f,o=p[n].s,a=e[r],e[r]=e[o],e[o]=a;for(s=e.length,i="",l=0;s>l;l++)a=e[l],(n=h.indexOf(a))>=0?i+=d[n]:("#"==a&&(a=e[++l]),i+=a);return i}},function(e){var t=gr.const_,r=gr.common,o=gr.locale,a=gr.helper,n=r.DateTime,i=a.intFixed,l=a.confirmDateValue,s=a.confirmBooleanValue,u=a.rgba2color,c=a.color2rgba,d=a.decodeTextColor,h=gr.format={};h.BooleanFormatter=function(e){this.parse(e)},h.BooleanFormatter.prototype={parse:function(e){var t,r=this;e?-1===(t=e.indexOf(":"))?(r.trueValueText=e,r.falseValueText=""):(r.trueValueText=e.substr(0,t),r.falseValueText=e.substr(t+1)):(r.trueValueText="true",r.falseValueText="false")},format:function(e){return(e=s(e))?this.trueValueText:this.falseValueText}};var p=function(){this.defaultMe()};p.prototype={defaultMe:function(){var e=this;e.precision=9,e.leastPrecision=0,e.leastIntegerWidth=1,e.showPositive=!1,e.showNegative=!0,e.showSymbolAtHead=!0,e.negativeBracket=!1,e.intSepStep=0,e.asPercent=!1,e.asCurrency=!1,e.blankSepSymbol=!1,e.firstCurrencySymbol=!0,e.exponent=!1,e.textColor=0,e.prefix="",e.suffix=""},isCustomTextColor:function(){return 0!==this.textColor},parse:function(e){function t(e){return-1!=="0#.,+-()$%".indexOf(e)}var r,o,a,n,i,l=this;if(l.defaultMe(),e){if((r=d(e))&&(e=e.substr(r.index),l.textColor=r.color),i=e.length,l.exponent="e"===e.charAt(0),!l.exponent){for(o=0;i>o&&!t(e.charAt(o));)++o;if(o>0&&(l.prefix=e.substr(0,o),i=(e=e.substr(o)).length),i>o){for(o=i-1;!t(e.charAt(o))&&o>0;)--o;i-1>o&&(l.suffix=e.substr(o+1),i=(e=e.substr(0,o+1)).length)}}for(-1===(n=e.indexOf("."))&&(n=i),(o=e.indexOf(","))>=0&&(l.intSepStep=n-o-1,l.intSepStep<0&&(l.intSepStep=3)),l.negativeBracket=e.indexOf("(")>=0&&e.indexOf(")")>=0,l.asPercent=e.indexOf("%")>=0,l.blankSepSymbol=e.indexOf(" ")>=0,o=e.indexOf("+"),l.showPositive=o>=0,a=e.indexOf("-"),l.showNegative=a>=0||!l.negativeBracket&&!l.isCustomTextColor(),a>o&&(o=a),a=e.indexOf("$"),l.asCurrency=a>=0,a>o&&(o=a),l.showSymbolAtHead=-1===o||n>o,l.asCurrency&&(l.negativeBracket?(o=e.indexOf(l.showSymbolAtHead?"(":")"),l.firstCurrencySymbol=o>a):l.firstCurrencySymbol=o>=a),l.leastIntegerWidth=0,o=0;n>o;++o)"0"===e.charAt(o)&&++l.leastIntegerWidth;for(l.leastPrecision=0,l.precision=0,o=n+1;i>o;++o)"0"===e.charAt(o)?(++l.leastPrecision,++l.precision):"#"===e.charAt(o)&&++l.precision}},format:function(e){var t,r,a,n,i,l,s,u,d,h,p,f=this,g="";if(e=+e,f.isCustomTextColor()&&(g="[_color#=rgb("+(t=c(f.textColor)).r+","+t.g+","+t.b+")]"),f.asPercent&&(e*=100),f.exponent){if(0>(r=e)&&(r=-r),a=0,0!==r){for(;r>=10;)r/=10,++a;for(;1>r;)r*=10,--a}return f.exponent=!1,0>e&&(r=-r),g+=f.format(r),g+="e",a>=0?g+="+":(g+="-",a=-a),g+=a,f.exponent=!0,g}if(h=(p=e.toFixed(f.precision)).length,f.precision>f.leastPrecision){for(i=(n=h-1)-f.precision+f.leastPrecision;n>i&&"0"===p.charAt(n);n--);"."!==p.charAt(n)&&n++,n<p.length&&(p=p.substr(0,n),h=n)}if(0>(l=p.indexOf("."))&&(l=h),g+=f.prefix,f.showSymbolAtHead?(f.asCurrency&&f.firstCurrencySymbol&&(g+=o.currencySymbol),0>e?f.negativeBracket&&(g+="("):f.showPositive&&e>0&&(g+="+"),f.asCurrency&&!f.firstCurrencySymbol&&(g+=o.currencySymbol),f.blankSepSymbol&&(g+=" ")):f.negativeBracket&&0>e&&(g+="("),n=0,s=l,0>e&&(--s,++n,f.showNegative&&(g+="-")),d=s,(u=f.leastIntegerWidth-s)>0)for(d+=u;d>s;)g+="0",d--,f.intSepStep>0&&d%f.intSepStep==0&&(g+=o.thousandSep);else for(;u++<0&&"0"===p.charAt(n);)n++;if(f.intSepStep>0)for(;d>0;)g+=p.charAt(n++),--d%f.intSepStep==0&&0!==d&&(g+=o.thousandSep);else g+=p.substring(n,l);return h>l&&(g+=p.substr(l)),f.showSymbolAtHead?f.negativeBracket&&0>e&&(g+=")"):(f.blankSepSymbol&&(g+=" "),f.asCurrency&&f.firstCurrencySymbol&&(g+=o.currencySymbol),0>e?g+=f.negativeBracket?")":"-":f.showPositive&&e>0&&(g+="+"),f.asCurrency&&!f.firstCurrencySymbol&&(g+=o.currencySymbol)),f.asPercent&&(g+="%"),g+f.suffix}};var f=function(e){for(var t=(e=e.substring(1,e.length-1)).split(","),r=0;r<t.length;r++){var o=t[r],a=o.indexOf("=");this[o.substr(0,a)]=o.substr(a+1)}};f.prototype={format:function(t){var r=this[t];return r===e&&(r=""),r}};h.NumericFormatter=function(e){this.parse(e)},h.NumericFormatter.prototype={defaultMe:function(){var t=this;t.formatType=0,t.positiveAnalyser=new p,t.negativeAnalyser&&(t.negativeAnalyser=e),t.zeroAnalyser&&(t.zeroAnalyser=e),t.intEnumAnalyser&&(t.intEnumAnalyser=e)},parse:function(e){function t(e){var t,r;r=(t=e.split(";")).length,o.positiveAnalyser.parse(t[0]),r>1&&""!==t[1]&&(o.negativeAnalyser=new p,o.negativeAnalyser.parse(t[1])),r>2&&""!==t[2]&&(o.zeroAnalyser=new p,o.zeroAnalyser.parse(t[2]))}var r,o=this;if(o.defaultMe(),e){var a=e.length;e&&(-1!==(r=e.indexOf("$$$"))?(o.formatType=1,""!==(e=e.substr(0,r)+e.substr(r+3))&&t(e)):a>=2&&"$$"===e.substr(0,2)?2===a?o.formatType=2:(o.formatType=3,t(e.substr(2))):"{"===e.charAt(0)&&"}"===e.charAt(a-1)?(o.formatType=4,o.intEnumAnalyser=new f(e)):t(e))}},format:function(r){function o(e,r){var o,a,n=!1,i=!1,l=0,s="";for(o=r-1;o>=0;o--,l++)l%4==0&&l>0&&(n=!0),0===(a=parseInt(e.charAt(o)))?i=!0:(i&&(""!==s&&(s=t.BIG_AMT_NUMBER.charAt(0)+s),i=!1),l>0&&(n&&l%4!=0&&(s=t.HZ_AMT_STEP.charAt(l-l%4)+s),n=!1,s=t.HZ_AMT_STEP.charAt(l)+s),s=t.BIG_AMT_NUMBER.charAt(a)+s);return s}var a,n,i,l,s,u,c,d,h=this;if(r=+r,isNaN(r))a="";else if(h.formatType<=1){if(h.zeroAnalyser&&r>-.5&&.5>r){var p=h.positiveAnalyser.precision;h.positiveAnalyser.asPercent&&(p+=2);var f=p;h.negativeAnalyser&&(f=h.negativeAnalyser.precision,h.negativeAnalyser.asPercent&&(f+=2));var g=-.5*Math.pow(.1,f),m=.5*Math.pow(.1,p);r>g&&m>r&&(a=h.zeroAnalyser.format(0))}a===e&&(a=h.negativeAnalyser&&0>r?h.negativeAnalyser.format(r):h.positiveAnalyser.format(r)),1===h.formatType&&(a=function(e){var r,o,a="",n=e.length;for(o=0;n>o;o++)r=parseInt(e.charAt(o)),isNaN(r)||(a+=t.BIG_AMT_NUMBER.charAt(r));return a}(a))}else a=4===h.formatType?h.intEnumAnalyser.format(r):2===h.formatType?(d=0>=(n=r),n>-.005&&.005>n?t.HZ_ZERO_YUAN:(d&&(n=-n),i=(u=n.toFixed(2)).indexOf("."),""!==(c=o(u,i))&&(c+=t.HZ_AMT_STEP.charAt(0)),l=parseInt(u.charAt(i+1)),s=parseInt(u.charAt(i+2)),0===l&&0===s?c+=t.HZ_AMT_UNIT[0]:(0===l&&""===c||(c+=t.BIG_AMT_NUMBER.charAt(l)),0!==l&&(c+=t.HZ_AMT_UNIT.charAt(1)),0!==s?(c+=t.BIG_AMT_NUMBER.charAt(s),c+=t.HZ_AMT_UNIT.charAt(2)):c+=t.HZ_AMT_UNIT.charAt(0)),d&&(c=t.HZ_NEGATIVE+c),c)):function(e,r){var a,n,i,l,s=Math.max(0,r.precision),u=Math.min(s,r.leastPrecision),c=-.5*Math.pow(.1,s)>=e;for(0>e&&(e=-e),a=(i=e.toFixed(s)).length,-1===(n=i.indexOf("."))&&(n=a),""===(l=o(i,n))&&(l=t.BIG_AMT_NUMBER.charAt(0)),a--;a>n+u&&"0"===i.charAt(a);a--);if(a>n)for(l+="点",n++;a>=n;n++)l+=t.BIG_AMT_NUMBER.charAt(parseInt(i.charAt(n)));return c&&(l=t.HZ_NEGATIVE+l),""!==r.prefix&&(l=r.prefix+l),""!==r.suffix&&(l+=r.suffix),l}(r,h.positiveAnalyser);return a}},h.DateTimeFormatter=function(e){this.parse(e)},h.DateTimeFormatter.prototype={parse:function(r){function a(){for(w=1;D[F+1]===A;)F++,w++}function n(){var e=w;(e=(e-(w%=2))/2)>0&&l(e)}function l(e){var t="",r=B.length;do{t+=A}while(--e>0);r>0&&15===B[r-1].type?B[r-1].data+=t:B.push({type:15,data:t,funDisplayText:x})}function s(e,t){return i(e.getFullYear(),t.subtype)}function u(r,a){var n=r.getMonth();return a.subtype<=4?i(n+1,a.subtype):o.supportIntl?5===a.subtype?new Intl.DateTimeFormat(e,{month:"short"}).format(r):new Intl.DateTimeFormat(e,{month:"long"}).format(r):10>n?t.HZ_NUMBER.charAt(n):t.HZ_NUMBER.charAt(9)+t.HZ_NUMBER.charAt(n-10)+t.HZ_DATETIME_UNIT.charAt(5)}function c(e,t){return i(e.getDate(),t.subtype)}function d(r,a){var n;return o.supportIntl?5===a.subtype?new Intl.DateTimeFormat(e,{weekday:"short"}).format(r):new Intl.DateTimeFormat(e,{weekday:"long"}).format(r):(n=r.getDay(),(5===a.subtype?t.HZ_DATETIME_UNIT.substr(0,1):t.HZ_DATETIME_UNIT.substring(2,4))+(n>0?t.HZ_NUMBER.charAt(n-1):t.HZ_DATETIME_UNIT.charAt(1)))}function h(e,t){var r=e.getHours()%12;return r||(r=12),i(r,t.subtype)}function p(e,t){return i(e.getHours(),t.subtype)}function f(e,t){return i(e.getMinutes(),t.subtype)}function g(e,t){return i(e.getSeconds(),t.subtype)}function m(e,t){return e.toLocaleDateString()}function C(e,t){return e.toLocaleTimeString()}function T(e,t){return e.toLocaleString()}function x(e,t){return t.data}function b(e,t){return e.getHours()<12?o.textAM:o.textPM}function S(e,t){return o.dateSep}function v(e,t){return o.timeSep}var y,F,w,D,A,P,R,B=this.items=[];if(r){y=(D=r.split("")).length,F=0;do{switch(A=D[F],a(),R={},A){case"d":3>w?(R.type=3,R.funDisplayText=c,R.subtype=1===w?0:2):(R.type=4,R.funDisplayText=d,R.subtype=3===w?5:6);break;case"M":R.type=2,R.funDisplayText=u,R.subtype=1===w?0:2===w?2:3===w?5:6;break;case"y":R.type=1,R.funDisplayText=s,R.subtype=3>w?2:0;break;case"h":R.type=5,R.funDisplayText=h,R.subtype=1===w?0:2;break;case"H":R.type=6,R.funDisplayText=p,R.subtype=1===w?0:2;break;case"m":R.type=7,R.funDisplayText=f,R.subtype=1===w?0:2;break;case"s":R.type=8,R.funDisplayText=g,R.subtype=1===w?0:2;break;case"t":2===w&&(R.type=20,R.funDisplayText=b);break;case"%":n(),w&&(P=D[F+1],++F,"d"===P?(R.type=10,R.funDisplayText=m):"t"===P?(R.type=11,R.funDisplayText=C):"g"===P?(R.type=12,R.funDisplayText=T):F--);break;case":":n(),w&&(R.type=22,R.funDisplayText=v);break;case"/":n(),w&&(R.type=21,R.funDisplayText=S);break;default:l(w)}R.type&&15!==R.type&&B.push(R)}while(++F<y)}else B.push({type:12,funDisplayText:T})},format:function(t){var r="";return t!==e&&(t=l(t),this.items.forEach((function(e){r+=e.funDisplayText(t,e)}))),r}};var g=gr.utility={CreateDateTime:function(){return new n},DateTimeFormat:function(e,t){return new h.DateTimeFormatter(t).format(l(e))},NumberFormat:function(e,t){return new h.NumericFormatter(t).format(e)},NumberFormatToBigHZ:function(e,t){var r,o="$$0";if(t>0)for(o+=".",r=0;t>r;r++)o+="0";return g.NumberFormat(e,o)},NumberFormatToBigHZAmount:function(e){return g.NumberFormat(e,"$$")},NumberRound45:function(e,t){var r=Math.pow(10,t);return Math.round(e*r)/r},NumberRound465:function(e,t){var r,o,a=Math.pow(10,t+2);return e=Math.floor(e*a),e-=(o=e%100-(r=e%10))+r,o>=60?e+=100:50===o&&(r>0?e+=100:e%1e3/100%2&&(e+=100)),e/a},ColorFromRGB:function(t,r,o,a){return a===e&&(a=1),u(t,r,o,a)}}}(),function(e){var t=gr.enum_,r=gr.helper,o=gr.format,a=gr.utility,n=r.ensureNameText,i=r.enumName2Value,l=r.enumValue2Name,s=r.prototypeCopyExtend,u=(o.BooleanFormatter,o.DateTimeFormatter),c=o.NumericFormatter,d=gr.exp={},h=function(e){for(var t,r,o=e.length,a=0,n=0,i=0,l=[];o>a;)t=e[a],i?")"===t?i--:"("===t&&i++:","===t?((r=e.substring(n,a))&&l.push(r),n=a+1):"("===t&&++i,++a;return(r=e.substring(n,a))&&l.push(r),l},p=d.Summary=function(){};p.prototype={init:function(e,t){var r=this;e&&(r.paramExp=new v(r.report,e)),t&&(r.displayField=r.report.RunningFieldByName(t))},getAsFloat:function(){var e=this;return e.valueField?e.valueField.AsFloat:e.value},getValue:function(){return this.getAsFloat()},setValue:function(e){var t=this;t.valueField?t.valueField.AsFloat=e:t.value=e},isDateTimeValue:function(){var e=this;return e.argExp&&e.argExp.isSingleVariable()&&e.argExp.varItems[0].varField.isDateTimeValue()},beginSummaryValue:function(){var t=this,r=t.SummaryFun;t.recordCount=0,4===r||5===r?t.value=e:27!==r&&28!==r&&(t.value=0),t.values=[]},summaryCurRecord:function(){var t=this,r=t.values,o=t.SummaryFun,a=t.paramExp,n=a?a.calculate():0;switch(++t.recordCount,o){case 1:case 2:case 27:case 28:isNaN(n)||(t.value+=n);break;case 4:case 5:a&&!a.isNull()&&(t.value===e?t.value=n:(5===o&&t.value<n||4===o&&t.value>n)&&(t.value=n,t.displayField&&(t.stringValue=t.displayField.DisplayText)));break;case 6:case 7:case 8:case 9:case 10:case 11:r.push_back(n);break;case 12:case 13:a&&a.isNull()&&(t.value+=1);break;case 16:case 17:case 15:case 20:case 21:case 22:case 23:case 24:case 25:a&&!a.isNull()&&r.push(n);break;case 14:a&&r.push(a.getTextForDistinct());break;case 19:case 18:a&&(n=a.getTextForDistinct(),(0===t.value||19===o&&t.value.localeCompare(n)<0||18===o&&t.value.localeCompare(n)>0)&&(t.value=n));break;case 26:t.value+=Math.abs(t.Calculate())}},endSummaryValue:function(){var t=this,r=t.values?t.values.length:0;switch(t.SummaryFun){case 2:t.recordCount>0?t.value/=t.recordCount:t.value=e;break;case 3:t.value=t.recordCount;break;case 6:case 20:t.value=r>1?t.devSq()/(r-1):e;break;case 7:case 21:t.value=r>1?t.devSq()/r:e;break;case 8:case 22:t.value=r>1?Math.sqrt(t.devSq()/(r-1)):e;break;case 9:case 23:t.value=r>1?Math.sqrt(t.devSq()/r):e;break;case 10:case 24:t.value=t.aveDev();break;case 11:case 25:t.value=t.devSq();break;case 16:case 17:if(t.values.sort((function(e,t){return e-t})),r<t.rankNo)return e;t.value=t.values[17===t.SummaryFun?r-t.rankNo:t.rankNo];break;case 13:t.value=t.recordCount-t.value;break;case 15:t.value=t.average();break;case 14:t.value=t.distinct()}},average:function(){var t=this.values.length,r=0;return this.values.forEach((function(e){r+=e})),t?r/t:e},aveDev:function(){var t=this.values.length,r=average(),o=0;return this.values.forEach((function(e){o+=Math.abs(e-r)})),t?o/t:e},devSq:function(){var e=average(),t=0;return this.values.forEach((function(r){var o=r-e;t+=o*o})),t},distinct:function(){var e,t,r=this,o=1,a=r.values.length,n=a;for(r.values.sort((function(e,t){return e.localeCompare(t)})),e=r.values[0];a>o;)e===(t=r.values[o++])?n--:e=t;return n}};var f=function(e,t,r){var o,a=this,n=h(r),i="";a.report=e,a.SummaryFun=t,n.length>0&&(o=n[0]),n.length>1&&(a.rankNo=parseInt(n[1])),a.init(o),a.paramExp&&(1===(n=a.paramExp.varItems).length&&(i=n[0].varField.object.Format)),a.formater=new c(i)};f.prototype={type:4,getDisplayText:function(){return this.formater.format(this.getAsFloat())},getExpText:function(){var e=this;return l(t.SummaryFun,e.SummaryFun)+"("+e.paramExp?e.paramExp.getExpText():""+e.RankNo?","+e.RankNo:")"}},s(f,p);var g=function(e,t,r){var o=this,a=h(r);o.report=e,o.MathFun=t,o.paramExps=[],a.forEach((function(t){o.paramExps.push(new v(e,t))}))};g.prototype={type:5,getAsFloat:function(){var e,r,o=this.MathFun,n=this.paramExps,i=n.length,s=1===i,u=0;if(1===o||2===o||22===o||9===o?s=2==i:20!==o&&21!==o||(s=i>1),!s)return alert("表达式中函数 '"+l(t.MathFun,o)+"' 的参数未正确提供。"),NaN;switch(e=n[0].calculate(),r=2===i?n[1].calculate():0,o){case 1:u=a.NumberRound45(e,r);break;case 2:u=a.NumberRound465(e,r);break;case 5:u=Math.abs(e);break;case 6:u=Math.acos(e);break;case 7:u=Math.asin(e);break;case 8:u=Math.atan(e);break;case 9:u=Math.atan2(e,r);break;case 15:u=Math.ceil(e);break;case 16:u=Math.cos(e);break;case 17:u=Math.exp(e);break;case 18:u=Math.floor(e);break;case 19:u=Math.log(e);break;case 20:if(u=e,i>1&&(r>e&&(u=r),i>2))for(;i-- >2;)(e=n[i].calculate())>u&&(u=e);break;case 21:if(u=e,i>1&&(e>r&&(u=r),i>2))for(;i-- >2;)u>(e=n[i].calculate())&&(u=e);break;case 22:u=Math.pow(e,r);break;case 23:u=Math.round(e);break;case 24:u=Math.sin(e);break;case 25:u=Math.sqrt(e);break;case 26:u=Math.tan(e)}return u},getValue:function(){var e=this.valueField;return e?e.AsFloat:this.getAsFloat()},getDisplayText:function(){var e=this.valueField;return e?e.DisplayText:this.getAsFloat()+""},getExpText:function(){for(var e=this.paramExps,r=e.length,o=l(t.MathFun,this.MathFun)+"(";r>0;)o+=e[0].getExpText();return o+")"},isDateTimeValue:function(){return 0}};var m=function(e,r){var o=this,a=r.split(",");o.var=i(t.SystemVarType,a[0]),a.length>1&&(o.groupIndex=parseInt(a[1])),o.report=e};m.prototype={type:3,getAsFloat:function(){var e=this;return e.report.SystemVarValue2(e.var,e.groupIndex)},getValue:function(){return this.getAsFloat()},getDisplayText:function(){return this.var>0?this.getAsFloat()+"":""},getExpText:function(){var e=this;return"SystemVar("+l(t.SystemVarType,e.var)+e.groupIndex?","+e.groupIndex:")"},isDateTimeValue:function(){return 1===this.var}};var C=function(e){this.oParameter=e};C.prototype={type:2,getAsFloat:function(){return this.oParameter.AsFloat},getValue:function(){return this.oParameter.Value},getDisplayText:function(){var e=this;return e.valueField?e.valueField.DisplayText:e.oParameter.DisplayText},getExpText:function(){return n(this.oParameter.Name)},isDateTimeValue:function(){return 6===this.oParameter.DataType}};var T=function(e){this.object=e};T.prototype={type:1,getAsFloat:function(){return this.object.AsFloat},getValue:function(){return this.object.Value},getDisplayText:function(){return this.object.DisplayText},getExpText:function(){return n(this.object.Name)},isDateTimeValue:function(){return 6===this.object.FieldType}};var x=function(e){this.object=e};x.prototype={type:6,getAsFloat:function(){return parseFloat(this.object.DisplayText)},getValue:function(){return this.getDisplayText()},getDisplayText:function(){return this.object.DisplayText},getExpText:function(){return n(this.object.Name)},isDateTimeValue:function(){return 0}};var b=function(e,t,r){var o=this;o.varField=e,o.beginIndex=t,o.endIndex=r},S=function(e,t){function r(){for(u=c[a];C.test(u);)u=c[++a]}function o(e,r){var o=u===e;return o&&(-1===(a=t.indexOf(r,n))?m=!1:(d=t.substring(n+1,a),i=++a)),o}var a,n,i,l,s,u,c,d,h,p,f,g=this,m=!0,C=/\s/,T=/[\d.]/,x=/[()+-\/%*]/,S=/[()+-\/%*\s]/;for(s=(c=t.split("")).length,g.expText=t,g.varItems=[],a=0;s>a&&m;)if(r(),x.test(u)||T.test(u))a++;else{if(n=a,o("{","}"))p=g.decodeVariable(e,d,1);else{if(!o("[","]")){for(;s>a&&!S.test(c[a]);)a++;if(i=a,!(d=t.substring(n,i)))continue}if(r(),"("===u){for(l=++a,f=1;s>a;)if(")"===(u=c[a++])){if(0>=--f)break}else"("===u&&f++;h=t.substring(l,a-1),i=a,p=g.decodeFunction(e,d,h)}else p=g.decodeVariable(e,d,0)}p?g.varItems.push(new b(p,n,i)):m=!1}g.valid=m};S.prototype={calculate:function(){var e=this,t=0,r="",o=NaN;return e.valid&&(e.varItems.forEach((function(o){t<o.beginIndex&&(r+=e.expText.substring(t,o.beginIndex)),t=o.endIndex,r+=o.varField.getAsFloat()+""})),r+=e.expText.substr(t),((o=gr.script.calcExp(r))>=Number.POSITIVE_INFINITY||o<=Number.NEGATIVE_INFINITY)&&(o=NaN)),o},isSingleVariable:function(){var e=this;return 1===e.varItems.length&&0===e.varItems[0].beginIndex&&e.varItems[0].endIndex===e.expText.length}};var v=function(e,t){S.call(this,e,t)};v.prototype={decodeVariable:function(t,r,o){var a,n=e;return o?(a=t.ParameterByName(r))&&(n=new C(a)):(a=t.RunningFieldByName(r))?n=new T(a):(a=t.ParameterByName(r))?n=new C(a):(a=t.ControlByName(r))&&(n=new x(a)),n},decodeFunction:function(e,r,o){var a,n=i(t.SummaryFun,r);return n>=0?a=new f(e,n,o):"SystemVar"===r?a=new m(e,o):(n=i(t.MathFun,r))>=0&&(a=new g(e,n,o)),a},getExpText:function(){var e=this,t=0,r="";return e.varItems.forEach((function(o){t<o.beginIndex&&(r+=e.expText.substring(t,o.beginIndex)),t=o.endIndex,r+=o.varField.getExpText()})),r+=e.expText.substr(t)},getTextForDistinct:function(){var e=this;return e.isSingleVariable()?e.varItems[0].varField.getDisplayText():e.calculate()+""},isNull:function(){return this.varItems.some((function(e){return e.IsNull}))}},s(v,S);var y=function(e,t){var r,o,a,n=this,i=0,l="";for(r=t.indexOf(":");r>=0&&!(-1===(o=t.indexOf("[",i))||o>r)&&-1!==(o=t.indexOf("]",r));)i=o+1,r=t.indexOf(":",i);r>=0&&(l=n.format=t.substr(r+1),t=t.substr(0,r)),S.call(n,e,t),!l&&n.isSingleVariable()||(!(a=n.isSingleVariable()&&n.varItems[0].varField.isDateTimeValue())&&l&&(a=/[yMdthHms]/.test(l)&&!/[0#e$]/.test(l)),n.formater=a?new u(l):new c(l))};y.prototype={getDisplayText:function(){var e,t=this;return t.valid?t.formater?(e=t.isSingleVariable()?t.varItems[0].varField.getValue():t.calculate(),t.formater.format(e)):t.varItems[0].varField.getDisplayText():'"'+this.expText+'" 不是有效的运算表达式'}},s(y,S);var F=function(e,t){y.call(this,e,t)};F.prototype={decodeVariable:v.prototype.decodeVariable,decodeFunction:v.prototype.decodeFunction,isPureNumeric:function(){var e=this;return c.prototype.isPrototypeOf(e.formater)||e.isSingleVariable()&&!e.varItems[0].varField.isDateTimeValue()}},s(F,y);var w=function(e){this.oParameter=e};w.prototype={getAsFloat:function(){return this.oParameter.AsFloat},getValue:function(){return this.oParameter.Value},getDisplayText:function(){return this.oParameter.DisplayText},isDateTimeValue:function(){return 6===this.oParameter.DataType}};var D=function(e,t){this.textBuilder=e,this.varType=t};D.prototype={getAsFloat:function(){function e(){var e,t,r=a.graphs,o=r.length;for(e=0;o>e&&!(t=r[e]).some((function(e){return e===n}));e++);return t}var t,r=this,o=r.textBuilder,a=o.chart,n=o.seriesIndex,i=o.groupIndex;if(a.IsScatterGraph())switch(t=a.Value(n,i),r.varType){case 1:t=t.x;break;case 2:t=t.y;break;case 3:t=t.z;break;case 5:t=t.z/a.GetSeriesTotalValue(n);break;case 7:t=a.GetSeriesTotalValue(n)}else switch(t=a.Value(n,i),r.varType){case 4:t/=a.GetGroupTotalValue(e(),i);break;case 6:t=a.GetGroupTotalValue(e(),i);break;case 5:t/=a.GetSeriesTotalValue(n);break;case 7:Val=a.GetSeriesTotalValue(n)}return t},getValue:function(){return this.getAsFloat()},getDisplayText:function(){var e=this,t=e.varType,r=e.textBuilder,o=r.seriesIndex,n=r.groupIndex,i=r.chart,l=i.IsScatterGraph(),s=i.graphSerieses[o],u=e.getAsFloat(),c=0;if(l)switch(t){case 1:c=1;break;case 2:c=2;break;case 3:case 7:c=3;break;case 5:c=5;break;case 8:c=4}else switch(t){case 1:case 8:case 9:c=4;break;case 2:case 6:case 7:c=2;break;case 4:case 5:c=5}switch(c){case 1:u=i.XAxis.ScaleFormatParser.format(u);case 2:u=l?i.YAxisOfSeries(s).ScaleFormatParser.format(u):s.ValueFormatParser.format(u);break;case 3:u=s.ValueFormatParser.format(u);break;case 4:u=8===t?i.SeriesLabel(o):i.GroupLabel(n);break;case 5:u=a.NumberFormat(u,"0.00%")}return u},isDateTimeValue:function(){return 0}};var A=function(e,t){y.call(this,e,t)};A.prototype={decodeVariable:function(t,r,o){var a=t.chart.report.ParameterByName(r);return a?new w(a):e},decodeFunction:function(e,r,o){var a;return"chartvar"===r.toLowerCase()&&((o=i(t.ChartVarType,o))>0&&(a=new D(e,o))),a}},s(A,y);var P=function(e){this.text=e};P.prototype={getDisplayText:function(){return this.text}},(d.TextBuilder=function(e,t){var r,o=this,a=e.XAxis?A:F,n=0,i=0,l=0;for(o.items=[],e.XAxis&&(o.chart=e,e=this);(i=t.indexOf("[#",l))>=0;)(l=t.indexOf("#]",i+2))>=0&&(r=new a(e,t.substring(i+2,l)),l+=2,r.valid&&(i>n&&o.items.push(new P(t.substring(n,i))),n=l,o.items.push(r)),i=l);n<t.length&&o.items.push(new P(t.substr(n)))}).prototype={forEach:function(e){this.items.forEach(e)},generateDisplayText:function(){for(var e,t,r,o,a,n=this.items,i=0,l=n.length,s="";l>i;){if(t=(e=n[i++]).varItems)for(a=t.length,o=0;a>o;++o)if(3===(r=t[o].varField).type&&r.var<0)return"";s+=e.getDisplayText()}return s},generateChartDisplayText:function(e,t){var r=this;return r.seriesIndex=e,r.groupIndex=t,r.generateDisplayText()},isStaticText:function(){return 1==this.items.length&&P.prototype.isPrototypeOf(this.items[0])}}}(),function(e){function t(e,t,r){return new g(e-r,t-r,e+r,t+r)}gr.dom={};var r=gr.enum_,a=gr.const_,n=gr.common,i=gr.helper,l=gr.format,s=gr.exp,u=l.BooleanFormatter,c=l.DateTimeFormatter,d=l.NumericFormatter,h=s.Summary,p=s.TextBuilder,f=n.DateTime,g=n.Rect,m=n.Pen,C=n.Border,T=n.Font,x=n.FontWrapper,b=n.TextFormat,S=n.Context,v=n.Graphics,y=n.HtmlStyles,F=n.HtmlElement,w=i.assignJSONMembers,D=i.enumMemberValid,A=i.enumBitMemberValid,P=i.colorMemberValid,R=i.fontString,B=i.fontHeight,N=i.intFixed,I=i.pixelsToHtml,L=i.percentToHtml,E=i.cloneDate,V=i.confirmDateValue,M=i.confirmCloneDateValue,k=i.strimDate,H=i.incDate,G=(i.incDate2,i.confirmBooleanValue),_=i.ensureNameText,O=i.enumName2Value,W=i.enumValue2Name,U=i.rgba2color,z=i.colorAlpha,J=i.color2rgba,Y=i.colorGradientLight,j=i.colorGradientDark,X=i.prototypeLinkExtend,Z=i.prototypeCopyExtend,q=i.createArray,Q=i.assignObjectEx,$=i.assignObject,K=i.assignObjectAtom,ee=i.parseXML,te=i.getRelativePosition,re=i.addEvent,oe=i.bindEvents,ae=gr.wr?gr.wr.wrPropNameEncode:e,ne=i.toDegree,ie=i.toRadians,le=function(){var e=0;return function(){return"-gr-canvas-"+e++}}(),se=function(e){var t=0,r=0;e.length&&(e.forEach((function(e){t+=e.pxHeight})),e.forEach((function(e){e.pctHeight=Math.round(100*e.pxHeight/t),r+=e.pctHeight})),e[0].pctHeight+=100-r)},ue=function(e){this.owner=e,this.items=[]};ue.prototype={loadFromJSON:function(e){var t,r=0;if(e)for(t=e.length;t>r;)this._doloadItem(e[r++])},getJsonMember:function(e){return this.owner.report.isWR?ae(e):e},assign:function(e){var t=this;t.RemoveAll(),e.forEach((function(e){t.Add().assign(e)}))},attachData:function(){for(var e=this.items,t=e.length;t--;)e[t].attachData()},prepare:function(){for(var e=this.items,t=0,r=e.length;r>t;)e[t++].prepare()},unprepare:function(){for(var e=this.items,t=e.length;t--;)e[t].unprepare()},generate:function(e){for(var t=this.items,r=0,o=t.length;o>r;)t[r++].generate(e)},itemByName:function(t){var r,o=this.items,a=o.length;if(t)for(t=t.toUpperCase();a--;)if((r=o[a]).Name.toUpperCase()===t)return r;return e},indexOfCOMIndex:function(e){return e?("number"!=typeof e&&(e=this.IndexByName(e||"")),--e):e=-1,e},indexOf:function(e){for(var t=this.items,r=t.length;r--;)if(e===t[r])return r;return-1},decodeItems:function(e){var t=this,r=[];return e&&e.split(";").forEach((function(e){var o;e=e.trim(),(o=t.itemByName(e))&&r.push(o)})),r},forEach:function(e){this.items.forEach(e)},_doloadItem:function(e){this.Add().loadFromJSON(e)},get Count(){return this.items.length},Item:function(e){return this.items[this.indexOfCOMIndex(e)]},Add:function(){var e=this._createItem();return this.items.push(e),e},Remove:function(e){(e=this.indexOfCOMIndex(e))>=0&&this.items.splice(e,1)},RemoveAll:function(){this.items=[]},IndexByName:function(e){var t=this.items,r=t.length;if(e)for(;r--;)if(t[r].Name===e)return r+1;return-1},ItemAt:function(t){var r=this.items;return--t>=0&&t<r.length?r[t]:e},ChangeItemOrder:function(e,t){var r=this.items;if(o,len=r.length,e!=(t=Math.max(1,Math.min(len,t))-1)&&e>0&&e--<=len)if(o=r[e],t>e)do{r[e]=r[e+1]}while(++e<t);else{do{r[e]=r[e-1]}while(--e>t);r[t]=o}}};var ce=function(e){ue.call(this,e)};ce.prototype={_doloadItem:function(e){var t=this.Add(O(r.ControlType,e[this.getJsonMember("Type")]));t&&t.loadFromJSON(e)},assign:function(e){var t=this;t.RemoveAll(),e.forEach((function(e){t.Add(e.ControlType).assign(e)}))},layout:function(){for(var e=this.items,t=this.owner.getRect(),r=0,o=e.length;o>r;)e[r++].layout(t)},generate:function(e){for(var t,r=this.items,o=r.length;o--;)(t=r[o]).Visible&&t.generate(e)},Add:function(t){var r=function(t,r){var o=e;switch(t){case 1:o=new Ae(r);break;case 2:o=new Ee(r);break;case 10:o=new Le(r);break;case 3:o=new Ne(r);break;case 4:o=new Re(r);break;case 5:o=new Be(r);break;case 7:o=new Me(r);break;case 8:o=new Pe(r);break;case 9:o=new He(r);break;case 11:o=new Rt(r);break;case 12:o=new Ve(r);break;case 13:o=new Oe(r);break;case 6:o=new ke(r)}return o}(t,this.owner);return r&&this.items.push(r),r}},X(ce,ue);var de=function(e){ue.call(this,e)};de.prototype={_doloadItem:function(e){var t=new et(this.owner);t.loadFromJSON(e),this.items.push(t)},addTo:function(e){var t,r,o=this,a=o.owner.ColumnContent.ContentCells,n=new et(o.owner);return o.items.push(n),t=new Fe(e,!1),e.items.push(t),n.TitleCell=t,t.Column=n,r=new ye(a),a.items.push(r),n.ContentCell=r,r.Column=n,n},Add:function(){return this.addTo(this.owner.ColumnTitle.TitleCells)},Remove:function(e){var t,r=this,o=r.owner,a=o.ColumnContent.ContentCells.items;(e=r.indexOfCOMIndex(e))>=0&&(t=r.items[e],a.splice(a.indexOf(t.ContentCell),1),function e(t,r){var o,a,n=t.indexOf(t);if(n>=0)return t.splice(n,1),1;for(n=t.length,a=0;n>a;a++)if((o=t[a]).GroupTitle&&e(o.SubTitles.items))return 1;return 0}(o.ColumnTitle.TitleCells.items,t.TitleCell),r.items.splice(e,1))},RemoveAll:function(){var e=this.owner;this.items=[],e.ColumnContent.ContentCells.items=[],e.ColumnTitle.TitleCells.items=[]}},X(de,ue);var he=function(e,t){ue.call(this,e),this.supcell=t};he.prototype={_doloadItem:function(e){var t=this,r=new Fe(t,e[t.getJsonMember("GroupTitle")]);r.loadFromJSON(e),t.items.push(r)},assign:function(e){var t=this;t.items=[],e.forEach((function(e){var r=new Fe(t,e.GroupTitle);t.items.push(r),r.assign(e),e.GroupTitle&&r.SubTitles.assign(e.SubTitles)}))},AddGroup:function(e,t){var r=new Fe(this,!0);return r.Name=e,r.Text=t,this.items.push(r),r},RemoveGroup:function(e){var t=this,r=t.Item(e);r&&r.GroupTitle&&(ue.prototype.Remove.call(t,e),t.items=t.items.concat(r.SubTitles.items))},Add:function(){},Remove:function(e){},RemoveAll:function(){}},X(he,ue);var pe=function(e){ue.call(this,e)};pe.prototype={_doloadItem:function(e){var t=new ye(this);t.loadFromJSON(e),this.items.push(t)},assign:function(e){var t=this;t.items=[],e.forEach((function(e){var r=new ye(t);t.items.push(r),r.assign(e)}))},Add:function(){},ChangeItemOrder:function(e,t){},Remove:function(e){},RemoveAll:function(){}},X(pe,ue);var fe=function(e){ue.call(this,e)};fe.prototype._createItem=function(){return new $e(this.owner)},X(fe,ue);var ge=function(e){ue.call(this,e)};ge.prototype={_createItem:function(){return new tt(this.owner)},_doloadItem:function(e){!e.PageGroup&&this.Add().loadFromJSON(e)}},X(ge,ue);var me=function(e){ue.call(this,e)};me.prototype._createItem=function(){return new ze(this.owner)},X(me,ue);var Ce=function(e){ue.call(this,e)};Ce.prototype._createItem=function(){return new Je(this.owner)},X(Ce,ue);var Te=function(e){ue.call(this,e)};Te.prototype._createItem=function(){return new ot(this.owner)},X(Te,ue);var xe=function(e){var t=this;t.owner=e,t.report=e.report,t.Tag=""};xe.prototype={afterLoad:function(e){},loadFromJSON:function(e){e&&(w(this,e),this.afterLoad(e))},assign:function(e){var t,r,o=this,a=o.Font,n=e.onclick,i=e.ondblclick;for(var l in e)o.hasOwnProperty(l)&&("object"!==(r=typeof(t=e[l]))&&"array"!==r&&(o[l]=t));a&&a.assign(e.Font),n&&(o.onclick=n),i&&(o.ondblclick=i),o.children&&o.children.forEach((function(t){var r=e[t];r&&(r.owner?o[t].assign(r):$(o[t],r))}))},registerEventClass:function(){var e=this,t=e.report.viewer._domevents,r=e.onclick,o=e.ondblclick;r&&!e.onclickClassID&&(t.push({obj:e,type:1,fun:r}),e.onclickClassID=t.length),o&&!e.ondblclickClassID&&(t.push({obj:e,type:2,fun:o}),e.ondblclickClassID=t.length)},resetEventClass:function(){var e=this;e.onclickClassID&&delete e.onclickClassID,e.ondblclickClassID&&delete e.ondblclickClassID},addElementEventClass:function(e){var t=this,r=t.report.viewer,o=t.onclickClassID,a=t.ondblclickClassID;o&&e.addClass(r._getEventCSSName(o)),a&&e.addClass(r._getEventCSSName(a))},getUsingFont:function(){return this.Font.UsingFont()},getJsonMember:function(e){return this.report.isWR?ae(e):e},toFillBack:function(){return this.BackColor!==this.owner.BackColor},getRunningNo:function(){var e=this.report.ownerSR;return(e?1e4*e.getRunningNo():0)+this._runningNo()},_runningNo:function(){return 0}};var be=function(e){var t=this;xe.call(t,e),t._borderCustom=!1,t.BackColor=e.BackColor,t.CanGrow=!1,t.CanShrink=!1,t.Font=new x(e.Font),t._freeCell=!0,t.setFreeCell(!1)};be.prototype={loadFromJSON:function(e){var t=this;e&&(t.setFreeCell(!!e[t.getJsonMember("FreeCell")]),w(t,e),t.afterLoad(e))},afterLoad:function(e){var t=this,r=t.report,o=r.viewer.alpha,a=r.isWR;P(t,"BackColor",o.background),P(t,"ForeColor",o.text),t.Font.loadFromJSON(e.Font,a),t.setBorderCustom(e[t.getJsonMember("BorderCustom")]),t._borderCustom&&t.Border.loadFromJSON(e.Border,o.border,a),t.FreeCell?t.Controls.loadFromJSON(e.Control):t.TextFormat.loadFromJSON(e,a)},assign:function(e){var t,r=this;r.setFreeCell(e.FreeCell),r.setBorderCustom(e.BorderCustom),xe.prototype.assign.call(r,e),r.Font.assign(e.Font),e.Border&&$(r.Border,e.Border),e.FreeCell?(r.Controls.assign(e.Controls),r.isSingleDockControl()&&(!(t=r.Controls.items[0]).onclick&&r.onclick&&(t.onclick=r.onclick),!t.ondblclick&&r.ondblclick&&(t.ondblclick=r.ondblclick))):$(r.TextFormat,e.TextFormat)},attachData:function(){var e=this;e.FreeCell?e.Controls.attachData():e._getWrapperClass().attachData.call(e)},prepare:function(){var e,t=this,r=t.report.viewer,o=t.Controls,a=t.Font.font;t.registerEventClass(),t.FreeCell&&(o.layout(),t.isSingleDockControl()||2===r.options.controlPosition||(e=t.getRect(),Ue.prototype.buildTableLayout.call(t,e.Width(),e.Height())),o.prepare(),t.isSingleDockControl()&&(!(e=o.items[0]).onclick&&t.onclick&&(e.onclick=t.onclick,e.onclickClassID=t.onclickClassID),!e.ondblclick&&t.ondblclick&&(e.ondblclick=t.ondblclick,e.ondblclickClassID=t.ondblclickClassID))),a&&(t.defaultFontStyle=r.selectFontItem(a)),t.tableRows&&t.tableRows.forEach((function(e){e.defaultStyle=r.selectSectionItem(e)})),t.defaultStyle=r.selectCellItem(t)},unprepare:function(){var e=this;e.FreeCell?e.Controls.unprepare():e._getWrapperClass().unprepare.call(e),e.resetEventClass(),delete e.defaultFontStyle,delete e.defaultStyle},doGenerate:function(e){var t=this,r=t.report.viewer,o=t.Controls,a=t.Font.font,n=t.defaultFontStyle;e.addClass(r.selectCell(t)),a&&n&&e.addClass(r.selectFont(a,n)),t.addStyles&&t.addStyles(e),t.FreeCell?t.isSingleDockControl()?o.items[0].generateInCell(e):(t.addElementEventClass(e),t.tableRows?(e.addStyle("padding","0px"),(e=new F("table",e)).addStyle("border-collapse","collapse"),Ue.prototype.generateTableRows.call(t,e)):(e.addStyle("position","relative"),o.generate(e))):(t.addElementEventClass(e),De.prototype.generateNormal.call(t,e))},setFreeCell:function(e){var t,r=this;r._freeCell!==e&&(r._freeCell=e,e?(r.Controls=new ce(r),delete r.ControlType):((t=r._getWrapperClass()).createWrapper.call(r),r.ControlType=t.ControlType,delete r.Controls))},setBorderCustom:function(e){var t=this;t._borderCustom!==e&&(t._borderCustom=e,e?t.Border=new C(12):delete t.Border)},setForeColor:function(e){var t=this;t.FreeCell?t.Controls.forEach((function(t){t.ForeColor=e})):t.ForeColor=e},getDisplayText:function(){return this._getWrapperClass().getDisplayText.call(this)},setDisplayText:function(e){return this._getWrapperClass().setDisplayText.call(this,e)},getControls:function(){var e=this;return e.FreeCell?e.Controls.items:[e]},isSingleDockControl:function(){var e=this.Controls.items;return 1===e.length&&5===e[0].Dock},isControlPositionClass:function(){return 0},_getDisplayText:function(){return this._getWrapperClass()._getDisplayText.call(this)}},Z(be,xe);var Se=function(e,t,r){var o=this;be.call(o,e),o.row=t,o.col=r,o.ColSpan=1,o.RowSpan=1,o.Text="",o.DataName=""};Se.prototype={generate:function(e){var t=this;e=new F("td",e),t.ColSpan>1&&e.addAttribute("colspan",t.ColSpan+""),t.RowSpan>1&&e.addAttribute("rowspan",t.RowSpan+""),t.doGenerate(e)},getOwnerGrid:function(){return this.owner},_getWrapperClass:function(){return Pe.prototype},getRect:function(){for(var e=this,t=e.owner,r=e.col,o=e.row,a=r+e.ColSpan,n=o+e.RowSpan,i=0,l=0;a>r;)i+=t.columns[r++].pxWidth;for(;n>o;)l+=t.rows[o++].pxHeight;return new g(0,0,i,l)},_runningNo:function(){return this.owner.owner._runningNo()},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){return this.FreeCell?"":this.getDisplayText()},set DisplayText(e){!this.FreeCell&&this.setDisplayText(e)}},Z(Se,be);var ve=function(e){be.call(this,e),this.Column=""};ve.prototype={afterLoad:function(e){var t=this;be.prototype.afterLoad.call(t,e),t.Column=t.owner.owner.Columns.itemByName(t.Column)},prepare:function(){var e=this;be.prototype.prepare.call(e),e.CanShrink&&(e.owner.CanShrink=1)},getOwnerGrid:function(){return this.owner.owner}},Z(ve,be);var ye=function(e){ve.call(this,e.owner),this.DataField=""};ye.prototype={_getWrapperClass:function(){return Re.prototype},afterLoad:function(e){var t=this;ve.prototype.afterLoad.call(t,e),t.Column.ContentCell=t},generate:function(e){var t=this.Column._crossOrderNo;e=new F("td",e),t&&e.addAttribute("_grcrossno",t),this.doGenerate(e)},generateMerge:function(e,t){var r=this,o=r.report.viewer,a=r.Font.font,n=r.Column._crossOrderNo;e=new F("td",e),n&&e.addAttribute("_grcrossno",n),e.addClass(o.selectCell(r)),a&&e.addClass(o.selectFont(a,r.defaultFontStyle)),t.generateInCell(e)},isControlPositionClass:function(){return this.FreeCell},get Name(){return this.Column.Name},set Name(e){this.Column.Name=e},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){return this.FreeCell?"":this.getDisplayText()},set DisplayText(e){!this.FreeCell&&this.setDisplayText(e)},getRect:function(){return new g(0,0,this.Column.pxWidth,this.owner.pxHeight)},_runningNo:function(){return this.getOwnerGrid().Recordset.RecordNo+1}},Z(ye,ve);var Fe=function(e,t){var r=this;ve.call(r,e.owner),r.SupCell=e.supcell,r.Visible=!0,r.GroupTitle=t,r.Text="",r.Height=0,t&&(r._name="",r.SubTitles=new he(r.owner,r))};Fe.prototype={_getWrapperClass:function(){return Pe.prototype},afterLoad:function(e){var t=this;ve.prototype.afterLoad.call(t,e),t.GroupTitle?(t._name=e[t.getJsonMember("Name")],t.SubTitles.loadFromJSON(e.ColumnTitleCell)):t.Column.TitleCell=t},prepare:function(){var e=this;ve.prototype.prepare.call(e),e.SubTitles&&e.SubTitles.prepare()},generate:function(e){e=new F("th",e),this.doGenerate(e)},addStyles:function(e){var t=this,r=t.GroupTitle?1:t.owner.layerCount-t.owner.generatingLayer;t.colspan>1&&e.addAttribute("colspan",t.colspan+""),r>1&&e.addAttribute("rowspan",r+"")},getRect:function(){var e=this,t=e.owner.layerCount-e.layer,r=e.Column,o=0;return e.GroupTitle?(t=1,(r=e.findFirstColumn())&&(o=e.findLastColumn().pxRight-r.pxLeft)):o=r.pxWidth,new g(0,0,o,e.owner.pxHeight*t)},findFirstColumn:function(){var t,r=this,o=r.Column;return r.GroupTitle&&(o=(t=r.SubTitles.items).length>0?t[0].findFirstColumn():e),o},findLastColumn:function(){var t,r=this,o=r.Column;return r.GroupTitle&&(o=(t=r.SubTitles.items).length>0?t[t.length-1].findLastColumn():e),o},encloseColumnObject:function(e){this.owner.owner._ColumnMoveTo(e,this)},get FreeCell(){return!!this._freeCell},set FreeCell(e){this.setFreeCell(e)},get BorderCustom(){return!!this._borderCustom},set BorderCustom(e){this.setBorderCustom(e)},get DisplayText(){return this.FreeCell?"":this.getDisplayText()},set DisplayText(e){!this.FreeCell&&this.setDisplayText(e)},get Name(){var e=this;return e.GroupTitle?e._name:e.Column.Name},set Name(e){var t=this;t.GroupTitle?t._name=e:t.Column.Name=e},EncloseColumn:function(e){var t=this.owner.owner,r=t.Columns.Item(e);r&&t._ColumnMoveTo(r,this)},AddSubGroupTitle:function(e,t){return this.SubTitles.AddGroup(e,t)}},Z(Fe,ve);var we=function(e){var t=this;xe.call(t,e),t.Left=0,t.Top=0,t.Width=0,t.Height=0,t.Anchor=3,t.Dock=0,t.Center=0,t.AlignColumnSide=3,t.AlignColumn="",t.AlignColumnEx="",t.Locked=!1,t.ShiftMode=1,t.PaddingLeft=0,t.PaddingRight=0,t.PaddingTop=0,t.PaddingBottom=0,t.BackColor=e.BackColor,t.BackStyle=2,t.ForeColor=e.ForeColor?e.ForeColor:z(0,t.report.viewer.alpha.text),t.Visible=!0,t.CustomDraw=!1,t.Border=new C(0),t.Font=new x(e.Font),t.Name="",t.CustomDrawScript=""};we.prototype={children:["Border"],attachData:function(){},afterLoad:function(e){var t=this,o=t.report.isWR,a=t.report.viewer.alpha;D(t,"Dock",r.DockStyle),D(t,"Center",r.CenterStyle),D(t,"AlignColumnSide",r.AlignColumnSideStyle),D(t,"ShiftMode",r.ShiftMode),D(t,"BackStyle",r.BackStyle),A(t,"Anchor",r.AnchorStyle),P(t,"BackColor",a.background),P(t,"ForeColor",a.text),t.Font.loadFromJSON(e.Font,o),t.Border.loadFromJSON(e.Border,a.border,o)},layout:function(t){var r,o=this,a=o.report,n=a.size2Pixel(o.Left),i=a.size2Pixel(o.Top),l=a.size2Pixel(o.Width),s=a.size2Pixel(o.Height),u=new g(n,i,n+l,i+s),c=a.getRunningColumn(o.AlignColumn),d=a.getRunningColumn(o.AlignColumnEx);if(c&&!c.Visible&&(c=e),d&&!d.Visible&&(d=e),c||d)switch(c&&d?d.pxLeft<c.pxLeft&&(r=d,d=c,c=r):d?c=d:d=c,o.AlignColumnSide){case 1:u.left=c.pxLeft,u.right=u.left+l;break;case 2:u.right=d.pxRight,u.left=u.right-l;break;default:u.left=c.pxLeft,u.right=d.pxRight}else{if(0!==o.Dock)switch(u=t.clone(),o.Dock){case 5:t.left=t.right,t.top=t.bottom;break;case 1:u.right=Math.min(t.right,t.left+l),t.left=u.right;break;case 2:u.bottom=Math.min(t.bottom,t.top+s),t.top=u.bottom;break;case 3:u.left=Math.max(t.left,t.right-l),t.right=u.left;break;case 4:u.top=Math.max(t.top,t.bottom-s),t.bottom=u.top}0!==o.Center&&5!==o.Dock&&(1!==o.Center&&3!==o.Center||(l=u.Width(),u.left=(t.left+t.right-l)/2,u.right=u.left+l),2!==o.Center&&3!==o.Center||(s=u.Height(),u.top=(t.top+t.bottom-s)/2,u.bottom=u.top+s))}o.pxRect=u,o.oAlignColumn=c,o.oAlignColumnEx=d},prepare:function(){var e=this,t=e.report.viewer,r=!e.owner.isSingleDockControl&&e.owner.isControlPositionClass();e.registerEventClass(),e.defaultStyle=t.selectControlItem(e),e.Font.font&&(e.defaultFontStyle=t.selectFontItem(e.Font.font)),r&&(e.defaultPositionStyle=t.selectPositionItem(e))},unprepare:function(){var e=this;e.resetEventClass(),delete e.defaultStyle,delete e.defaultFontStyle,delete e.defaultPositionStyle,delete e.oAlignColumn,delete e.oAlignColumnEx},prepareLayout:function(e){return e},generate:function(e){var t,r=this,o=r.report.viewer,a=r.pxRect;t=new F("span",e),r.addElementEventClass(t),t.addClass(o.selectControl(r)),r.Font.font&&t.addClass(o.selectFont(r.Font.font,r.defaultFontStyle)),r.defaultPositionStyle?t.addClass(o.selectPosition(r)):(t.addStyle("left",I(a.left)),t.addStyle("top",I(a.top)),t.addStyle("width",I(r.getContentWidth())),t.addStyle("height",I(r.getContentHeight()))),r.generateContent(r.prepareLayout(t))},generateInCell:function(e){var t=this;t.addElementEventClass(e),t.oAlignColumn&&t.setCrossNoAttr(e),t.generateContent(e)},generateContent:function(e){var t=this;t.CustomDraw?t.generateCanvas(e):t.generateNormal(e)},generateCanvas:function(e){var t=this,r=t.getRunningNo(),o=r?t.cloneCanvas(r):t;return t.report.registerCanvas(o,e),o},cloneCanvas:function(e){var t,r,o=this,a=new o.constructor(o.owner);for(t in a.runningNo=e,a.origin=o,a.assign(o),o)"object"!=typeof(r=o[t])||a[t]||(a[t]=r);return a},resizeCanvas:function(){var e=this.canvas;e.width=Math.min(e.parentNode.clientWidth,window.innerWidth),e.height=Math.min(e.parentNode.clientHeight,window.innerHeight),this.drawCanvas(1)},drawCanvas:function(e){var t=this,r=t.getOwnerDetailGrid();r&&r.syncElementData(t.canvas),t.report.fireControlCustomDraw(t)},setCrossNoAttr:function(e){var t=this.oAlignColumn._crossOrderNo;t&&e.addAttribute("_grcrossno",t)},toFillBack:function(){var e=this;return 1===e.BackStyle&&e.BackColor!==e.owner.BackColor},getRunningNo:function(){return this.owner.getRunningNo()},getContentWidth:function(){var e=this,t=e.Border;return e.pxRect.Width()-e.PaddingLeft-e.PaddingRight-t.getLeftWidth()-t.getRightWidth()},getContentHeight:function(){var e=this,t=e.Border;return e.pxRect.Height()-e.PaddingTop-e.PaddingBottom-t.getTopWidth()-t.getBottomWidth()},getOwnerDetailGrid:function(){var t,r=this.owner.owner,o=r?r.owner:e;return o&&(o.ColumnTitle?t=o:r.isPrototypeOf(Oe)&&(t=o.getOwnerDetailGrid())),t},SetBounds:function(e,t,r,o){var a=this;a.Left=e,a.Top=t,a.Width=r-e,a.Height=o-t},BringToFront:function(){var e=this.owner.Controls;e.ChangeItemOrder(e.indexOf(this),e.length)},SendToBack:function(){var e=this.owner.Controls;e.ChangeItemOrder(e.indexOf(this),1)},DrawDefault:function(){}},Z(we,xe);var De=function(e){var t=this;we.call(t,e),t.createWrapper(),t.AsTextBox=t};De.prototype={children:["Border","TextFormat"],afterLoad:function(e){var t=this;we.prototype.afterLoad.call(t,e),t.TextFormat.loadFromJSON(e,t.report.isWR)},createWrapper:function(){var e=this;e.PaddingLeft=2,e.PaddingRight=1,e.PaddingTop=1,e.PaddingBottom=1,e.CanGrow=!1,e.CanShrink=!1,e.ShrinkFontToFit=!1,e.ForeColor=e.owner.ForeColor?e.owner.ForeColor:z(0,e.report.viewer.alpha.text),e.TextFormat=new b,e.GetDisplayTextScript=""},prepareLayout:function(e){var t=this.TextFormat,r=t.TextAlign;return 16&r||(t.WordWrap||64&r?(e.addStyle("display","table"),(e=new F("span",e)).addStyle("display","table-cell"),e.addStyle("vertical-align",32&r?"middle":"bottom")):e.addStyle("line-height",I(this.getContentHeight()))),e},generateNormal:function(e){var t="<br />",r=this.getDisplayText();this.TextFormat.HtmlTags||(/[\r\n&<>"]/.test(r)&&(r=r.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/\r\n/g,t).replace(/\r/g,t).replace(/\n/g,t)),/  /.test(r)&&function(){var e,t=r.split(""),o=t.length,a=0;for(r="";o>a;)if(" "===(e=t[a])&&o-1>a&&" "===t[a+1])for(;o>a&&" "===t[a];)r+="&nbsp;",a++;else r+=e,a++}()),e.innerText=r},getDisplayText:function(){var e=this;return e.displayTextAssigned=!1,e.doingGetDisplayText||(e.doingGetDisplayText=!0,e.report.fireTextBoxGetDisplayText(e),e.doingGetDisplayText=!1),e.displayTextAssigned?e.assignedDisplayText:e._getDisplayText()},setDisplayText:function(e){this.assignedDisplayText=e,this.displayTextAssigned=!0},DrawDefault:function(){var e=this,t=e.getDisplayText(),r=e.canvas;e.report.Graphics.DrawFormatText(t,0,0,r.width,r.height,e.TextFormat)}},Z(De,we);var Ae=function(e){var t=this;De.call(t,e),t.Text="",t.Parameter=""};Ae.prototype={ControlType:1,_getDisplayText:function(){var e=this;return e.valueField?e.valueField.DisplayText:e.oParameter?e.oParameter.DisplayText:e.Text},attachData:function(){var e=this;e.Parameter&&(e.oParameter=e.report.ParameterByName(e.Parameter))},unprepare:function(){De.prototype.unprepare.call(this),delete this.oParameter},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsStaticBox(){return this}},Z(Ae,De);var Pe=function(e){De.call(this,e),this.Text=""};Pe.prototype={ControlType:8,createWrapper:function(){De.prototype.createWrapper.call(this),this.Text=""},_getDisplayText:function(){return this.textBuilder.generateDisplayText()},attachData:function(){var e=this;e.textBuilder=new p(e.report,e.Text)},getGroupVars:function(){var e=[];return this.textBuilder.forEach((function t(r){r.varItems&&r.varItems.forEach((function(r){var o=r.varField,a=o.type;4!==a&&2!==a&&5!==a||e.push(o),4===a?o.paramExp&&t(o.paramExp):5===a&&o.paramExps.forEach(t)}))})),e},isPureNumericExpression:function(){var e=this;return e.prepare(),e.textBuilder&&1===e.textBuilder.items.length&&e.textBuilder.items[0].isPureNumeric()},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsFloat(){var e=this.textBuilder.items[0],t=e.__proto__.hasOwnProperty("calculate")?e.calculate():0;return isNaN(t)?0:t},get Value(){return this.getDisplayText()},get AsMemoBox(){return this}},Z(Pe,De);var Re=function(e){De.call(this,e),this.DataField=""};Re.prototype={ControlType:4,createWrapper:function(){De.prototype.createWrapper.call(this),this.DataField=""},attachData:function(){var e=this;e.oDataField=e.report.RunningFieldByName(e.DataField)},unprepare:function(){De.prototype.unprepare.call(this),delete this.oDataField},_getDisplayText:function(){var e=this.oDataField;return e?e.DisplayText:""},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsFieldBox(){return this}},Z(Re,De);var Be=function(e){var t=this;De.call(t,e),t.SummaryFun=1,t.RankNo=1,t.DataField="",t.DisplayField="",t.Format=""};Be.prototype={ControlType:5,afterLoad:function(e){De.prototype.afterLoad.call(this,e),D(this,"SummaryFun",r.SummaryFun)},attachData:function(){var e,t,r=this,o=r.Format;r.init(r.DataField,r.DisplayField),o||(e=r.report.RunningFieldByName(r.DataField))&&(o=e.Format),(t=r.paramExp)&&1===t.varItems.length&&1===t.varItems[0].type&&6===t.varItems[0].object.FieldType?r.formater=new c(o):r.formater=new d(o)},_getDisplayText:function(){var e,t=this,r=t.SummaryFun,o=t.valueField;if(18===r||19===r||t.displayField)e=o?o.DisplayText:t.value;else{if(o){if(o.IsNull)return"";e=o.AsFloat}else e=t.value;e=t.formater.format(e)}return e},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get Value(){return this.getValue()},set Value(e){this.setValue(e)},get AsSummaryBox(){return this}},Z(Be,De),Z(Be,h);var Ne=function(e){var t=this;De.call(t,e),t.SystemVar=-1,t.GroupIndex=1,t.Format=""};Ne.prototype={ControlType:3,afterLoad:function(e){De.prototype.afterLoad.call(this,e),D(this,"SystemVar",r.SystemVarType)},attachData:function(){var e=this,t=e.Format;1===e.SystemVar?e.formater=new c(t):e.formater=new d(t)},_getDisplayText:function(){var e=this,t=e.SystemVar;return t>0?e.formater.format(e.report.SystemVarValue2(t,e.GroupIndex)):""},get DisplayText(){return this.getDisplayText()},set DisplayText(e){this.setDisplayText(e)},get AsSystemVarBox(){return this}},Z(Ne,De);var Ie=function(e){we.call(this,e)};Ie.prototype={generateContent:function(e){this.generateCanvas(e)},drawCanvas:function(e){var t=this;t.draw(e),t.CustomDraw&&we.prototype.drawCanvas.call(t,e)},DrawDefault:function(){this.draw()}},Z(Ie,we);var Le=function(e){var t=this;Ie.call(t,e),t.L2R=!0,t.U2D=!0,t.LinePen=new m};Le.prototype={ControlType:10,children:["LinePen"],afterLoad:function(e){var t=this,r=t.report,o=r.PixelsToUnit(t.LinePen.Width);Ie.prototype.afterLoad.call(t,e),t.LinePen.loadFromJSON(e.Pen,r.viewer.alpha.stroke,r.isWR),t.Height<o&&(t.Height=o,t.HL=1),t.Width<o&&(t.Width=o,t.VL=1)},draw:function(e){var t,r=this,o=r.canvas,a=new S(o.getContext("2d")),n=0,i=0,l=r.VL?0:o.width,s=r.HL?0:o.height;a.selectPen(r.LinePen),r.L2R||(t=n,n=l,l=t),r.U2D||(t=i,i=s,s=t),a.drawLine(n,i,l,s)},get AsLine(){return this}},Z(Le,Ie);var Ee=function(e){var t=this;Ie.call(t,e),t.ShapeType=4,t.FillColor=0,t.FillStyle=2,t.CornerDx=4,t.CornerDy=4,t.LinePen=new m};Ee.prototype={ControlType:2,children:["LinePen"],afterLoad:function(e){var t=this,o=t.report,a=t.report.viewer.alpha;Ie.prototype.afterLoad.call(t,e),D(t,"ShapeType",r.ShapeBoxType),D(t,"FillStyle",r.BackStyle),P(t,"FillColor",a.background),t.LinePen.loadFromJSON(e.Pen,a.stroke,o.isWR)},draw:function(e){var t,r,o,a=this,n=a.canvas,i=n.width,l=n.height,s=new S(n.getContext("2d")),u=a.LinePen.Width/2,c=1===a.FillStyle;switch(s.selectPen(a.LinePen),c&&s.selectFillColor(a.FillColor),a.ShapeType){case 7:s.drawLine(0,u,i,u);break;case 1:t=s.circle;break;case 2:t=s.ellipse;break;case 3:t=s.rectangle;break;case 6:t=s.square;break;case 4:t=s.roundRectangle,r=1;break;case 5:t=s.roundSquare,r=1}t&&(o=[u,u,i-2*u,l-2*u],r&&o.push(a.CornerDx,a.CornerDy),o.push(c),t.apply(s,o)),c&&s.restoreFillStyle(),s.restorePen()},get AsShapeBox(){return this}},Z(Ee,Ie);var Ve=function(e){var t=this;Ie.call(t,e),t.Text="",t.BarcodeType=4,t.BarWidth=0,t.BarRatio=2,t.CheckSum=!1,t.Direction=1,t.Alignment=2,t.CaptionPosition=3,t.CaptionAlignment=2,t.PDF417Rows=0,t.PDF417Columns=0,t.PDF417ErrorLevel=0,t.PDF417Simple=!1,t.QRCodeVersion=0,t.QRCodeErrorLevel=1,t.QRCodeMask=0,t.DtmxEncoding=2,t.DtmxMatrixSize=2,t.DtmxModuleSize=0};Ve.prototype={ControlType:12,attachData:function(){var e=this;e.textBuilder=new p(e.report,e.Text)},afterLoad:function(e){var t=this,o=e[t.getJsonMember("BarcodeType")];switch(Ie.prototype.afterLoad.call(t,e),o){case"Code25_Interleaved":t.BarcodeType=1;break;case"Code25_Industrial":t.BarcodeType=2;break;case"Code25_Matrix":t.BarcodeType=3;break;case"Code39Extended":t.BarcodeType=5;break;case"Code93Extended":t.BarcodeType=10;break;default:D(t,"BarcodeType",r.BarcodeType)}D(t,"Direction",r.BarcodeDirection),D(t,"Alignment",r.StringAlignment),D(t,"CaptionPosition",r.BarcodeCaptionPosition),D(t,"CaptionAlignment",r.StringAlignment),D(t,"DtmxEncoding",r.DtmxEncoding),D(t,"DtmxMatrixSize",r.DtmxMatrixSize)},getDisplayText:function(){return this.textBuilder.generateDisplayText()},generateCanvas:function(e){var t,r=this,o=r.BarcodeType,a=encodeURI(window.rubylong.grhtml5.barcodeURL),n={type:o,text:r.DisplayText,codepage:r.report.CodePage};t=Ie.prototype.generateCanvas.call(r,e),1!==r.CaptionPosition&&(n.requireShowText=!0),a&&n.text&&(51===o||54===o?(n.Version=r.QRCodeVersion,n.ErrorLevel=r.QRCodeErrorLevel,n.Mask=r.QRCodeMask):50===o?(n.Rows=r.PDF417Rows,n.Columns=r.PDF417Columns,n.ErrorLevel=r.PDF417ErrorLevel,n.Simple=r.PDF417Simple):52===o||53===o?(n.Encoding=r.DtmxEncoding,n.MatrixSize=r.DtmxMatrixSize,n.ModuleSize=r.DtmxModuleSize):n.CheckSum=r.CheckSum,a+="?params="+encodeURIComponent(JSON.stringify(n)),window.rubylong.ajax(a,(function(e,t){var r,o=this;t&&((r=o.getOwnerDetailGrid())&&r.syncElementData(o.canvas),o._dodraw(JSON.parse(e.responseText)))}),t,"POST"))},draw:function(e){},_dodraw:function(e){function t(e){return 50===e||51===e||54===e||52===e||53===e}function r(e){return parseInt(e,16)}var o,a,n,i,l,s,u,c,d,h=this,p=h.canvas,f=new S(p.getContext("2d")),m=h.getUsingFont(),C=h.BackColor,T=h.ForeColor,x=h.BarcodeType,b=h.Direction,v=h.CaptionPosition,y=e.cols,F=e.rows,w=e.graph,D=w?w.length:0,A=e.text?e.text:h.DisplayText,t=t(x),P=1===b||2===b,R=!(d=x,15!==d&&14!==d&&16!==d&&17!==d&&18!==d||1!==b||3!==v),N=0,I=B(m),L=t?Math.max(I,10):0,E=0,V=0,M=0,k=0,H=!1,G=0,_=0,O=new g(0,0,p.width,p.height),W=O.clone(),U=O.clone();if(y){if(f.selectFont(m),1!==v&&(P?2===v?(U.bottom=U.top+I,W.top=U.bottom+L):(U.top=U.bottom-I,W.bottom=U.top-L):2===v?(U.left=U.right-I,W.right=U.left-L):(U.right=U.left+I,W.left=U.right+L)),o=P?W.Width():W.Height(),a=P?W.Height():W.Width(),10>o||10>a)return void f.restoreFont();1!=v&&(N=f.measureTextWidth(A)),t?function(){var e,t,n,d,h,p,g,m=o/y,S=a/F,v={init:function(){u.right=W.left,u.bottom=W.top+S},draw:function(){u.right+=m*h,f.fillRect2(u,s),u.left=u.right},end:function(){u.right+=m*h,f.fillRect2(u,s),u.top=u.bottom,u.bottom+=S,u.left=W.left,u.right=W.left}},A={init:function(){u.left=W.right,u.top=W.bottom-S},draw:function(){u.left-=m*h,f.fillRect2(u,s),u.right=u.left},end:function(){u.left-=m*h,f.fillRect2(u,s),u.bottom=u.top,u.top-=S,u.left=W.right,u.right=W.right}},R={init:function(){u.bottom=W.top,u.left=W.right-S},draw:function(){u.bottom+=m*h,f.fillRect2(u,s),u.top=u.bottom},end:function(){u.bottom+=m*h,f.fillRect2(u,s),u.right=u.left,u.left-=S,u.top=W.top,u.bottom=W.top}},B={init:function(){u.top=W.bottom,u.right=W.left+S},draw:function(){u.top-=m*h,f.fillRect2(u,s),u.bottom=u.top},end:function(){u.top-=m*h,f.fillRect2(u,s),u.left=u.right,u.right+=S,u.top=W.bottom,u.bottom=W.bottom}};switch(50!=x&&(m>S?m=S:S=m),G=(o-(i=m*y))/2,_=(a-(l=S*F))/2,P||(c=G,G=_,_=c),W.left+=G,W.right=W.left+i,W.top+=_,W.bottom=W.top+l,b){case 1:g=v;break;case 2:g=A;break;case 3:g=R;break;default:g=B}for(u=W.clone(),g.init(),D=w.length,c=0,t=0;F>t;++t){for(n=r(w[c++])<<4|r(w[c++]),s=n&(d=128)?T:C,h=1,d>>=1,e=1;y>e;++e)0==e%8&&(n=r(w[c++])<<4|r(w[c++]),d=128),s===(p=n&d?T:C)?++h:(g.draw(),s=p,h=1),d>>=1;g.end()}}():(function(){switch(x){case 15:E=15,V=0;break;case 16:case 17:case 18:E=12,V=12}}(),function(){function e(e){var t=r(e);return{w:p[t%4],lt:Math.floor(t/4)}}var t,l,s,d=h.Alignment,p=function(){var e=h.BarRatio;switch(x){case 1:case 2:case 4:case 14:case 15:case 5:case 13:case 16:case 17:case 18:case 19:case 20:2>e&&(e=2),e>3&&(e=3);break;case 3:2.25>e&&(e=2.25),e>3&&(e=3)}return[1,e,1.5*e,2*e]}(),g=function(t){for(var r=t.length,o=0;r-- >0;)o+=e(t[r]).w;return o}(w),m=h.BarWidth,S=N/A.length/10,v=2*a/5,y=R?a+2*I/3:a;if(M=S*E,k=S*V,n=m?report.UnitToPixels(m):(o-M-k)/g,!(H=(i=n*g+M+k)>o+1)){switch(d){case 1:G=M;break;case 2:G=(o-i)/2+M;break;default:G=o-i+M}switch(u=W,b){case 1:u.left+=G;break;case 2:u.right-=G;break;case 3:u.top+=G;break;default:u.bottom-=G}for(c=0;D>c;++c)switch(t=e(w[c]),m=t.w*n,l=2===t.lt?v:3==t.lt?y:a,s=0==t.lt?C:T,b){case 1:u.right=u.left+m,u.bottom=u.top+l,f.fillRect2(u,s),u.left=u.right;break;case 2:u.left=u.right-m,u.bottom=u.top+l,f.fillRect2(u,s),u.right=u.left;break;case 3:u.bottom=u.top+m,u.left=u.right-l,f.fillRect2(u,s),u.top=u.bottom;break;default:u.top=u.bottom-m,u.left=u.right-l,f.fillRect2(u,s),u.bottom=u.top}}}()),H?pdd.drawTextCenter("条宽度太大，条码无法完整显示",(O.left+O.right)/2,(O.top+O.bottom-I)/2):1!=v&&function(){var e,t,r,o,a=h.CaptionAlignment,l=1===a?33:2===a?34:36,s=h.Alignment,u=U.left+G;if(P?(3===v&&(_=-_),U.top+=_,U.bottom+=_):(2===v&&(G=-G),U.left+=G,U.right+=G),R)switch(c=0,x){case 15:u-=M,f.drawText(A.substr(c++,1),u,U.top),o=(u=U.left+G+4*n)+42*n,f.drawEqualSpaceText(A.substr(c,6),u,o,U.top),c+=6,o=(u=U.left+G+50*n)+41*n,f.drawEqualSpaceText(A.substr(c,6),u,o,U.top);break;case 14:o=(u+=4*n)+28*n,f.drawEqualSpaceText(A.substr(c,4),u,o,U.top),c+=4,o=(u=U.left+G+36*n)+27*n,f.drawEqualSpaceText(A.substr(c,4),u,o,U.top);break;case 17:case 18:f.fontSizeTo(Math.floor(.77*f.usingFont.Size)),I=B(f.usingFont),N=f.measureTextWidth("0"),u-=M,f.drawText("0",u,U.bottom-I),e=A.substr(6),N=f.measureTextWidth(e),u=U.right-G+k-N,f.drawText(e,u,U.bottom-I),f.restoreFont(),o=(u=U.left+G+4*n)+42*n,f.drawEqualSpaceText(A.substr(0,6),u,o,U.top);break;case 16:f.fontSizeTo(Math.floor(.77*f.usingFont.Point)),I=B(f.usingFont),e=A.substr(0,1),N=f.measureTextWidth(e),u-=M,f.drawText(e,u,U.bottom-I),e=A.substr(11),N=f.measureTextWidth(e),u=U.left+G+95*n+Math.max(k-N,2),f.drawText(e,u,U.bottom-I),f.restoreFont(),o=(u=U.left+G+11*n)+35*n,++c,f.drawEqualSpaceText(A.substr(c,5),u,o,U.top),o=(u=o+5*n)+35*n,c+=5,f.drawEqualSpaceText(A.substr(c,5),u,o,U.top)}else if(P){switch(s){case 1:U.right=U.left+i;break;case 2:U.left=(U.left+U.right-i)/2,U.right=U.left+i;break;default:U.left=U.right-i}f.drawTextAlign2(A,U,l)}else{switch(s){case 1:U.bottom=U.top+i;break;case 2:U.top=(U.top+U.bottom-i)/2,U.bottom=U.top+i;break;default:U.top=U.bottom-i}switch(t=U.right,a){case 1:r=U.top;break;case 2:r=(U.top+U.bottom-N)/2;break;default:r=U.bottom-N}f.drawTextRotate(A,t,r,270)}}(),f.restoreFont()}},get Value(){return this.getDisplayText()},get DisplayText(){return this.getDisplayText()},get AsBarcode(){return this}},Z(Ve,Ie);var Me=function(e){var t=this;we.call(t,e),t.Alignment=3,t.SizeMode=3,t.TransparentMode=0,t.RotateMode=0,t.ImageIndex=0,t.Picture="",t.ImageFile="",t.DataField=""};Me.prototype={ControlType:7,afterLoad:function(e){var t=this;we.prototype.afterLoad.call(t,e),D(t,"SizeMode",r.PictureSizeMode),D(t,"TransparentMode",r.PictureTransparentMode),D(t,"RotateMode",r.PictureRotateMode)},attachData:function(){var e=this;e.oDataField=e.report.RunningFieldByName(e.DataField)},generateNormal:function(e){var t,r,o,n,i,l,s,u,c=this,d=c.Picture,h=c.oDataField,p=c.ImageFiles,f=p?p[c.getOwnerDetailGrid().Recordset.RecordNo]:c.ImageFile,g=c.ImageIndex,m=c.SizeMode;if(d?n="data:image;base64,"+d:h?(n=h.AsString).length>256&&(n="data:image;base64,"+n):f?n=f:g&&(n=g),n)if(isNaN(n))if(5===m)e.addStyle("background-image","url("+n+")");else{if((t=c.pxRect)||(t=c.owner.getRect()),r=t.Width(),o=t.Height(),e.addStyle("text-align","center"),e.addStyle("vertical-align","middle"),(i=new F("img",e)).skipend=1,2===c.SizeMode)s=r,u=o;else try{(l=document.createElement("img")).src=n,3===c.SizeMode||l.width>r||l.height>o?l.width*o>r*l.height?s=r:u=o:l.width&&l.height?(s=l.width,u=l.height):(s=r,u=o)}catch(C){s=r,u=o}s&&i.addAttribute("width",Math.round(s)),u&&i.addAttribute("height",Math.round(u)),i.addAttribute("src",n)}else n=+n,e.addStyle("text-align","center"),e.addStyle("vertical-align","middle"),(i=new F("input",e)).skipend=1,i.addAttribute("type","checkbox"),i.addAttribute("id",c.getCheckBoxID()),i.addClass(a.CSS_CB),-1!==n&&-3!==n||i.addAttribute("checked"),h&&i.addAttribute(a.ATTR_FIELD,h.Name),c.report._has_cb=1},getCheckBoxID:function(){var e=this.owner.owner;return e.ContentCells?"CBC"+e.owner.Recordset.RecordNo:e.Header?"CBG"+e.recordset.recordNo:this.Name},set Text(e){this[e.length>256?"Picture":"ImageFile"]=e},get checked(){var e=this.oDataField,t=e?e.AsInteger:this.ImageIndex;return-1===t||-3===t},set checked(e){var t,r=this,o=r.oDataField,a=e?-1:-2;o?((t=o.owner).Edit(),o.AsInteger=a,t.Post()):r.ImageIndex=a,document.getElementById(r.getCheckBoxID()).checked=e},get AsPictureBox(){return this},LoadFromFile:function(e){var t=this,r=t.getOwnerDetailGrid();r?(t.ImageFiles||(t.ImageFiles={}),t.ImageFiles[r.Recordset.RecordNo]=e):t.ImageFile=e}},Z(Me,we);var ke=function(e){we.call(this,e)};ke.prototype={ControlType:6,get AsRichTextBox(){return this},generateNormal:function(e){e.innerText="不支持RichTextBox"}},Z(ke,we);var He=function(e){var t=this;we.call(t,e),t.HideOnRecordsetEmpty=!1,t.RelationFields="",t.Report=new at(e.report.viewer,t)};He.prototype={ControlType:9,afterLoad:function(e){var t=this,r=e.Report;we.prototype.afterLoad.call(t,e),t.Report.isWR=t.report.isWR,r&&t.Report.loadFromJSON(r)},prepare:function(){var e=this,t=e.report;we.prototype.prepare.call(e),t._srChildren||(t._srChildren=[]),t._srChildren.push(e),e.prepareRelationRecordset()},prepareRelationRecordset:function(){var e,t,r,o,a,n,i=this,l=i.RelationFields,s=i.report.DetailGrid,u=i.Report.DetailGrid;if(l&&u&&s&&(e=s.Recordset,r=u.Recordset,t=e.decodeFields(l),o=r.decodeFields(l),t.length===o.length&&r.RecordCount)){for(i._rmFields=t,i._rdFields=o,n=i._relations=[],r.First(),a=[],n.push(a),a.push(r.curRecord),r.keepValue(),r.Next();!r.Eof();)r.fieldsKeepedValueChanged(o)&&(a=[],n.push(a),r.keepValue()),a.push(r.curRecord),r.Next();n.sort((function(e,t){for(var r,a,n,i=0,l=o.length;l>i;){if(r=o[i++]._tableMember,a=e[0][r],(n=t[0][r])>a)return-1;if(a>n)return 1}return 0}))}},generateNormal:function(t){for(var r,o,a,n=this,i=n.Report.DetailGrid?n.Report.DetailGrid.Recordset:e,l=n._relations,s=n.report,u=s.DetailGrid,c=n.getOwnerDetailGrid(),d=n.Report.Parameters,h=d.Count;h>0;)a=(o=d.Item(h--)).Name,c?(r=s.FieldByName(a))?o.Value=r.Value:(r=s.ParameterByName(a))&&(o.Value=r.Value):(r=s.ParameterByName(a))?o.Value=r.Value:u&&((r=s.FieldByName(a))&&(o.Value=r.Value));l&&n.attachRelationTable(),(!n.HideOnRecordsetEmpty||!i||i.RecordCount)&&n.Report.generate(t),l&&n.detachRelationTable()},detachRelationTable:function(){var e=this.Report.DetailGrid.Recordset;e._dataTable=e._bakTable,e._relTblIndex=-1,delete e._bakTable},attachRelationTable:function(){function e(){for(var e,r,o=a._rmFields,n=a._rdFields,i=o.length,s=0;i>s;){if(r=t[n[s]._tableMember],(e=l[o[s++]._tableMember])>r)return-1;if(r>e)return 1}return 0}var t,r,o,a=this,n=a._relations,i=a.Report.DetailGrid.Recordset,l=a.report.DetailGrid.Recordset.curRecord,s=n.length-1,u=0;for(i._bakTable=i._dataTable,i._dataTable=[];s>=u;)if(r=Math.floor((u+s)/2),t=n[r][0],0>(o=e()))u=r+1;else{if(!(o>0)){i._dataTable=n[r],i._relTblIndex=r;break}s=r-1}return!0},attachRelationTable2:function(e){this.Report.DetailGrid.Recordset._dataTable=this._relations[e]},get AsSubReport(){return this}},Z(He,we);var Ge=function(e){var t=this;xe.call(t,e),t.Visible=!0,t.FixedWidth=!1,t.Width=t.report.cm2Size(3)};Ge.prototype={prepare:function(){self.pxWidth=this.report.size2Pixel(self.Width)},get FreeGrid(){return this.owner}},Z(Ge,xe);var _e=function(e){var t=this;xe.call(t,e),t.Visible=!0,t.Height=t.report.cm2Size(.58)};_e.prototype={prepare:function(){self.pxHeight=this.report.size2Pixel(self.Height)},get FreeGrid(){return this.owner}},Z(_e,xe);var Oe=function(e){var t=this;we.call(t,e),t.ColumnCount=5,t.RowCount=5,t.TitleRows=1,t.ShowColLine=!0,t.ShowRowLine=!0,t.ColLinePen=new m,t.RowLinePen=new m,t.columns=[],t.rows=[],t.cells=[]};Oe.prototype={ControlType:13,attachData:function(){var e,t,r;for(t=this.cells.length,e=0;t>e;e++)(r=this.cells[e])&&r.forEach((function(e){e.attachData(),e.prepare()}))},prepareChildren:function(){var e,t=this,r=t.columns,o=t.rows,a=t.cells;for(e=r.length=t.ColumnCount;e--;)r[e]||(r[e]=new Ge(t));for(e=a.length=o.length=t.RowCount;e--;)o[e]||(o[e]=new _e(t)),a[e]||(a[e]=[],a[e].length=t.ColumnCount)},prepare:function(){var e=this,t=new y;e.columns.length===e.ColumnCount&&e.rows.length===e.RowCount&&e.cells.length===e.RowCount||e.prepareChildren(),we.prototype.prepare.call(e),t.addCellBorder(e),e.blankCellStyle=e.report.viewer.addCustomStyle(t)},assign:function(e){var t=this;we.prototype.assign.call(t,e),e.columns.forEach((function(e,r){var o=new Ge(t);o.assign(e),o.pxWidth=e.pxWidth,t.columns[r]=o})),e.rows.forEach((function(e,r){var o=new _e(t);o.assign(e),o.pxHeight=e.pxHeight,t.rows[r]=o})),e.cells.forEach((function(e,r){e.forEach((function(e,o){var a=new Se(t,r,o);a.assign(e),t.cells[r]||(t.cells[r]=[]),t.cells[r][o]=a}))})),t.Height=e.Height},afterLoad:function(e){var t,r,o,a,n,i=this,l=i.report,s=i.Border,u=i.columns=[],c=i.rows=[],d=i.cells=[];if(we.prototype.afterLoad.call(i,e),i.prepareChildren(),e.FreeGridColumn)for(a=e.FreeGridColumn.length,o=0;a>o;o++)u[(r=e.FreeGridColumn[o]).index-1].loadFromJSON(r);if(e.FreeGridRow)for(a=e.FreeGridRow.length,o=0;a>o;o++)c[(r=e.FreeGridRow[o]).index-1].loadFromJSON(r);if(e.FreeGridCell)for(a=e.FreeGridCell.length,o=0;a>o;o++)--(r=e.FreeGridCell[o]).row,--r.col,(t=d[r.row][r.col]=new Se(i,r.row,r.col)).loadFromJSON(r);for(a=u.length,n=0,o=0;a>o;o++)(t=u[o]).pxWidth=l.size2Pixel(t.Width),n+=t.Width;for(i.Width=n+l.pixel2Size(s.getLeftWidth()+s.getRightWidth()),a=c.length,n=0,o=0;a>o;o++)(t=c[o]).pxHeight=l.size2Pixel(t.Height),n+=t.Height;i.Height=n+l.pixel2Size(s.getTopWidth()+s.getBottomWidth())},generateNormal:function(e){var t,r,o,a,n=this,i=n.report.viewer,l=new F("table",e),s=new F("colgroup",l),u=[];for(n.Font.font&&l.addClass(i.selectFont2(n.Font.font)),l.styles.addBorder(n.Border),l.addStyle("border-collapse","collapse"),l.addStyle("width","100%"),n.toFillBack()&&l.addBackColorStyle(n.BackColor),a=n.ColumnCount,r=0,o=0;a>o;o++)r+=n.columns[o].pxWidth;for(o=0;a>o;o++)(t=new F("col",s)).skipend=1,t.addStyle("width",L(100*n.columns[o].pxWidth/r));for(o=0;o<n.RowCount;o++)(r=[]).length=n.ColumnCount,u.push(r);n.cells.forEach((function(e,t){e.forEach((function(e){(e.ColSpan>1||e.RowSpan>1)&&function(){for(var t,r=e.row,o=r+e.RowSpan,a=e.col+e.ColSpan;o>r;r++)for(t=e.col;a>t;t++)u[r][t]=1}(),u[e.row][e.col]=e}))})),u.forEach((function(e,t){var r,o=n.ColumnCount,a=0,s=new F("tr",l);s.addStyle("height",I(n.rows[t].pxHeight));do{for(;o>a&&!e[a];)(r=new F("td",s)).addClass(i._getCSSName(n.blankCellStyle)),a++;for(;o>a&&1===e[a];)a++;o>a&&(r=e[a])&&(r.generate(s),a=r.col+r.ColSpan)}while(o>a)}))},get AsFreeGrid(){return this},ColumnAt:function(e){var t=this,r=t.columns;return r.length!==t.ColumnCount&&t.prepareChildren(),r[e-1]},RowAt:function(e){var t=this,r=t.rows;return r.length!==t.RowCount&&t.prepareChildren(),r[e-1]},CellAt:function(t,r){var o,a=this,n=a.cells,i=e;return n.length!==a.RowCount&&a.prepareChildren(),t>0&&t<=a.RowCount&&r>0&&r<=a.ColumnCount&&((i=(o=n[--t])[--r])||(i=o[r]=new Se(a,t,r))),i},CellByDataName:function(t){for(var r,o,a,n=this.cells,i=n.length;i--;)for(o=(r=n[i]).length;o--;)if((a=r[o])&&a.DataName===t)return a;return e}},Z(Oe,we);var We=function(e){var t=this;xe.call(t,e),t.Visible=!0,t.CanGrow=!1,t.CanShrink=!1,t.Height=e.report.cm2Size(t.defaultHeight()),t.BackColor=e.BackColor,t.FormatScript="",t.Font=new x(t.getParentFont())};We.prototype={afterLoad:function(e){var t=this,r=t.report;e[t.getJsonMember("BackColor")]||(t.BackColor=t.getParentBackColor()),P(t,"BackColor",r.viewer.alpha.background),t.Font.loadFromJSON(e.Font,r.isWR)},prepare:function(){var e=this,t=e.Controls;e.registerEventClass(),e.pxHeight=e.report.size2Pixel(e.Height),e._singleHidableSR=e.getSingleHidableSR(),e._singleSR=t&&1===t.Count&&9===t.Item(1).ControlType},unprepare:function(){this.resetEventClass(),delete this.defaultStyle},generate:function(e){var t=this;t.report.fireSectionFormat(t),t.pxHeight=t.report.size2Pixel(t.Height),t.isToGenerate()&&(t._singleSR&&!t.Group?t.Controls.Item(1).generateContent(e):t.doGenerate(e))},defaultHeight:function(){return 3},getParentBackColor:function(e){return this.owner.BackColor},getParentFont:function(){return this.owner.Font},getSingleHidableSR:function(){return e},isControlPositionClass:function(){return 0},isToGenerate:function(){var e,t,r,o=this,a=o.Visible&&o.Height>0;return a&&o._singleHidableSR&&(t=o._singleHidableSR,(r=t._relations)&&t.attachRelationTable(),e=!t.Report.DetailGrid||t.Report.DetailGrid.Recordset.RecordCount,r&&t.detachRelationTable(),a=e),a}},Z(We,xe);var Ue=function(e){var t=this;We.call(t,e),t.Controls=new ce(t)};Ue.prototype={children:["Controls"],afterLoad:function(e){We.prototype.afterLoad.call(this,e),this.Controls.loadFromJSON(e.Control)},attachData:function(){this.Controls.attachData()},prepare:function(){var e=this,t=e.Controls,r=e.report,o=r.viewer;We.prototype.prepare.call(e),t.layout(),2!==o.options.controlPosition&&e.buildTableLayout(r.getReportWidth(),e.pxHeight),t.prepare(),e.tableRows&&(r.reportFitHeight&&se(e.tableRows),e.tableRows.forEach((function(e){e.defaultStyle=o.selectSectionItem(e)}))),e.defaultStyle=o.selectSectionItem(e)},unprepare:function(){We.prototype.unprepare.call(this),this.Controls.unprepare()},buildTableLayout:function(t,r){function o(t,r,o,a){var n,i,l,s=[];for(u.forEach((function(e){s.push({pos:e.pxRect[t],count:1},{pos:e.pxRect[r],count:1})})),s.sort((function(e,t){return e.pos-t.pos})),n=s.length,i=0;n>i&&s[i].pos<o;)s[i++]=e;if(i>0&&(s.unshift({pos:o,count:i}),++n),!isNaN(a)){for(i=n-1;i>=0&&s[i]&&s[i].pos>a;)s[i--]=e;(i=n-1-i)>=0&&s.push({pos:a,count:i})}return l={pos:-98765},s.forEach((function(t,r){t&&(l.pos===t.pos?(l.count++,s[r]=e):l=t)})),l={pos:-98765},s.forEach((function(t,r){t&&(t.pos-l.pos<8?l.count>t.count?(l.count+=t.count,s[r]=e):(t.count+=l.count,s[i]=e,l=t,i=r):(l=t,i=r))})),(n=(s=s.filter((function(e){return e}))).length)>1&&(s[0].pos<o+4&&(s[0].pos=o),s[0].pos!==o&&(s.unshift({pos:o,count:0}),n++),isNaN(a)||(n--,a-s[n].pos<4&&(s[n].pos=a),s[n].pos!==a&&s.push({pos:a,count:0}))),s}function a(e,t,r){var o=0,a=r.length;u.sort((function(t,r){return t.pxRect[e]-r.pxRect[e]})),u.forEach((function(n){for(var i=n.pxRect[e];a>o&&r[o].pos<i;)o++;(o>=a||o>0&&i-r[o-1].pos<r[o].pos-i)&&--o,n.cell[t]=o}))}var n,i,l,s,u,c,d,h,p=this,f=p.report.viewer,g=p.getTableColEdges,m=p.getMergedColumns?p.getMergedColumns():0,C=[],T=[];if(i=(u=p.Controls.items.filter((function(e){return e.cell={control:e},e.Visible}))).length,c=o("top","bottom",0,r),l=c.length-1,g?(d=p.getTableColEdges(),8>(s=d.length-1)&&((h=o("left","right",0,t)).length>2*s&&(d=h,g=e))):d=o("left","right",0,t),s=d.length-1,!g)for(p.tableCols=[],n=0;s>n;)p.tableCols.push(d[n+1].pos-d[n++].pos);for(a("top","beginRow",c),a("bottom","endRow",c),a("left","beginCol",d),a("right","endCol",d),u.forEach((function(e){var t=e.cell;t.endCol<=t.beginCol&&t.endCol<s&&t.endCol++,t.endRow<=t.beginRow&&t.endRow<l&&t.endRow++})),n=0;l>n;)T.push({section:p,pxHeight:c[n+1].pos-c[n++].pos,cells:[]});for((u=u.filter((function(e){var t=e.cell;return t.beginCol<t.endCol&&t.beginRow<t.endRow}))).sort((function(e,t){var r=e.cell.beginRow-t.cell.beginRow;return r||e.cell.beginCol-t.cell.beginCol})),n=0;l>n;n++)(h=[]).length=s,C.push(h);m&&m.forEach((function(e){var t=e.index;C.forEach((function(e){e[t]=1}))})),n=0,u.forEach((function(e){for(var t,r,o=e.cell,a=C[o.beginRow];o.beginCol<o.endCol&&a[o.beginCol];)o.beginCol++;for(;o.endCol>o.beginCol&&a[o.endCol-1];)o.endCol--;if(o.beginCol<o.endCol){for(t=o.beginRow;t<o.endRow;t++)for(r=o.beginCol;r<o.endCol;r++)C[t][r]=1;a[o.beginCol]=e,n++}})),1===f.options.controlPosition||m||i&&n/i>.8?(C.forEach((function(e,t){var r,o,a,n=T[t].cells;r=o=0;do{for(;s>o&&!e[o];)o++;for(o>r&&(n.push({beginCol:r,endCol:o}),r=o);s>o&&1===e[o];)o++;s>(r=o)&&(a=e[r])&&(a=a.cell,n.push(a),r=o=a.endCol)}while(s>o)})),T.forEach((function(e){var t=0,r=0;e.cells.forEach((function(e){e.control&&(t++,e.control.CanShrink&&r++)})),t&&r===t&&delete e.pxHeight})),p.tableRows=T):(delete p.tableCols,delete p.tableRows,p.Controls.items.forEach((function(e){delete e.cell})))},doGenerate:function(e){var t=this,r=t.report.viewer;e=new F(t.tableRows?"table":"div",e),t.addElementEventClass(e),e.addClass(r.selectSection(t)),t.tableRows?(e.addStyle("border-collapse","collapse"),t.generateTableRows(e)):(e.addStyle("position","relative"),t.Controls.generate(e))},generateTableRows:function(e,t){var r,o,a,n,i,l,s,u,c=this,d=c.owner,h=c.report,p=d.RunningDetailGrid,f=h.viewer,g=c.owner!==h||h.reportFitWidth,m=c.tableCols,C=0;m&&(m.forEach((function(e){C+=e})),d==c.report&&p&&(i=m.length-1,l=m[i],s=p.showingColumns,u=p.Border,s.length>0&&(a=s[s.length-1],n=u.getLeftWidth()+u.getRightWidth(),Math.abs(l-a.pxWidth-n)<.5&&(m[i]-=n))),r=new F("colgroup",e),e.addStyle("width",g?"100%":I(C)),m.forEach((function(e){(o=new F("col",r)).skipend=1,o.addStyle("width",L(100*e/C))}))),c.tableRows.forEach((function(r,o){function a(e){e.ContentCell.generate(n),e.mergingElement=n.children[n.children.length-1],e.ContentCell.getUsingFont()!==c.getUsingFont()&&e.mergingElement.addClass(f.selectFont2(e.ContentCell.getUsingFont())),e.ContentCell.BackColor!==c.BackColor&&e.mergingElement.addBackColorStyle(e.ContentCell.BackColor),e.mergedHeader.todoMerge=0}var n;(n=new F("tr",e)).addClass(f.selectSection(r)),r.cells.forEach((function(e){var r,i,l,s=e.control;if(!o&&t)for(;(l=t[0])&&l.index<=e.beginCol;)a(l),t.shift();r=new F("td",n),(i=e.endCol-e.beginCol)>1&&r.addAttribute("colspan",i+""),e.endRow&&((i=e.endRow-e.beginRow)>1&&r.addAttribute("rowspan",i+""),s.Visible&&(13!==s.ControlType?(r.addClass(f.selectControl(s)),s.Font.font&&r.addClass(f.selectFont(s.Font.font,s.defaultFontStyle))):r.addStyle("padding","0px"),s.generateInCell(r)))})),!o&&t&&t.forEach((function(e){a(e)}))}))},getRect:function(){return new g(0,0,this.report.getReportWidth(),this.pxHeight)},getSingleHidableSR:function(){var t=this.Controls.items,r=t[0];return 1===t.length&&9===r.ControlType&&r.HideOnRecordsetEmpty?r:e},_runningNo:function(){return 0}},Z(Ue,We);var ze=function(e){Ue.call(this,e),this.Name=""};ze.prototype={},Z(ze,Ue);var Je=function(e){Ue.call(this,e),this.Name=""};Je.prototype={},Z(Je,Ue);var Ye=function(e){var t=this;We.call(t,e),t.Height=t.report.cm2Size(.58)};Ye.prototype={defaultHeight:function(){return.58}},Z(Ye,We);var je=function(e){var t=this;Ye.call(t,e),t.ContentCells=new pe(t),t.AlternatingBackColor=t.BackColor};je.prototype={afterLoad:function(e){var t=this;Ye.prototype.afterLoad.call(t,e),e[t.getJsonMember("AlternatingBackColor")]?P(t,"AlternatingBackColor",t.report.viewer.alpha.background):t.AlternatingBackColor=t.BackColor,t.ContentCells.loadFromJSON(e.ColumnContentCell)},prepare:function(){var e,t=this,r=t.report.viewer;Ye.prototype.prepare.call(t),t.defaultStyle=r.selectSectionItem(t),t.AlternatingBackColor!==t.BackColor&&(e=t.BackColor,t.BackColor=t.AlternatingBackColor,t.altSectionStyle=r.selectSectionItem(t),t.BackColor=e),t.ContentCells.prepare()},unprepare:function(){Ye.prototype.unprepare.call(this),this.ContentCells.unprepare()},generate:function(e,t){this.owner.Recordset.MoveTo(t),Ye.prototype.generate.call(this,e)},doGenerate:function(e){var t=this,r=t.report.viewer,o=t.owner,n=o.showingColumns,i=o.Recordset.RecordNo;e=new F("tr",e),t.addElementEventClass(e),e.addAttribute(a.ATTR_CONTENT_RECNO,i+""),t.altSectionStyle&&i%2?(t._BackColor=t.BackColor,t._defaultStyle=t.defaultStyle,t.BackColor=t.AlternatingBackColor,t.defaultStyle=t.altSectionStyle,e.addClass(r.selectSection(t)),t.BackColor=t._BackColor,t.defaultStyle=t._defaultStyle):e.addClass(r.selectSection(t)),o.hasMergedColumn?n.forEach((function(t){var r,o,a,n=t.ContentCell,i=t.mergedHeader;if(i){if(i.todoMerge){if(i.SameAsColumn)n.generate(e);else for(o=(r=i.Controls).Count;o>0;)if((a=r.Item(o--)).oAlignColumn===t){n.generateMerge(e,a);break}e.children&&(t.mergingElement=e.children[e.children.length-1])}}else n.generate(e)})):n.forEach((function(t){t.ContentCell.generate(e)})),o.hasMergedColumn&&o.Groups.forEach((function(e){e.Header.todoMerge&&(e.Header.todoMerge=0)}))},getSingleHidableSR:function(){for(var t,r,o=this.ContentCells.items,a=o.length,n=0,i=0,l=0;a>n&&(t=o[n++])._freeCell;)if((l=t.Controls.Count)>0)if(1===(i+=l))r=t.Controls.Item(1);else if(i>1)break;return 1===i&&9===r.ControlType&&r.HideOnRecordsetEmpty?r:e},SetCellsBackColor:function(e){this.ContentCells.forEach((function(t){t.BackColor=e}))},SetCellsForeColor:function(e){this.ContentCells.forEach((function(t){t.setForeColor(e)}))}},Z(je,Ye);var Xe=function(e){var t=this;Ye.call(t,e),t.TitleCells=new he(t)};Xe.prototype={afterLoad:function(e){Ye.prototype.afterLoad.call(this,e),this.TitleCells.loadFromJSON(e.ColumnTitleCell)},prepare:function(){var e=this,t=e.owner,r=0;Ye.prototype.prepare.call(e),t.columnsTotalWidth=0,t.showingColumns=[],e.layerCount=function e(o){var a=1;return o.showingItems=[],o.forEach((function(n){var i,l,s;n.layer=r,n.GroupTitle?n.Visible&&(r++,i=e(n.SubTitles)+1,r--,(l=n.SubTitles.showingItems).length>0&&(o.showingItems.push(n),i>a&&(a=i),n.colspan=0,l.forEach((function(e){n.colspan+=e.colspan})))):(s=n.Column).Visible&&s.pxWidth>0&&(o.showingItems.push(n),n.colspan=1,s.pxLeft=t.columnsTotalWidth,s.index=t.showingColumns.length,t.columnsTotalWidth+=s.pxWidth,t.showingColumns.push(s))})),a}(e.TitleCells),e.pxHeight/=e.layerCount,e.TitleCells.prepare(),e.defaultStyle=e.report.viewer.selectSectionItem(e)},unprepare:function(){Ye.prototype.unprepare.call(this),this.TitleCells.unprepare()},doGenerate:function(e){function t(e){e.forEach((function(e){e.layer===o.generatingLayer&&e.generate(r),e.GroupTitle&&t(e.SubTitles.showingItems)}))}var r,o=this,a=o.report.viewer;for(o.pxHeight/=o.layerCount,o.generatingLayer=0;o.generatingLayer<o.layerCount;)r=new F("tr",e),o.addElementEventClass(r),r.addClass(a.selectSection(o)),t(o.TitleCells.showingItems),o.generatingLayer++},FindColumnTitlesOfTitleCell:function(t){return function t(r,o){var a,n,i,l=r.items.length;for(a=0;l>a;a++){if((n=r.items[a])===o)return r;if(n.GroupTitle&&(i=t(n.SubTitles,o)))return i}return e}(this.TitleCells,t)},SetCellsBackColor:function(e){!function t(r){r.forEach((function(r){r.BackColor=e,r.GroupTitle&&t(r.SubTitles)}))}(this.TitleCells)},SetCellsForeColor:function(e){!function t(r){r.forEach((function(r){r.setForeColor(e),r.GroupTitle&&t(r.SubTitles)}))}(this.TitleCells)}},Z(Xe,Ye);var Ze=function(e){var t=this;Ue.call(t,e),t.Height=t.report.cm2Size(1.2)};Ze.prototype={generate:function(e,t){var r=this,o=r.owner;o.recordset.MoveTo(t),o.owner.Recordset.MoveTo((r===o.Header?o.beginNoField:o.endNoField).Value),Ue.prototype.generate.call(r,e)},doGenerate:function(t){function r(e){var t=n.owner,r=n===t.Header?a.ATTR_GROUPH_INDEX:a.ATTR_GROUPF_INDEX;e.addAttribute(a.ATTR_GROUP_RECNO,t.recordset.recordNo),e.addAttribute(r,t.index)}var o,n=this,i=n.report.viewer,l=n.owner.owner,s=l.showingColumns,u=s.length;l.hasMergedColumn&&(o=[],s.forEach((function(e){e.mergedHeader&&e.mergedHeader.todoMerge&&(n.owner.Footer!==n||n.owner===l.Groups.Item(l.Groups.Count)&&e.mergedHeader!==n.owner.Header)&&o.push(e)})),o.length||(o=e)),n.tableRows&&!n.tableCols?(n.generateTableRows(t,o),t.children.slice(-n.tableRows.length).forEach((function(e){n.addElementEventClass(e),r(e)}))):((t=new F("tr",t)).addClass(i.selectSection(n)),n.addElementEventClass(t),r(t),t=new F("td",t),u>1&&t.addAttribute("colspan",u),n.tableCols?((t=new F("table",t)).addClass(i.selectSection(n)),t.addStyle("border-collapse","collapse"),n.generateTableRows(t)):(t.addStyle("position","relative"),n.Controls.generate(t)))},getTableColEdges:function(){var e,t=this.owner.owner.showingColumns;return(e=t.map((function(e){return{pos:e.pxLeft,count:1}}))).push({pos:t[t.length-1].pxRight,count:1}),e},getMergedColumns:function(){var e,t,r=this;return e=r.owner.index,0===(t=r.owner.owner.showingColumns.filter((function(t){var o,a,n=t.mergedHeader;return n&&((a=(o=n.owner).index)<e||a===e&&r===o.Footer&&o.Header.IncludeFooter)}))).length&&(t=0),t},getParentBackColor:function(e){return this.owner.owner.BackColor},getParentFont:function(){return this.owner.owner.Font},_runningNo:function(){return this.owner.recordset.RecordNo+1}},Z(Ze,Ue);var qe=function(e){var t=this;Ze.call(t,e),t.OccupiedColumns="",t.OccupyColumn=!1,t.SameAsColumn=!0,t.IncludeFooter=!1,t.VAlign=1};qe.prototype={afterLoad:function(e){Ze.prototype.afterLoad.call(this,e),D(this,"VAlign",r.OCGroupHeaderVAlign)},prepare:function(){var e,t=this;t.OccupiedColumns&&((e=(e=t.owner.owner.Columns.decodeItems(t.OccupiedColumns)).filter((function(e){return e.Visible}))).length>0&&(t.groupMergedColumns=e,e.forEach((function(e){e.mergedHeader=t,t.owner.owner.hasMergedColumn=1})))),(!t.groupMergedColumns||!t.SameAsColumn)&&Ze.prototype.prepare.call(t)},unprepare:function(){},generate:function(e,t){var r=this;r.groupMergedColumns?(r.owner.recordset.MoveTo(t),r.curItemBegin=e.children?e.children.length:0,r.todoMerge=1):Ze.prototype.generate.call(r,e,t)},get Group(){return this.owner}},Z(qe,Ze);var Qe=function(e){Ze.call(this,e)};Qe.prototype={generate:function(e,t){var r,o=this,a=o.owner.Header,n=a.groupMergedColumns;Ze.prototype.generate.call(o,e,t),n&&e.children&&(r=e.children.length-a.curItemBegin,!a.IncludeFooter&&o.isToGenerate()&&r--,r>1&&n.forEach((function(e){e.mergingElement&&e.mergingElement.addAttribute("rowspan",r+"")})))},get Group(){return this.owner}},Z(Qe,Ze);var $e=function(t){var r=this;xe.call(r,t),r.FieldType=1,r._name="",r._dbFieldName="",r._tableMember=e,r.Format="",r.Length=0,r.RTrimBlankChars=!1,r.GetDisplayTextScript=""};$e.prototype={afterLoad:function(e){var t,o=this;(t=e[o.getJsonMember("Type")])&&(o.FieldType=t),(t=e[o.getJsonMember("Name")])&&(o.Name=t),(t=e[o.getJsonMember("DBFieldName")])&&(o.DBFieldName=t),D(o,"FieldType",r.FieldType)},prepare:function(){var e=this,t=e.FieldType,r=e.Format;6===t?e.formater=new c(r):5===t?e.formater=new u(r):2!==t&&3!==t&&4!==t||(e.formater=new d(r))},unprepare:function(){delete this.formater,delete this._fts},isNumeric:function(){var e=this.FieldType;return 2===e||3===e||4===e},valUeq:function(t){var r=this.Value,o=t.Value;return o>r||r>o||(r===e||o===e)&&r!==o},get Value(){var t=this.owner.curRecord;return t?t[this._tableMember]:e},set Value(t){var r=this,o=r.owner.curRecord;if(o){if(t!==e&&null!==t)switch(r.FieldType){case 2:case 3:case 4:t=+t;break;case 5:t=G(t);break;case 6:t=M(t);break;default:t+=""}else t=e;o[r._tableMember]=t}},get AsBoolean(){return G(this.Value)},set AsBoolean(e){this.Value=e},get AsCurrency(){return+this.Value},set AsCurrency(e){this.Value=e},get AsDateTime(){return E(this.Value)},set AsDateTime(e){this.Value=e},get AsFloat(){var e,t=this;if(t.IsNull)e=0;else if(6===t.FieldType){var r=new f;r.value=t.Value,e=r.AsFloat}else e=+t.Value;return isNaN(e)?0:e},set AsFloat(e){var t;6===this.FieldType&&((t=new f).AsFloat=e,e=t.value),this.Value=e},get AsInteger(){return Math.floor(this.AsFloat)},set AsInteger(e){this.AsFloat=Math.floor(+e)},get AsString(){return this.IsNull?"":this.Value+""},set AsString(e){this.Value=e},get DisplayText(){var e=this,t=e.FieldType,r=e.Value;return e.displayTextAssigned=0,e.doingGetDisplayText||(e.doingGetDisplayText=1,e.report.fireFieldGetDisplayText(e),e.doingGetDisplayText=0),e.displayTextAssigned?e.assignedDisplayText:e.IsNull?"":1===t||7===t?r+"":e.formater.format(r)},set DisplayText(e){this.assignedDisplayText=e+"",this.displayTextAssigned=1},get IsNull(){var t=this.Value;return t===e||null===t},get DataSize(){return 0},get DataBuffer(){return e},get Name(){return this._name},set Name(e){var t=this;t._tableMember&&t._tableMember!==t._name||(t._tableMember=e),t._name=e},get DBFieldName(){return this._name},set DBFieldName(e){this._dbFieldName=e,e&&(this._tableMember=e)},get RunningDBField(){return this._dbFieldName||this._name},Clear:function(){this.Value=e}},Z($e,xe);var Ke=function(e){var t=this;xe.call(t,e),t.QuerySQL="",t.Fields=new fe(t),t.SortAsc=!0,t.SortCaseSensitive=!1,t.SortFields="",t.XmlTableName="",t.FetchRecordScript="",t.BeforePostRecordScript="",t.ProcessRecordScript="",t._dataTable=[],t.recordNo=0};Ke.prototype={children:["Fields"],afterLoad:function(e){this.Fields.loadFromJSON(e.Field)},attachDataTable:function(e){this._dataTable=e,this.MoveTo(0)},appendRefRecord:function(e){this._dataTable.push(e)},prepareTableData:function(){function t(t,r){if(t.hasOwnProperty(r))return r;for(var o in r=r.toUpperCase(),t)if(r===o.toUpperCase())return o;return e}for(var r,o,a,n,i,l=this,s=l._dataTable,u=l.Fields.items,c=s.length,d=u.length;c--;)for(r=s[c],d=u.length;d--;){if(i=(o=u[d])._fts,n=o._tableMember,i===e&&(n=t(r,n))){switch(o.FieldType){case 1:i="string"!=typeof r[n];break;case 2:case 3:case 4:i="number"!=typeof r[n];break;case 5:i="boolean"!=typeof r[n];break;case 6:i=!Date.prototype.isPrototypeOf(r[n]);break;default:i=!1}o._fts=i,o._tableMember=n}if(n&&(null!==(a=r[n])&&""!==a||(a=e,r[n]=a),i&&a!==e))switch(o.FieldType){case 1:r[n]=a+"";break;case 2:case 3:case 4:r[n]=+a;break;case 5:r[n]=G(a);break;case 6:r[n]=V(a)}}l.SortFields&&l.Resort(l.SortFields,l.SortAsc,l.SortCaseSensitive)},prepare:function(){var e=this,t=e._dataTable.length,r=0;for(e.Fields.prepare(),e.prepareTableData();t>r;)e.MoveTo(r++),e.beforePost();e.MoveTo(0)},unprepare:function(){this.Fields.unprepare(),this._dataTable=[]},beforePost:function(){var e=this,t=e.report,r=e.BeforePostRecordScript;r&&t.executeEventScript(r,"BeforePostRecordScript",e),e.isDetailGridRecordset()&&t.fireBeforePostRecord()},decodeFields:function(e){return this.Fields.decodeItems(e)},isDetailGridRecordset:function(){return this.owner===this.report.DetailGrid},isAppendingRecord:function(){return 1===this.editStatus},keepValue:function(){this.keepedRecord=this.curRecord},fieldsKeepedValueChanged:function(t){var r=this;return t.some((function(t){var o=t._tableMember,a=r.keepedRecord[o],n=r.curRecord[o];return n>a||a>n||(a===e||n===e)&&a!==n}))},sortRecords:function(t,r){for(var o=this,a=o._dataTable,n=a.length,i=0,l=[];n>i;)l.push(i++);return t.length>0&&(t.forEach((function(e){e.fieldName=e.field._tableMember})),l.sort((function(r,o){var n;return t.some((function(t){var i=a[r][t.fieldName],l=a[o][t.fieldName];return i!==e&&l!==e?1===t.field.FieldType?(t.case||(i=i.toUpperCase(),l=l.toUpperCase()),n=i.localeCompare(l)):n=l>i?-1:i>l?1:0:n=i===e&&l===e?0:i===e?-1:1,t.asc||(n=-n),n})),n}))),r?l:(i=[],l.forEach((function(e){i.push(a[e])})),o._dataTable=i,void o.MoveTo(0))},get RecordCount(){return this._dataTable?this._dataTable.length:0},get RecordNo(){return this.recordNo},FieldByName:function(e){return this.Fields.itemByName(e)},FieldByDBName:function(t){var r,o=this.Fields.items,a=o.length;for(t=t.toUpperCase(),r=0;a>r;r++)if(o[r].RunningDBField.toUpperCase()===t)return o[r];return e},Append:function(){var e=this;e.editStatus=1,e.recordNo=e._dataTable.length,e.curRecord={}},Edit:function(){var t,r,o=this,a=o.Fields.items,n=a.length,i=o.curRecord,l={};if(o.recordNo>=0&&o.recordNo<o._dataTable.length){for(o.editStatus=2;n--;)i[r=(t=a[n])._tableMember]!==e&&(6===t.FieldType?l[r]=M(i[r]):l[r]=i[r]);o.curRecord=l}},Cancel:function(){var e=this;e.editStatus&&(1===e.editStatus?e.Last():e.curRecord=e._dataTable[e.recordNo],e.editStatus=0)},Post:function(){var e=this,t=e._dataTable;e.editStatus&&(e.beforePost(),1===e.editStatus?t.push(e.curRecord):t[e.recordNo]=e.curRecord,e.editStatus=0)},First:function(){this.MoveTo(0)},Next:function(){this.MoveTo(this.recordNo+1)},Prior:function(){this.MoveTo(this.recordNo-1)},Last:function(){this.MoveTo(this._dataTable.length-1)},MoveBy:function(e){this.MoveTo(this.recordNo+e)},Bof:function(){return this.recordNo<0||!this._dataTable.length},Eof:function(){return this.recordNo>=this._dataTable.length},MoveTo:function(e){var t=this,r=t._dataTable;t.recordNo=e,t.curRecord=r[Math.min(Math.max(0,e),r.length-1)]},Empty:function(){this.attachDataTable([])},AddField:function(e,t){var r=this.Fields.Add();return r.Name=e,r.FieldType=t,r},RemoveAllFields:function(){this.Fields.RemoveAll()},Resort:function(e,t,r){var o,a,n=this,i=[];e&&(a=[],e.split(";").forEach((function(e){function o(e){"ASC"===(e=e.trim().toUpperCase())?l.asc=!0:"DESC"===e?l.asc=!1:"CASE"===e?l.case=!0:"CASEIN"===e&&(l.case=!1)}var i,l={};(i=(e=e.trim()).split(" "))[0]=i[0].trim(),l.field=n.Fields.Item(i[0]),l.field&&(l.asc=t,l.case=r,i.length>1&&o(i[1]),i.length>2&&o(i[2]),a.push(l))})),(o=a).length>0&&(n.report.fireBeforeSort(e,n),n.isDetailGridRecordset()&&(n.owner.Groups.forEach((function(e){n.decodeFields(e.ByFields).forEach((function(e){i.indexOf(e)<0&&i.push(e)}))})),o.forEach((function(e){var t=i.indexOf(e.field);0>t?i.push(e):i[t]=e})),i.forEach((function(e,o){e.field||(i[o]={field:e,asc:t,case:r})})),(o=i).length)),n.sortRecords(o,0))},FilterByStep:function(e,t){var r=this,o=r.RecordCount(),a=0;if(r._dataTable&&!r.isAppendingRecord()&&e>0){for(r.FilterBegin();o>a;)r.MoveTo(a),r.FilterSelect(),a+=e;t&&a-e+1!=o&&(r.Last(),r.FilterSelect()),r.FilterEnd()}},FilterByCount:function(e){var t,r,o=this,a=o.RecordCount(),n=0;if(o._dataTable&&!o.isAppendingRecord()&&e>1&a>e){for(t=(a-1)/(e-1),o.FilterBegin();a>n;)r=Math.round(n),o.MoveTo(r),o.FilterSelect(),n+=t;o.FilterEnd()}},FilterBegin:function(){this._dtf=[]},FilterEnd:function(){var e=this,t=e._dataTable;e._dtf&&(e._dataTable=e._dtf,e._dtf=t)},FilterSelect:function(){var e=this;e._dtf&&!e.isAppendingRecord()&&!e.Bof()&&!e.Eof()&&e._dtf.push(e.curRecord)},FilterReset:function(){var e=this;e._dtf&&(e._dataTable=e._dtf,delete e._dtf)}},Z(Ke,xe);var et=function(e){var t=this;xe.call(t,e),t.Name="",t.Visible=!0,t.FixedWidth=!1,t.Width=t.report.cm2Size(3)};et.prototype={prepare:function(){var e=this;e.pxWidth=e.report.size2Pixel(e.Width)},get pxRight(){return this.pxLeft+this.pxWidth}},Z(et,xe);var tt=function(e){var t=this;xe.call(t,e),t.Header=new qe(t),t.Footer=new Qe(t),t.Name="",t.ByFields="",t.SortSummaryBox="",t.SortAsc=!1,t.GroupBeginScript="",t.GroupEndScript=""};tt.prototype={children:["Header","Footer"],afterLoad:function(e){this.Header.loadFromJSON(e.GroupHeader),this.Footer.loadFromJSON(e.GroupFooter)},prepare:function(e){function t(e){e.forEach((function(e){!function e(o){function a(e){var t,o,a,i=n.length+"",l="";n.push(e),e.SummaryFun?(e.value=0,28===e.SummaryFun&&((t=r.owner.Groups.indexOf(r))>0&&((o=new h).SummaryFun=-1,o.init(),r.owner.Groups.items[t-1].summaryItems.push(o))),e.displayField?(a=e.displayField.FieldType,l=e.displayField.Format):(a=18===e.SummaryFun||19===e.SummaryFun?1:3,e.paramExp&&(1===(o=e.paramExp.varItems).length&&((o=o[0].varField.object).Format&&(l=o.Format))))):e.oParameter?(a=e.oParameter.DataType,l=e.oParameter.Format):a=3,e.valueField=r.recordset.AddField(i,a),e.valueField.Format=l}var n=r.summaryItems,i=o.ControlType;5===i?a(o):8===i?Pe.prototype.getGroupVars.call(o).forEach((function(e){a(e)})):1===i?o.oParameter&&a(o):13===i&&o.cells.forEach((function(r){r.forEach((function(r){r.FreeCell?t(r.Controls):e(r)}))}))}(e)}))}var r=this;r.index=e,r.Header.prepare(),r.Footer.prepare(),r.oByFields=r.owner.Recordset.decodeFields(r.ByFields),r.SortSummaryBox&&(r.sortSummaryBoxObj=r.Footer.Controls.itemByName(r.SortSummaryBox),r.sortSummaryBoxObj||(r.sortSummaryBoxObj=r.Header.Controls.itemByName(r.SortSummaryBox)),r.sortSummaryBoxObj&&5!==r.sortSummaryBoxObj.ControlType&&delete r.sortSummaryBoxObj),r.recordset=new Ke(r),r.beginNoField=r.recordset.AddField("b",2),r.endNoField=r.recordset.AddField("e",2),r.groupItemNo=0,r.summaryItems=[],t(r.Header.Controls),t(r.Footer.Controls),r.recordset.prepare()},unprepare:function(){},inphaseByDetail:function(e){var t=this,r=t.recordset;if(!r.isAppendingRecord()&&r.RecordCount){for(;t.beginNoField.Value>e&&!r.Bof();)r.Prior();for(;t.endNoField.Value<e&&!r.Eof();)r.Next()}},get Parent(){return this.owner}},Z(tt,xe);var rt=function(e){var t=this;xe.call(t,e),t.FixCols=0,t.BackColor=e.BackColor,t.ShowColLine=!0,t.ShowRowLine=!0,t.Font=new x(e.Font),t.Border=new C(15),t.ColLinePen=new m,t.RowLinePen=new m,t.Recordset=new Ke(t),t.ColumnContent=new je(t),t.ColumnTitle=new Xe(t),t.Columns=new de(t),t.Groups=new ge(t)};rt.prototype={children:["Border","ColLinePen","RowLinePen","Recordset","Groups"],afterLoad:function(e){var t=this,r=t.report.viewer.alpha,o=t.report.isWR;P(t,"BackColor",r.background),t.Border.loadFromJSON(e.Border,r.border,o),t.ColLinePen.loadFromJSON(e.ColLine,r.stroke,o),t.RowLinePen.loadFromJSON(e.RowLine,r.stroke,o),t.Font.loadFromJSON(e.Font,o),t.Recordset.loadFromJSON(e.Recordset),t.Groups.loadFromJSON(e.Group),t.Columns.loadFromJSON(e.Column),t.ColumnContent.loadFromJSON(e.ColumnContent),t.ColumnTitle.loadFromJSON(e.ColumnTitle),t.IsCrossTab=e[t.getJsonMember("IsCrossTab")],t.IsCrossTab&&t.CrossTab.loadFromJSON(e.CrossTab)},assign:function(e){var t=this;xe.prototype.assign.call(t,e),t.ColumnContent.assign(e.ColumnContent),t.ColumnTitle.assign(e.ColumnTitle),function e(r,o){o.forEach((function(o){var a;o.GroupTitle?((a=r.AddGroup("","")).assign(o),e(a.SubTitles,o.SubTitles)):((a=t.Columns.addTo(r)).assign(o.Column),a.TitleCell.assign(o),a.ContentCell.assign(o.Column.ContentCell))}))}(t.ColumnTitle.TitleCells,e.ColumnTitle.TitleCells),t.IsCrossTab=e.IsCrossTab,t.IsCrossTab&&t.CrossTab.assign(e.CrossTab)},attachData:function(){var e=this;e.Recordset.prepare(),e.ColumnContent.ContentCells.forEach((function(e){e.attachData()})),function e(t){t.forEach((function(t){t.attachData(),t.GroupTitle&&e(t.SubTitles)}))}(e.ColumnTitle.TitleCells),e.Groups.forEach((function(e){e.Header.Controls.attachData(),e.Footer.Controls.attachData()}))},buildColumnsOrder:function(){var e=[];(function t(r){r.forEach((function(r){r.GroupTitle?t(r.SubTitles):(r.Column.orderNo=e.length,e.push(r.Column))}))})(this.ColumnTitle.TitleCells),this.Columns.items=e},beginGroupItem:function(e){var t=this;t.rows.push({header:e.Header,recordNo:e.groupItemNo}),e.recordset.Append(),e.beginNoField.Value=t.Recordset.recordNo,e.groupRecordCount=0,e.summaryItems.forEach((function(e){e.SummaryFun&&e.beginSummaryValue()})),t.report.fireGroupBegin(e)},endGroupItem:function(t){var r,o,a=this,n=a.report,i=t.summaryItems,l=i.length;for(a.rows.push({footer:t.Footer,recordNo:t.groupItemNo++}),n.fireGroupEnd(t),i.forEach((function(e){e.SummaryFun&&e.endSummaryValue()}));l-- >0;)(o=(r=i[l]).SummaryFun)?-1!==o&&r.value!==e&&(r.valueField.AsFloat=r.value):r.MathFun?r.valueField.Value=r.getAsFloat():r.valueField.Value=r.oParameter.Value;n.DetailGrid.CrossTab&&n.DetailGrid.CrossTab.GroupEndProcess(t),t.endNoField.Value=Math.min(a.Recordset.recordNo,a.Recordset.RecordCount-1),t.recordset.Post()},prepare:function(){function e(r){r.forEach((function(r){!function r(o){var a=t.globalSummaryItems,n=o.ControlType;5===n?a.push(o):8===n?Pe.prototype.getGroupVars.call(o).forEach((function(e){e.SummaryFun&&a.push(e)})):13===n&&o.cells.forEach((function(t){t.forEach((function(t){t.FreeCell?e(t.Controls):r(t)}))}))}(r)}))}var t=this,r=t.report;t.CrossTab?(t.buildColumnsOrder(),t.CrossTab.prepare()):(t.Columns.prepare(),t.ColumnContent.prepare(),t.ColumnTitle.prepare(),t.Groups.forEach((function(e,t){e.prepare(t)})),t.globalSummaryItems=[],r.ReportHeaders.items.concat(r.ReportFooters.items).forEach((function(t){e(t.Controls)})))},unprepare:function(){var e=this;e.CrossTab&&e.CrossTab.unprepare(),e.Recordset.unprepare(),e.ColumnContent.unprepare(),e.ColumnTitle.unprepare(),e.Groups.forEach((function(e,t){e.unprepare(t)}))},generate:function(e,t){var r,o,n,i=this,l=i.report,s=i.Recordset,u=i.Border,c=l.viewer,d=c._detailgrids,h="title"==t,p="content"==t,f=new F("table",e),g=new F("colgroup",f);f.addClass(a.CSS_DG),i.Font.font&&f.addClass(c.selectFont2(i.Font.font)),h&&((u=u.clone()).Styles&=-9),p&&((u=u.clone()).Styles&=-3),f.styles.addBorder(u),f.addStyle("border-collapse","collapse"),f.addStyle("width",(o=l.ownerReport,1===(n=l.detailgridResize)||2===n&&window.innerWidth&&i.width<window.innerWidth&&(!o||o.owner._singleSR)?"100%":I(i.width))),i.toFillBack()&&f.addBackColorStyle(i.BackColor),i.showingColumns.forEach((function(e){var t=new F("col",g);t.skipend=1,t.addStyle("width",L(100*e.pxWidth/i.columnsTotalWidth))})),p||i.ColumnTitle.generate(new F("thead",f)),h||(f.addAttribute("id",c._getDetailGridID(d.length)),d.push(i),s._relTblIndex>=0&&f.addAttribute("_grrelTblIndex",s._relTblIndex),r=new F("tbody",f),i.generatingRowNo=1,i.rows.forEach((function(e,t){var o;e.header?(o=e.header).generate(r,e.recordNo):e.footer?(o=e.footer).generate(r,e.recordNo):(o=i.ColumnContent).generate(r,e),o.Visible&&o.Height>0&&++i.generatingRowNo})))},buildRows:function(){var e,t,r,o=this,a=o.report,n=o.Recordset,i=o.Groups.items,l=i.length,s=0;for(o.rows=[],o.globalSummaryItems.forEach((function(e){e.beginSummaryValue()})),n.First(),n.keepValue(),i.forEach((function(e){o.beginGroupItem(e)}));!n.Eof();){for(e=0;l>e&&!n.fieldsKeepedValueChanged(i[e].oByFields);e++);if(l>e){for(n.Prior(),t=l-1;t>=e;t--)o.endGroupItem(i[t]);for(n.Next(),t=e;l>t;t++)o.beginGroupItem(i[t])}a.fireProcessRecord(n),i.forEach((function(e){var t;(t=e).summaryItems.forEach((function(e){e.SummaryFun&&e.summaryCurRecord()})),t.groupRecordCount++})),o.globalSummaryItems.forEach((function(e){e.summaryCurRecord()})),o.rows.push(n.recordNo),n.keepValue(),n.Next()}for(a.fireProcessEnd(),t=l-1;t>=0;t--)o.endGroupItem(i[t]);o.globalSummaryItems.forEach((function(e){e.endSummaryValue()})),i.forEach((function(e){e.sortSummaryBoxObj&&(function(e){function t(){var t,r=l.length,o=e.owner.rows,a=[];1>=r||(t=l[0].beginRowNo,l.forEach((function(t){e.recordset.MoveTo(t.groupItemNo),t.sortValue=e.sortSummaryBoxObj.valueField.AsFloat})),l.sort((function(t,r){return e.SortAsc?t.sortValue-r.sortValue:r.sortValue-t.sortValue})),l.forEach((function(e){a=a.concat(o.slice(e.beginRowNo,e.endRowNo))})),a.forEach((function(e){o[t++]=e})))}var r,o,a,n=e.owner.rows,i=n.length,l=[];for(r=0;i>r;){for(a={},(o=n[r]).footer&&o.footer.owner.index<e.index&&(t(),l=[],r++);i>r;)if((o=n[r++]).header&&o.header.owner.index===e.index){a.beginRowNo=r-1,a.groupItemNo=o.recordNo;break}for(;i>r;)if((o=n[r++]).footer&&o.footer.owner.index===e.index){a.endRowNo=r,l.push(a);break}}t()}(e),s=1)})),s&&(r=[],t=0,o.sortedTable=[],i.forEach((function(e){e.sortedTable=[],e.groupItemNo=0})),o.rows.forEach((function(e){var a;e.header?((a=e.header.owner).recordset.MoveTo(e.recordNo),a.recordset.Edit(),a.beginNoField.Value=t,e.recordNo=a.groupItemNo):e.footer?((a=e.footer.owner).endNoField.Value=t,a.recordset.Post(),a.sortedTable.push(a.recordset._dataTable[e.recordNo]),e.recordNo=a.groupItemNo++):(o.sortedTable.push(n._dataTable[e]),e=t++),r.push(e)})),o.rows=r,n.attachDataTable(o.sortedTable),delete o.sortedTable,i.forEach((function(e){e.recordset.attachDataTable(e.sortedTable),delete e.sortedTable})))},syncTRData:function(e){function t(t){var r=e.parentNode.parentNode;r.hasAttribute("_grrelTblIndex")&&i.report.ownerSR.attachRelationTable2(r.getAttribute("_grrelTblIndex")),i.Recordset.MoveTo(t)}var r,o,n,i=this,l=1,s={};return(o=e.getAttribute(a.ATTR_CONTENT_RECNO))?(t(o),s.content=i.ColumnContent):(o=e.getAttribute(a.ATTR_GROUP_RECNO))&&((n=e.getAttribute(a.ATTR_GROUPH_INDEX))||(n=e.getAttribute(a.ATTR_GROUPF_INDEX),l=0),(r=s.group=i.Groups.items[n]).recordset.MoveTo(o),t((l?r.beginNoField:r.endNoField).Value)),s},syncElementData:function(e,t){var r=function(e,t){var r,o=e.tagName.toUpperCase();if("TH"===o||"TABLE"===o)return 0;do{if(r&&"TH"===(o=(e=r.parentNode).tagName.toUpperCase()))return 0;for(;"TD"!==o;){if(!(e=e.parentNode))return 0;if("TH"===(o=e.tagName.toUpperCase()))return 0}if(r=e.parentNode.parentNode.parentNode,!t&&r.classList.contains(a.CSS_DG))break}while(t!==r);return e}(e,t);r&&this.syncTRData(r.parentNode)},onmousedown:function(e){var t,r,o,n,i,l=this,s=function(){var t,r,o,n=e.target;if("TABLE"===n.tagName.toUpperCase())return 0;for(;!o;){if(r&&(n=r.parentNode.parentNode.parentNode),"TH"===(t=n.tagName.toUpperCase()))return 0;for(;"TD"!==t;)if("TH"===(t=(n=n.parentNode).tagName.toUpperCase()))return 0;o=(r=n.parentNode).hasAttribute(a.ATTR_CONTENT_RECNO)||r.hasAttribute(a.ATTR_GROUP_RECNO)}return n}();s&&(t=s,r=l.curSelObj,o=l.report.viewer.options,n=t.parentNode,i=o.selectionCell?t:n,n.parentNode.parentNode===e.currentTarget&&o.selectionHighlight&&(r===i?i.classList.toggle(a.CSS_SH):(r&&r.classList.remove(a.CSS_SH),i.classList.add(a.CSS_SH),l.curSelObj=i)),l.clickedCell=t),l.syncElementData(e.target,e.currentTarget)},getClickedRow:function(){var e,t,r,o=this.clickedCell,n={};return o&&((r=(e=o.parentNode).getAttribute(a.ATTR_CONTENT_RECNO))?(n.type="content",n.recordNo=r):(r=e.getAttribute(a.ATTR_GROUP_RECNO))&&(t=e.hasAttribute(a.ATTR_GROUPH_INDEX),n.type=t?"groupheader":"groupfooter",n.groupIndex=+e.getAttribute(t?a.ATTR_GROUPH_INDEX:a.ATTR_GROUPF_INDEX))),n},clearColumns:function(){var e=this;e.ColumnContent.ContentCells.RemoveAll(),e.ColumnTitle.TitleCells.RemoveAll(),e.Columns.RemoveAll()},get width(){var e=this.Border;return this.columnsTotalWidth+e.getLeftWidth()+e.getRightWidth()},_ColumnMoveTo:function(e,t){var r=this,o=r.ColumnTitle.FindColumnTitlesOfTitleCell(e.TitleCell),a=t?t.SubTitles:r.ColumnTitle.TitleCells;r.MoveTitleTo(e.TitleCell,o,a,-1)},MoveTitleTo:function(e,t,r,o){t.items.splice(t.items.indexOf(e),1),0>o?r.items.push(e):r.items.splice(o,0,e)},get IsCrossTab(){return!!this.CrossTab},set IsCrossTab(e){var t=this;e?t.CrossTab||(t.CrossTab=new Tt(t)):delete t.CrossTab},AddColumn:function(e,t,r,o){var a=this.Columns.Add();return a.Name=e,a.Width=o,a.ContentCell.DataField=r,a.TitleCell.Text=t,a},ClearColumns:function(){this.Columns.RemoveAll()},FindGroupTitleCell:function(e){return function t(r){var o,a=r.items.length,n=r.itemByName(e);if(!n)for(o=0;a>o;o++)if((n=r.items[o]).GroupTitle&&(n=t(n.SubTitles)))return n;return n}(this.ColumnTitle.TitleCells)},AddGroupTitle:function(e,t){return this.ColumnTitle.TitleCells.AddGroup(e,t)},ClearGroupTitles:function(){var e,t,r=this.Columns.Count,o=this.ColumnTitle.TitleCells,a=[];for(e=1;r>=e;e++)ColumnMoveToEnd(e);for(r=o.Count,e=0;r>e;e++)!(t=o.items[e]).GroupTitle&&a.push(t);o.items=a},ColumnMoveToEnd:function(t){var r=this.Columns.Item(t);r&&sel._ColumnMoveTo(r,e)},ColumnMoveTo:function(t,r,o){var a,n=this,i=n.Columns.Item(t),l=i?i.TitleCell:n.FindGroupTitleCell(t),s=r?n.FindGroupTitleCell(r):e,u=r?s?s.SubTitles:e:n.ColumnTitle.TitleCells;l&&u&&(a=n.ColumnTitle.FindColumnTitlesOfTitleCell(l),n.MoveTitleTo(l,a,u,o))},StartNewGroup:function(e){var t,r=this,o=r.Recordset,a=r.Groups.items,n=a.length,i=r.Groups.Item(e);if(i){for(o.Prior(),t=n-1;t>=i.index;t--)r.endGroupItem(a[t]);for(o.Next(),t=i.index;n>t;t++)r.beginGroupItem(a[t])}},ColumnByShowOrder:function(t){return function t(r,o,a){var n,i,l=r.Count;for(n=0;l>n;n++)if((i=r.items[n]).GroupTitle){if(i=t(i.SubTitles,o,a))return i}else{if(o==a)return i;o++}return e}(this.ColumnTitle.TitleCells,0,t)}},Z(rt,xe);var ot=function(t){var r=this;xe.call(r,t),r.DataType=1,r.Name="",r.Format="",r.Value=e};ot.prototype={afterLoad:function(t){var o=this;D(o,"DataType",r.ParameterDataType),o.Value!==e&&o.setValue(o.Value)},prepare:function(){var e=this,t=e.DataType,r=e.Format;2===t||3===t?e.formater=new d(r):6===t?e.formater=new c(r):5===t&&(e.formater=new u(r))},unprepare:function(){delete this.formater},setValue:function(t){if(null!==t&&t!==e)switch(this.DataType){case 2:t=Math.floor(+t);break;case 3:t=+t;break;case 5:t=G(t);break;case 6:t=V(t);break;default:t+=""}else t=e;this.Value=t},get AsBoolean(){return!!this.Value},set AsBoolean(e){this.setValue(e)},get AsDateTime(){return M(this.Value)},set AsDateTime(e){this.setValue(e)},get AsFloat(){var e=this.Value;if(6===this.DataType){var t=new f;t.value=e,e=t.AsFloat}else e=+e;return isNaN(e)?0:e},set AsFloat(e){var t;6===this.DataType&&((t=new f).AsFloat=e,e=t.value),this.setValue(e)},get AsInteger(){return Math.floor(this.AsFloat)},set AsInteger(e){this.AsFloat=Math.floor(+e)},get AsString(){var t=this.Value;return t===e?"":t+""},set AsString(e){this.setValue(e)},get DisplayText(){var t=this,r=t.Value;return r===e?"":1===t.DataType?r+"":t.formater.format(r)},get IsNull(){return this.Value===e},Clear:function(){this.Value=e}},Z(ot,xe);var at=function(t,r){var o=this;t=t||{alpha:{background:1}},o.viewer=t,o.report=o,r&&(o.ownerSR=r),o.Font=new x(e),o.Font.font=new T,o.Parameters=new Te(o),o.ReportHeaders=new me(o),o.ReportFooters=new Ce(o),o.XmlTableName="",o.Unit=1,o.CodePage=65001,o.BackColor=16777215|t.alpha.background<<24,o.QuerySQL="",o.Title="",o.Author="",o.Description="",o.GlobalScript="",o.InitializeScript="",o.ProcessBeginScript="",o.ProcessEndScript="",o.BeforeSortScript="",o.Printer={DesignPaperWidth:21,DesignPaperLength:29.7,DesignPaperLeftMargin:2.5,DesignPaperRightMargin:2.5,DesignPaperOrientation:1}};at.prototype={load:function(e){var t=this;"string"==typeof e&&(t.isWR="_WR_"===e.substr(0,4),t.isWR&&(e=gr.wr.decodeWR(e)),e=JSON.parse(e)),t.loadFromJSON(e)},loadFromJSON:function(t){function r(e){return l[n?ae(e):e]}var o,a=this,n=a.isWR,i=a.Printer,l=t.Printer;a.Clear(),w(a,t),P(a,"BackColor",a.viewer.alpha.background),a.Font.loadFromJSON(t.Font,n),a.Parameters.loadFromJSON(t.Parameter),a.ReportHeaders.loadFromJSON(t.ReportHeader),a.ReportFooters.loadFromJSON(t.ReportFooter),t.DetailGrid&&a.InsertDetailGrid().loadFromJSON(t.DetailGrid),l&&((o=r("Width"))&&(i.DesignPaperWidth=o),(o=r("Height"))&&(i.DesignPaperLength=o),(o=r("LeftMargin"))!==e&&(i.DesignPaperLeftMargin=o),(o=r("RightMargin"))!==e&&(i.DesignPaperRightMargin=o),(o=r("Oriention"))&&(i.DesignPaperOrientation=2),a.Printer=i)},generateHtml:function(){function e(t,r){r&&(t.push(r.beginText()),r.children?r.children.forEach((function(r){e(t,r)})):t.push(r.innerText),t.push(r.endText()))}var t=[],r={htmlElements:[],addChild:function(e){r.htmlElements.push(e)}};return this.generate(r),r.htmlElements.forEach((function(r){e(t,r)})),t.join("")},generate:function(e){var t,r,o,a,n,i=this,l=i.viewer,s=i.fixedHeaderFooter,u=i.ReportHeaders,c=i.ReportFooters;s&&((r=new y).add("padding-right","17px"),o=l.addCustomStyle(r),l.fixedDivClass=o,(r=new y).add("overflow-y","scroll"),a=l.addCustomStyle(r),l.bodyDivClass=a),i.fireInitialize(),!i.ownerSR&&i.matchTables(),i.DetailGrid&&i.fireFetchRecord(),i.fireProcessBegin(),!i.ownerSR&&i.prepare(),i.singleChart?i.singleChart.generateContent(e):(t=i.RunningDetailGrid,i.reportFitHeight&&se(u.items.concat(c.items)),t&&t.buildRows(i),s?((n=new F("div",e)).addClass(l._getCSSName(o)),u.generate(n),t.generate(n,"title"),(n=new F("div",e)).addClass(l._getCSSName(a)),t.generate(n,"content"),c.Count&&((n=new F("div",e)).addClass(l._getCSSName(o)),c.generate(n))):(u.generate(e),t&&t.generate(e),c.generate(e))),!t&&i.fireProcessEnd()},matchTables:function(){var e=this,t=e.viewer.tables,r=[],o=function(e,t){var r=this,o=r.fieldNames=[],a=Math.min(t.length,50);for(r.tableName=e,r.table=t,r.matchWeight=0;a--;)for(var n in t[a])n=n.toUpperCase(),o.indexOf(n)<0&&o.push(n)};for(var a in o.prototype={isFullMatched:function(){return this.matchWeight>=200},turnToFullMatched:function(e){this.matchWeight=200,this.reportTableInfo=e},isMatched:function(){return this.matchWeight>=40},get recordCount(){return this.table.length}},t){var n=t[a];n&&n instanceof Array&&r.push(new o(a,n))}1===r.length&&r[0].recordCount>1&&e.DetailGrid?e.DetailGrid.Recordset.attachDataTable(r[0].table):function(e,t){function r(e,t,r){function o(e,t){var r,o=e.length,a=0;for(r=0;o>r;r++)t.indexOf(e[r])>=0&&a++;return 100*a/o}var a=t.recordCount,n=t.fieldNames,i=0;if(e.length&&t.fieldNames.length){if(!(i=o(e,n)))return 0;100===i&&e.length===n.length?i=200:i+=o(n,e),i+=r&&a>1||!r&&1===a?5:-5}return i}function o(e){return e>=200}function a(e){var t,r,o,a=[];for(t=e.Parameters.items.length;t--;)a.push(e.Parameters.items[t].Name.toUpperCase());for(r=e.FindFirstControl();r;)1===(o=r.ControlType)||8===o||7===o||12===o?a.push(r.Name.toUpperCase()):13===o&&r.cells.forEach((function(e){e.forEach((function(e){e.DataName&&a.push(e.DataName.toUpperCase())}))})),r=e.FindNextControl();return a}function n(e,t){for(var r,o,a=0,n=e.length;n>a;)o=e[a++],(!r||o.weight>r.weight)&&o.dataTableInfo.matchWeight<50&&(r=o);r&&i(r.weight,t,r.dataTableInfo)}function i(e,t,r){r.matchWeight<e&&(r.matchWeight=e,r.reportTableInfo=t)}var l,s,u,c,d,h,p,f,g,m,C,T,x=[];for(function e(t){function r(e,t){var r=this;r.isRecordset=e,r.tableName=t.XmlTableName,r.object=t}var o,a,n;if(t)for(x.push(new r(!1,t)),t.DetailGrid&&x.push(new r(!0,t.DetailGrid.Recordset)),a=t.FindFirstControl();a;)11===(n=a.ControlType)?(o=a.Recordset).Fields.Count>0&&x.push(new r(!0,o)):9===n&&e(a.Report),a=t.FindNextControl()}(e),u=x.length,c=t.length,l=0;u>l;++l){if(p=(d=x[l]).tableName){for(s=0;c>s&&t[s].tableName!=p;)++s;if(c>s){t[s].turnToFullMatched(d);continue}d.tableName=""}if(d.isRecordset){for(T=[],s=0,c=(C=d.object.Fields.items).length;c>s;)T.push(C[s++].RunningDBField.toUpperCase());for(g=[],c=t.length,s=0;c>s;)if(!(f=t[s++]).isFullMatched()){if(o(m=r(T,f,!0))){i(m,d,f),g=[];break}m>0&&g.push({dataTableInfo:f,weight:m})}g.length&&n(g,d)}}if(t.some((function(e){return!e.isMatched()})))for(u=x.length,l=0;u>l;++l)if(!(d=x[l]).isRecordset&&!d.tableName){for(T=a(d.object),g=[],c=t.length,s=0;c>s;)if(!(f=t[s++]).isFullMatched()){if(o(m=r(T,f,!1))){i(m,d,f),g=[];break}h=f.reportTableInfo,m>0&&(!h||h.isRecordset&&h.weight+50<m||!h.isRecordset&&h.weight<m)&&g.push({dataTableInfo:f,weight:m})}g.length&&n(g,d)}for(u=t.length,l=0;u>l;)(d=(f=t[l++]).reportTableInfo)&&d.object.attachDataTable(f.table)}(e,r)},attachDataTable:function(e){var t,r,o=e[0];for(var a in o)t=o[a],(r=this.ParameterByName(a))?r.setValue(t):(r=this.ControlByName(a))&&(r.hasOwnProperty("Text")||7===r.ControlType)&&(r.Text=t+"")},prepare:function(){var e=this,t=e.Printer,r=e.ReportHeaders,o=e.ReportFooters;e._scriptFailed=0,e.designWidth=e.size2Pixel((1===t.DesignPaperOrientation?t.DesignPaperWidth:t.DesignPaperLength)-t.DesignPaperLeftMargin-t.DesignPaperRightMargin),e.DetailGrid&&e.DetailGrid.attachData(),r.attachData(),o.attachData(),e.Parameters.prepare(),e.DetailGrid&&e.DetailGrid.prepare(),r.prepare(),o.prepare(),e._srChildren&&e._srChildren.forEach((function(e){e.Report.prepare()})),e.ownerSR||!e.viewer.options.singleChartFill||e.DetailGrid||r.Count+o.Count!==1||1!==(r.items[0]||o.items[0]).Controls.Count||(e.singleChart=(r.items[0]||o.items[0]).Controls.items[0],11!==e.singleChart.ControlType&&delete e.singleChart)},unprepare:function(){var e=this;e.Parameters.unprepare(),e.DetailGrid&&(e.DetailGrid.unprepare(),e.RunningDetailGrid=e.DetailGrid),e.ReportHeaders.unprepare(),e.ReportFooters.unprepare(),delete e._srChildren,delete e._has_cb,delete e.singleChart,delete e.canvasControls},getUsingFont:function(){return this.Font.font},getRunningColumn:function(e){var t,r,o=this.RunningDetailGrid;return e&&o&&((r=(t=o.Columns).itemByName(e))||("(GridLeft)"===e?r=t.Item(1):"(GridRight)"===e&&(r=t.Item(t.Count)))),r},getReportWidth:function(){var e=this.designWidth,t=this.RunningDetailGrid,r=t?t.width:0;return 2*r>e?r:e},get reportFitHeight(){return!this.RunningDetailGrid&&this.viewer.options.reportFitHeight},get reportFitWidth(){var e=this.viewer.options;return e.reportFitWidth||e.fixedHeaderFooter},get detailgridResize(){var e=this.viewer.options;return e.fixedHeaderFooter?gr.enum_.detailgridResize.fitWidth:e.detailgridResize},get fixedHeaderFooter(){return this.DetailGrid&&this.viewer.options.fixedHeaderFooter},get toFillHolder(){return this.reportFitHeight||this.singleChart},get isDynamicSize(){var e=this;return e.toFillHolder||e.reportFitWidth||e.detailgridResize},pixel2Size:function(e){return e/=96,1===this.Unit&&(e*=2.54),e},size2Pixel:function(e){return 1===this.Unit&&(e/=2.54),96*e},cm2Size:function(e){return 1===this.Unit?e:e/2.54},registerCanvas:function(e,t){var r=this,o=new F("canvas",t),a=le();o.addAttribute("id",a),r.isDynamicSize||!e.pxRect?(o.addStyle("width","100%"),o.addStyle("height","100%"),o.addStyle("display","block")):(o.addAttribute("width",Math.round(e.pxRect.Width())+""),o.addAttribute("height",Math.round(e.pxRect.Height())+"")),e.canvasID=a,r.canvasControls||(r.canvasControls=[]),r.canvasControls.push(e)},prepareCanvas:function(){for(var e,t=this.canvasControls,r=t.length;r-- >0;)(e=t[r]).canvas=document.getElementById(e.canvasID),e.prepareCanvas&&e.prepareCanvas()},resizeCanvas:function(){for(var e=this.canvasControls,t=e.length;t-- >0;)e[t].resizeCanvas()},renderCanvas:function(){for(var e=this.canvasControls,t=e.length;t-- >0;)e[t].drawCanvas(1)},startCanvas:function(){var e=this;e.canvasControls&&(e.prepareCanvas(),e.isDynamicSize?(re(window,"resize",(function(t){e.resizeCanvas()})),e.resizeCanvas()):e.renderCanvas()),e._srChildren&&e._srChildren.forEach((function(e){e.Report.startCanvas()}))},executeEventScript:function(e,t,r){gr.script.execEvent(e,t,r,this)},fireInitialize:function(){var e=this;e.InitializeScript&&e.executeEventScript(e.InitializeScript,"InitializeScript",e),e.OnInitialize&&e.OnInitialize()},fireFetchRecord:function(){var e=this;e.FetchRecordScript&&e.executeEventScript(e.FetchRecordScript,"FetchRecordScript",e.DetailGrid.Recordset),e.OnFetchRecord&&e.OnFetchRecord()},fireBeforePostRecord:function(){this.OnBeforePostRecord&&this.OnBeforePostRecord()},fireBeforeSort:function(e,t){var r=this;r.BeforeSortScript&&r.executeEventScript(r.BeforeSortScript,"BeforeSortScript",t),r.OnBeforeSort&&t.isDetailGridRecordset()&&r.OnBeforeSort()},fireProcessBegin:function(){var e=this;e.ProcessBeginScript&&e.executeEventScript(e.ProcessBeginScript,"ProcessBeginScript",e),e.OnProcessBegin&&e.OnProcessBegin()},fireProcessEnd:function(){var e=this;e.ProcessEndScript&&e.executeEventScript(e.ProcessEndScript,"ProcessEndScript",e),e.OnProcessEnd&&e.OnProcessEnd()},fireProcessRecord:function(e){var t=this;e.ProcessRecordScript&&t.executeEventScript(e.ProcessRecordScript,"ProcessRecordScript",e),t.OnProcessRecord&&t.OnProcessRecord()},fireGroupBegin:function(e){var t=this;e.GroupBeginScript&&t.executeEventScript(e.GroupBeginScript,"GroupBeginScript",e),t.OnGroupBegin&&t.OnGroupBegin(e)},fireGroupEnd:function(e){var t=this;e.GroupEndScript&&t.executeEventScript(e.GroupEndScript,"GroupEndScript",e),t.OnGroupEnd&&t.OnGroupEnd(e)},fireSectionFormat:function(e){var t=this;e.FormatScript&&t.executeEventScript(e.FormatScript,"FormatScript",e),t.OnSectionFormat&&t.OnSectionFormat(e)},fireFieldGetDisplayText:function(e){var t=this;e.GetDisplayTextScript&&t.executeEventScript(e.GetDisplayTextScript,"FieldGetDisplayTextScript",e),t.OnFieldGetDisplayText&&t.DetailGrid&&t.RunningDetailGrid.Recordset===e.owner&&t.OnFieldGetDisplayText(e)},fireTextBoxGetDisplayText:function(e){var t=this;e.GetDisplayTextScript&&t.executeEventScript(e.GetDisplayTextScript,"TextBoxGetDisplayTextScript",e),t.OnTextBoxGetDisplayText&&t.OnTextBoxGetDisplayText(e)},fireControlCustomDraw:function(e){var t=this,r=t.Graphics,o=e.Font,a=o?o.UsingFont():0,n=new S(e.canvas.getContext("2d"));!r&&(r=t.Graphics=new v(t)),r.attach(n),a&&n.selectFont(a),e.CustomDrawScript&&t.executeEventScript(e.CustomDrawScript,"CustomDrawScript",e),t.OnControlCustomDraw&&t.OnControlCustomDraw(e,r),a&&n.restoreFont()},fireChartRequestData:function(e){this.OnChartRequestData&&this.OnChartRequestData(e)},onCheckBoxClick:function(e){var t,r,o,n,i,l,s,u,c,d=this.DetailGrid,h=d.Recordset,p=e.target,f=p.id,g=p.checked,m=g?-1:-2,C=p.parentNode.parentNode;if(d&&(t=d.syncTRData(C),(i=p.getAttribute(a.ATTR_FIELD))?(h.Edit(),h.FieldByName(i).AsInteger=m,h.Post()):(u=this.report.ControlByName(f))&&(u.ImageIndex=m),r=t.group))for(o=r.beginNoField.AsInteger,n=r.endNoField.AsInteger,l=(s=document.querySelectorAll("."+a.CSS_CB)).length;l-- >0;)"CBC"===(f=(u=s[l]).id).substr(0,3)&&((c=+f.substr(3))>=o&&n>=c&&(u.checked=g,(i=u.getAttribute(a.ATTR_FIELD))&&(h.MoveTo(c),h.Edit(),h.FieldByName(i).AsInteger=m,h.Post())))},get root(){for(var e=this;e.ownerSR;)e=e.ownerSR.report;return e},get Version(){return a.VERSION},get FloatControls(){var e=this;return e._floatControls||(e._floatControls=new ce(e)),e._floatControls},get ImageList(){return{}},get ParentReport(){var t=this.ownerSR;return t?t.report:e},get Utility(){return gr.utility},get Running(){return!!this.viewer.running},get DisplayMode(){return 1},get IsBlank(){var e=this;return e.DetailGrid&&e.PageHeader&&e.PageFooter&&!e.ReportHeaders.Count&&!e.ReportFooters.Count},ControlByName:function(t){function r(o){function a(o){for(var a,n,i,l,s=o.length;s--;)if(i=o[s])for(a=i.length;a--;)if(n=(l=i[a])?(u=l).FreeCell?r(u.Controls):u.DataName.toUpperCase()===t?u:e:0)return n;var u;return e}for(var n,i=o.items,l=i.length;l--;){if((n=i[l]).Name.toUpperCase()===t)return n;if(13===n.ControlType&&(n=a(n.cells)))return n}return e}function o(t){return t.FreeCell?r(t.Controls):e}function a(e){for(var t=e.length;t--;)if(s=r(e[t].Controls))return s}var n,i,l,s,u=this;if(t=t.toUpperCase(),s=a(u.ReportHeaders.items)||a(u.ReportFooters.items))return s;if(u.DetailGrid){for(i=(n=u.DetailGrid.Groups.items).length;i--;)if(l=n[i],s=r(l.Header.Controls)||r(l.Footer.Controls))return s;for(i=(n=u.DetailGrid.ColumnContent.ContentCells.items).length;i--;)if(s=o(n[i]))return s;return function t(r){for(var a,n,i=r.items.length;i--;)if(n=o(a=r.items[i]),a.GroupTitle&&!n&&(n=t(a.SubTitles)),n)return n;return e}(u.DetailGrid.ColumnTitle.TitleCells)}return e},ColumnByName:function(t){return this.DetailGrid?this.DetailGrid.Columns.itemByName(t):e},FieldByName:function(e){return this.RunningFieldByName(e)},FieldByDBName:function(t){var r=this.RunningDetailGrid;return r?r.Recordset.FieldByDBName(t):e},ParameterByName:function(e){return this.Parameters.itemByName(e)},FindFirstControl:function(){function e(e){e.FreeCell&&(i=i.concat(e.Controls.items))}var t,r,o,a=this,n=a.DetailGrid,i=[];for(r=a.ReportHeaders.Count,t=0;r>t;t++)i=i.concat(a.ReportHeaders.items[t].Controls.items);for(r=a.ReportFooters.Count,t=0;r>t;t++)i=i.concat(a.ReportFooters.items[t].Controls.items);if(n){for(r=n.Groups.Count,t=0;r>t;t++)o=n.Groups.items[t],i=(i=i.concat(o.Header.Controls.items)).concat(o.Footer.Controls.items);n.ColumnContent.ContentCells.forEach((function(t){e(t)})),function t(r){r.forEach((function(r){e(r),r.GroupTitle&&t(r.SubTitles)}))}(n.ColumnTitle.TitleCells)}return i.length>0&&(a.findControls=i,a.findControlIndex=-1),a.FindNextControl()},FindNextControl:function(){var t=this;return t.findControls&&(++t.findControlIndex,t.findControlIndex>=t.findControls.length&&(delete t.findControls,delete t.findControlIndex)),t.findControls?t.findControls[t.findControlIndex]:e},RunningFieldByName:function(t){var r=this.RunningDetailGrid;return r?r.Recordset.FieldByName(t):e},PixelsToUnit:function(e){return this.pixel2Size(e)},UnitToPixels:function(e){return this.size2Pixel(e)},SystemVarValue:function(e){return this.SystemVarValue2(e,0)},SystemVarValue2:function(e,t){var r,o,a,n=this.RunningDetailGrid;if(1===e)r=new Date;else if(n)switch(o=n.Recordset,e){case 4:r=o.RecordNo+1;break;case 19:r=o.RecordCount;break;case 8:r=n.generatingRowNo;break;default:(a=n.Groups.items[t-1])&&(21===e?r=a.recordset.RecordCount:(a.inphaseByDetail(o.RecordNo),r=20===e?a.recordset.isAppendingRecord()?a.recordset.RecordCount:a.recordset.RecordNo:22===e?o.RecordNo-a.beginNoField.Value:a.endNoField.Value-a.beginNoField.Value,r++))}return r},AddParameter:function(e,t){var r=this.Parameters.Add();return r.Name=e,r.DataType=t,r},InsertDetailGrid:function(){var e=this;return e.DetailGrid||(e.DetailGrid=new rt(e),e.RunningDetailGrid=e.DetailGrid),e.DetailGrid},InsertPageHeader:function(){return new ze(this)},InsertPageFooter:function(){return new ze(this)},Clear:function(){var e=this;at.call(e,e.viewer,e.ownerSR),e.DeleteDetailGrid()},DeleteDetailGrid:function(){this.DetailGrid=e,this.RunningDetailGrid=e},DeletePageHeader:function(){},DeletePageFooter:function(){}};var nt="",it="_hta",lt="_htaa",st="_htc",ut="_htca",ct="_htn",dt="_htx",ht="_htp",pt="_vtp",ft=function(){this.Flag=0};ft.prototype={get CalcHTotal(){return 1&this.Flag},set CalcHTotal(e){e?this.Flag|=1:this.Flag&=-2},get CalcHAverage(){return 2&this.Flag},set CalcHAverage(e){e?this.Flag|=2:this.Flag&=-3},get CalcHAverageA(){return 4&this.Flag},set CalcHAverageA(e){e?this.Flag|=4:this.Flag&=-5},get CalcHCount(){return 8&this.Flag},set CalcHCount(e){e?this.Flag|=8:this.Flag&=-9},get CalcHCountA(){return 16&this.Flag},set CalcHCountA(e){e?this.Flag|=16:this.Flag&=-17},get CalcHMin(){return 32&this.Flag},set CalcHMin(e){e?this.Flag|=32:this.Flag&=-33},get CalcHMax(){return 64&self.Flag},set CalcHMax(e){e?this.Flag|=64:this.Flag&=-65},onBySummaryFun:function(e){var t=this;t.CalcHTotal=!0,2===e?t.CalcHAverage=!0:15===e?t.CalcHAverageA=!0:3===e?t.CalcHCount=!0:13===e?t.CalcHCountA=!0:4===e?t.CalcHMin=!0:5===e&&(t.CalcHMax=!0)}};var gt=function(t){var r=this;r.originObject=e,r.HTotalFlag=new ft,r.HSubtotalFlag=new ft,r.MiscFlag=0,r.DatafieldIndex=-1,r.TotalValue=0,r.EntireTotalValue=0,t&&Q(r,t,0)};gt.prototype={CopyAddField:function(e,t){var r=this,o=e.Fields.Add();return r.originObject.FieldType?(o.assign(r.originObject),r.originObject.isNumeric()&&(o.FieldType=3)):r.NumericField&&(o.FieldType=3,o.Format=r.originObject.textBuilder.items[0].format),o.Name=t,o.DBFieldName="",o._tableMember=t,o},CombineCalcFlag:function(e){var t=this;t.HTotalFlag.Flag|=e.HTotalFlag.Flag,t.HSubtotalFlag.Flag|=e.HSubtotalFlag.Flag,t.MiscFlag|=e.MiscFlag},SetFlagBySummaryFun:function(e,t){3===t?this.HSubtotalFlag.onBySummaryFun(e):this.HTotalFlag.onBySummaryFun(e)},get CalcHPercent(){return 1&this.MiscFlag},set CalcHPercent(e){e?this.MiscFlag|=1:this.MiscFlag&=-2},get CalcVPercent(){return 2&this.MiscFlag},set CalcVPercent(e){e?this.MiscFlag|=2:this.MiscFlag&=-3},get CalcTotalHPercent(){return 4&this.MiscFlag},set CalcTotalHPercent(e){e?this.MiscFlag|=4:this.MiscFlag&=-5},get CalcTotalVPercent(){return 8&this.MiscFlag},set CalcTotalVPercent(e){e?this.MiscFlag|=8:this.MiscFlag&=-9},get CalcHTotalExclude(){return 16&this.MiscFlag},set CalcHTotalExclude(e){e?this.MiscFlag|=16:this.MiscFlag&=-17},get NumericField(){return 32&this.MiscFlag},set NumericField(e){e?this.MiscFlag|=32:this.MiscFlag&=-33}};var mt=function(e,t){var r=this;r.Group=e,r.DataFieldInfo=t,r.DataSumBoxes=[]},Ct=function(t){var r=this;r.PriorCrossTitleCell=e,r.OriginTextBox=t,r.PriorTitleText=""},Tt=function(e){var t=this;xe.call(t,e),t.HCrossFields="",t.VCrossFields="",t.ListCols=1,t.TotalCols=0,t.SubtotalCols=0,t.HResort=!0,t.HSortAsc=!0,t.VResort=!0,t.VSortAsc=!0,t.HTotalAtFirst=!1,t.HPercentColumns="",t.VPercentColumns="",t.TotalExcludeColumns="",t.TotalHPercentColumns="",t.TotalVPercentColumns="",t.DisabledSumFields="",t.PercentFormat="0.##%",t.HCrossPeriodType=0,t.BeginDateParameter="",t.EndDateParameter="",t.GroupAutoSum=!0};Tt.prototype={loadFromJSON:function(e){e&&(xe.prototype.loadFromJSON.call(this,e),D(this,"HCrossPeriodType",r.PeriodType))},prepare:function(){function t(){var e=s.ParameterByName(l.BeginDateParameter),t=s.ParameterByName(l.EndDateParameter),r={};return e&&(r.begin=e.AsDateTime),t?(r.end=t.AsDateTime,e||(r.begin=E(r.end))):r.end=E(r.begin),r.end<r.begin&&(e=r.begin,r.begin=r.end,r.end=e),r}var o,a,n,l=this,s=l.report,u=9===l.HCrossPeriodType,c=new rt(s),d=c.Recordset,h=c.ColumnTitle.TitleCells,p=c.Columns,g=l.owner,m=g.Recordset,C=g.Columns,T=g.Groups.items,x=g.ColumnTitle.TitleCells.items,b=[],S=[],v=0,y=[],F=[],w=[],D=[],A=[],P=[];l.HAddedItemRecordOffsetBegin=-1,l.HAddedItemRecordOffsetEnd=-1,l.VAddedItemRecordOffsetBegin=-1,l.VAddedItemRecordOffsetEnd=-1,l.HPercentSums=[],c.assign(g),c.IsCrossTab=0,c.Recordset.BeforePostRecordScript="",a=c.Groups.items,function(){function R(e){var t=d.Fields.Add();return t.Name=e,t.FieldType=3,t}function B(t,o,n,i,m,C,x){function b(e,t){var r,o;e.FreeCell?(t.setFreeCell(!0),K(t,e),e.Controls.forEach((function(e){var a,n;r=e.ControlType,e.TextFormat?((o=t.Controls.Add(1)).assign(e),a=2!==l.HCrossPeriodType&&3!==l.HCrossPeriodType&&4!==l.HCrossPeriodType&&6!==l.HCrossPeriodType&&7!==l.HCrossPeriodType||4!==r||e.DataField!==l.HCrossFields?e.getDisplayText():function(){function e(e){var t=new f;return t.value=e,Math.floor(t.AsFloat)}var t,r=l.curPeriod.begin.getFullYear(),o=l.curPeriod.begin.getMonth()+1,a=l.curPeriod.begin.getDate();switch(l.HCrossPeriodType){case 2:t="第"+Math.floor((e(l.curPeriod.begin)-e(U.begin))/7+1)+"周";break;case 3:t=o+"月"+(t=11>a?"上":21>a?"中":"下")+"旬";break;case 4:t=o+"月"+(t=16>a?"上":"下")+"半月";break;case 6:t=N(r,2)+"-"+(o+2)/3+"季度";break;case 7:t=7>o?"上":"下",t=N(r,"00")+"-"+t+"半年"}return t}(),o.Text=a):((o=t.Controls.Add(r)).assign(e),7===r?e.DataField&&(o.DataField="",(n=s.FieldByName(e.DataField))&&(7===n.FieldType?o.Picture=n.Value:(a=n.DisplayText,o.ImageIndex=parseInt(a),isNaN(o.ImageIndex)&&(o.ImageIndex=0,o.ImageFile=a)))):12===r&&(o.Text=e.get_DisplayText()))}))):(t.assign(e),t.Text=e.getDisplayText())}var S,F,w,D,A=i?(2===n?"_":"_S")+i:"",P=t.Name+A;t.GroupTitle?(D=0,2===n?(F=(S=ue[x-q])?S[m]:0,D=F&&F.PriorCrossTitleCell&&F.PriorTitleText===F.OriginTextBox.getDisplayText()&&!C):3===n?(D=Q==$,F=ue[ue.length-1],F=m<F.length?F[m]:e,D?D=F&&!!F.PriorCrossTitleCell:0==m&&(w=t.Controls,D=w&&1===w.Count&&w.Item(1).getDisplayText&&w.Item(1).getDisplayText()===F.PriorTitleText)):4===n&&(F=ue[ue.length-1][m],(D=ee==re)&&(D=!!F.PriorCrossTitleCell)),D?o=F.PriorCrossTitleCell:(o=(o?o.SubTitles:h).AddGroup("",""),b(t,o),o.Name=P,F&&(F.PriorCrossTitleCell=o,F.PriorTitleText=F.OriginTextBox.getDisplayText())),t.SubTitles.forEach((function(e){B(e,o,n,i,m+1,!D,x)}))):t.Column.Visible&&function(){function e(e){var t;return y.some((function(r){return r.originObject.Name===e&&(t=r,!0)})),t}function i(e,t){var r;return l.HPercentSums.some((function(o){return o.Group===e&&o.DataFieldInfo===t&&(r=o,!0)})),r}function h(e,t){var r,o=function(e){switch(e){case 2:return it;case 15:return lt;case 3:return st;case 13:return ut;case 4:return ct;case 5:return dt}return""}(e);return 4===n||1===n?o?r=t+=nt+o:I.CalcHPercent?(r=t+nt,t+=ht):I.CalcVPercent?r=t+=pt:r=t+=nt:3===n?r=t+=A+o:(r=t+=A,I.CalcHPercent?t+="_hp":I.CalcVPercent&&(r=t+="_vp")),{DataField:t,SummaryDataField:r=_(r)}}function f(e,t){var r,o=0,a="";return e.varItems.forEach((function(n){o<n.beginIndex&&(a+=e.expText.substring(o,n.beginIndex)),1===n.varField.type?(r=h(t,n.varField.object.Name),a+=r.SummaryDataField):a+=n.varField.getExpText(),o=n.endIndex})),a+=e.expText.substr(o)}function m(e,t){return e="[#"+e,t&&(e+=":"+t),e+"#]"}function C(e,t){var o,a=0,n="";return e.varItems.forEach((function(i){var l=i.varField,s=l.type;a<i.beginIndex&&(n+=e.expText.substring(a,i.beginIndex)),4===s?(o=f(l.paramExp,l.SummaryFun),n+=t?W(r.SummaryFun,l.SummaryFun)+"("+o+(l.RankNo?","+l.RankNo:"")+")":o):n+=l.getExpText(),a=i.endIndex})),n+=e.expText.substr(a)}var x,S,F,w=1!==n,D=4===n,R=l.GroupAutoSum&&w,B=t.Column,N=B.orderNo,I=new gt;Q===$&&(2==n&&N>=X||3==n&&X>N)||ee===re&&(3==n&&N>=Z||4==n&&Z>N)||((x=p.addTo(o?o.SubTitles:c.ColumnTitle.TitleCells)).assign(B),x.Name=P,2!==n&&3!==n||(x._crossOrderNo=v),b(t,x.TitleCell),x.ContentCell.assign(B.ContentCell),S=x.ContentCell.getControls(),F=1===S.length,D?(ne.indexOf(B)>=0&&(I.CalcHPercent=1),ie.indexOf(B)>=0&&(I.CalcVPercent=1)):(oe.indexOf(B)>=0&&(I.CalcHPercent=1),ae.indexOf(B)>=0&&(I.CalcVPercent=1)),S.forEach((function(t,r){function o(r){a.forEach((function(o,a){function n(e,t){return e.isToGenerate()&&e.Controls.items.some((function(e){return e.AlignColumn===t.Name||e.AlignColumnEx===t.Name}))}function s(e){var o,a,n,i;return e.isToGenerate()&&((o=e.Controls.Add(5)).assign(t),o.Dock=0,o.TextAlign=t.TextAlign,o.AlignColumn=x.Name,o.DataField=r.summaryDataField,g.ShowColLine&&((a=o.Border).Styles|=4,n=g.ColLinePen.Width,(i=t.Border)&&4&i.Styles&&i.Pen.Width>0?n+=i.Pen.Width:a.Pen.Color=g.ColLinePen.Color,a.Pen.Width=n),F?(o.Top=0,o.Height=e.Height,16777215!==x.ContentCell.BackColor&&16777215===e.BackColor&&(o.BackStyle=1,o.BackColor=x.ContentCell.BackColor)):(o.Top=t.Top,o.Height=t.Height,1===t.BackStyle()&&(o.BackStyle=1,o.BackColor=t.BackColor))),o}var u,c,d,h=T[a];n(h.Footer,B)||n(h.Header,B)||((u=s(o.Footer))||(u=s(o.Header)),u&&(u.Format=r.format,I.CalcHPercent&&(u.Format=l.PercentFormat,(d=i(o,c=e(r.originDataField)))||(d=new mt(o,c),l.HPercentSums.push(d)),D?d.TotalSumBox=u:d.DataSumBoxes.push(u))))}))}var s,c,p,f,b,v=t.ControlType;4===v||5===v||7===v?(f=t.DataField,b=t.SummaryFun,5===v&&(f||(f=y[0].originObject.Name),p=t.Format,x.ContentCell.Controls?((t=new Re(x.ContentCell)).assign(S[r]),x.ContentCell.Controls.items[r]=t):x.ContentCell.assign(S[r])),s=h(b,f),t.DataField=s.DataField,7!==v&&(p&&(c=d.Fields.Item(s.DataField))&&(c.Format=p),R&&o({summaryDataField:s.SummaryDataField,originDataField:f,format:""}))):12===v?1!==n&&(s=h(t.Name,0),t.Text="[#"+s.DataField+"#]"):8===v&&function(){var e,a;u&&V(t,A)||((e=B.ContentCell.getControls()[r].textBuilder.items[0])&&e.varItems&&e.varItems.some((function(e){return 4===e.varField.type}))?(a=C(e,!1),t.Text=m(a,e.format),R&&o({summaryDataField:_(a),originDataField:"",format:e.format})):w&&(s=h(0,t.Name),t.Text="[#"+s.DataField+"#]",R&&o({summaryDataField:s.SummaryDataField,originDataField:t.Name,format:""})))}()})),w&&a.forEach((function(t,r){function o(e,t){t.isToGenerate()&&e.Controls.forEach((function(e){var r,o,a=e.ControlType;(e.AlignColumn||e.AlignColumnEx)===B.Name&&((r=t.Controls.Add(a)).assign(e),r.AlignColumn=x.Name,r.AlignColumnEx="",5===a?e.DataField&&(r.DataField=f(e.paramExp,e.SummaryFun),r.Tag=e.DataField,n.push(r)):8===a?(o="",e.textBuilder.forEach((function(e){o+=e.varItems?m(C(e,!0),e.format):e.text})),r.Text=o):4===a&&s.FieldByName(r.DataField)&&(r.DataField=h(0,originFieldName).SummaryDataField))}))}var a,n=[];o((a=T[r]).Footer,t.Footer),o(a.Header,t.Header),n.forEach((function(r){var o,a;I.CalcHPercent&&(r.Format=l.PercentFormat,o=e(r.Tag),(a=i(t,o))||(a=new mt(t,o),l.HPercentSums.push(a)),D?a.TotalSumBox=r:a.DataSumBoxes.push(r))}))})))}()}function I(){var t=x.length;for(o=re;t>o;o++)B(x[o],e,4,e,0,!0,-1)}function L(e){var t,r=e.getControls();e.GroupTitle&&1===r.length&&((t=r[0]).TextFormat&&(ue[ue.length-1].push(new Ct(t)),e.SubTitles.items.length>=1&&L(e.SubTitles.items[0])))}function E(t){var r,a;for(r="_"+t,b.forEach((function(e){(a=d.Fields.Add()).assign(e),a._tableMember="",a.DBFieldName="",a.Name+=r,a._hfval=e.Value,D.push(a)})),y.forEach((function(e){var t=e.originObject.Name+r;w.push(e.CopyAddField(d,t)),e.CalcHPercent&&((a=R(t+"_hp")).Format=l.PercentFormat,w.push(a)),e.CalcVPercent&&((a=R(t+"_vp")).Format=l.PercentFormat,w.push(a))})),o=q;Q>=o;o++)B(x[o],e,2,t,0,!1,o)}function V(e,t){var r,o=e.Text,a=o.indexOf(":");return a>0&&o.substring(2,a)===b[0].Name?(r="G"===t?"[#"+Y:o.substr(0,a)+t,r+=o.substr(a),e.Text=r,1):0}var M,G,O,U,z,J="_Month_",Y="_Date_",j=0,X=1,Z=1,q=-1,Q=-1,$=-1,ee=-1,te=0,re=-1,oe=[],ae=[],ne=[],ie=[],le=[],se=[],ue=[];if(u){if(l.GroupAutoSum=!1,m.Fields.forEach((function(e){6===e.FieldType&&b.push(e)})),!b.length)throw new Error("None date field!")}else{if(oe=C.decodeItems(l.HPercentColumns),ae=C.decodeItems(l.VPercentColumns),ne=C.decodeItems(l.TotalHPercentColumns),ie=C.decodeItems(l.TotalVPercentColumns),le=C.decodeItems(l.TotalExcludeColumns),!(b=m.decodeFields(l.HCrossFields)).length)throw new Error("生成交叉表不成功，没有定义'横向交叉数据字段'！");S=m.decodeFields(l.VCrossFields),se=m.decodeFields(l.DisabledSumFields),j=l.ListCols,Z=C.Count-l.TotalCols,X=Z-l.SubtotalCols}if(x.forEach((function(e,t){var r,o=e.findLastColumn();o&&(r=o.orderNo,0>q&&r>=j&&(q=t),0>Q&&r+1>=X&&(Q=t),0>$&&r>=X&&($=t),0>ee&&r+1>=Z&&(ee=t),0>re&&r>=Z&&(re=t))})),0>$&&($=Q+1),0>re&&(re=ee+1),Z>X&&Q>=$)for(O=C.items[X].TitleCell;O.SupCell;)++te,O=O.SupCell;if(function(){function e(e){var t=e.orderNo;return j>t?1:X>t?2:Z>t?3:4}function t(t,r){function o(e){se.indexOf(e.originObject)<0&&(y.some((function(t){return t.originObject===e.originObject&&(t.CombineCalcFlag(e),!0)}))||(e.NumericField=e.originObject.isNumeric(),y.push(e)))}function a(e,t){e?e.varItems.forEach((function(e){var r=e.varField;1===r.type&&(t.originObject=r.object,o(t))})):(t.originObject=y[0].originObject,o(t))}var n,i=new gt,l=e(r),s=1!==l,u=t.ControlType;4===l?(i.HTotalFlag.CalcHTotal=1,le.indexOf(r)>=0&&(i.CalcHTotalExclude=1),ne.indexOf(r)>=0&&(i.CalcTotalHPercent=1),ie.indexOf(r)>=0&&(i.CalcTotalVPercent=1)):3===l?i.HSubtotalFlag.CalcHTotal=1:2===l&&(oe.indexOf(r)>=0&&(i.CalcHPercent=1),ae.indexOf(r)>=0&&(i.CalcVPercent=1),i.CalcHPercent&&(i.HTotalFlag.CalcHTotal=1)),4===u||7===u?s&&(i.originObject=t.oDataField,i.originObject&&o(i)):5===u?(i.SetFlagBySummaryFun(t.SummaryFun,l),a(t.paramExp,i)):12===u?s&&(i.originObject=t,y.push(i)):8===u&&(n=!1,t.textBuilder.forEach((function(e){e.varItems&&e.varItems.forEach((function(e){var t,r=e.varField;4===r.type?((t=new gt(i)).SetFlagBySummaryFun(r.SummaryFun,l),a(r.paramExp,t),n=!0):1===r.type&&s&&((t=new gt(i)).originObject=r.object,o(t))})),!n&&s&&(i.originObject=t,i.NumericField=t.isPureNumericExpression(),y.push(i))})))}function r(r){r.Controls.forEach((function(r){var o=C.itemByName(r.AlignColumn)||C.itemByName(r.AlignColumnEx);o&&1!==e(o)&&t(r,o)}))}(function e(r){r.forEach((function(r){r.GroupTitle?e(r.SubTitles.items):r.Column.ContentCell.getControls().forEach((function(e){t(e,r.Column)}))}))})(x),T.forEach((function(e){r(e.Footer),r(e.Header)})),n=0,y.forEach((function(e){e.DatafieldIndex=n,++n,e.CalcHPercent&&++n,e.CalcVPercent&&++n}))}(),y.forEach((function(e){e.originObject.FieldType&&d.Fields.Remove(e.originObject.Name)})),function(){function e(e){e.Controls.items=e.Controls.items.filter((function(e){var t=p.itemByName(e.AlignColumn)||p.itemByName(e.AlignColumnEx);return!t||t.orderNo<l.ListCols}))}c.buildColumnsOrder(),a.forEach((function(t){e(t.Footer),e(t.Header)}))}(),c.clearColumns(),u)!function(){function e(e){var t=b[0];e.Controls.forEach((function(e){4===e.ControlType?t.Name===e.DataField&&(e.DataField=Y):8===e.ControlType&&V(e,"G")}))}var t,r,o=c.Groups.items[0];(function(){var e,t=b[0],r=new Date(2009,7,30),o=t.AsDateTime;for(e=0;7>e;++e)t&&(t.AsDateTime=r),E(++v),H(r);t.AsDateTime=o})(),o&&((t=d.Fields.Add()).FieldType=2,t.Name=J,S.push(t),o.ByFields=J,(t=d.Fields.Add()).FieldType=6,t.Format=b[0].Format,t.Name=Y,S.push(t),e(o.Header),e(o.Footer)),C.Count>1&&(r=C.items[1].ContentCell.BackColor,p.Item(1).ContentCell.BackColor=r,p.Item(7).ContentCell.BackColor=r)}();else{if(!y.length)throw new Error("生成交叉表不成功，不存在交叉数据项！");if(0>=q)throw new Error("生成交叉表不成功，不存在交叉数据列！");for(function(){var e=[];l.HResort&&b.forEach((function(t){e.push({field:t,asc:l.HSortAsc,case:1})})),G=m.sortRecords(e,1)}(),o=0;q>o;++o)B(x[o],e,1,e,0,!0,-1);for(function(){var e=m.Fields;d.Fields.forEach((function(t){F.push({crossField:t,originField:e.itemByName(t.Name)})}))}(),y.forEach((function(e){function t(e,t,o){(r=e.CopyAddField(d,t+o)).GetDisplayTextScript="",w.push(r)}var r,o=e.HTotalFlag,a=e.originObject.Name;o.CalcHTotal&&t(e,a,nt),o.CalcHAverage&&t(e,a,it),o.CalcHAverageA&&t(e,a,lt),o.CalcHCount&&t(e,a,st),o.CalcHCountA&&t(e,a,ut),o.CalcHMin&&t(e,a,ct),o.CalcHMax&&t(e,a,dt),e.CalcTotalHPercent&&((r=R(a+ht)).Format=l.PercentFormat,w.push(r)),e.CalcTotalVPercent&&((r=R(a+pt)).Format=l.PercentFormat,w.push(r))})),M=w.length,l.HTotalAtFirst&&I(),o=q;Q>=o;o++)ue.push([]),L(x[o]);0===l.HCrossPeriodType?function(){function t(){var t,r,a;for(A.push(v),t=A.length,r="_S"+t,y.forEach((function(e){a=e.originObject.Name+r,P.push(e.CopyAddField(d,a+nt)),e.HSubtotalFlag.CalcHAverage&&P.push(e.CopyAddField(d,a+it)),e.HSubtotalFlag.CalcHAverageA&&P.push(e.CopyAddField(d,a+lt)),e.HSubtotalFlag.CalcHCount&&P.push(e.CopyAddField(d,a+st)),e.HSubtotalFlag.CalcHCountA&&P.push(e.CopyAddField(d,a+ut)),e.HSubtotalFlag.CalcHMin&&P.push(e.CopyAddField(d,a+ct)),e.HSubtotalFlag.IsCalcHMax&&P.push(e.CopyAddField(d,a+dt))})),o=$;ee>=o;o++)B(x[o],e,3,t,0,!1,-1)}G.forEach((function(e,r){(e<l.VAddedItemRecordOffsetBegin||e>=l.VAddedItemRecordOffsetEnd)&&(m.MoveTo(e),r&&!m.fieldsKeepedValueChanged(b)||(l.SubtotalCols>0&&r&&function(){var e,t,r=!0,o=ue[ue.length-1],a=x[q],n=0;if(ue.length>1)return!1;for(;a.GroupTitle&&!(n>=o.length)&&(r=!!(e=o[n]).PriorCrossTitleCell&&e.PriorTitleText==e.OriginTextBox.getDisplayText())&&!((t=a.SubTitles).Count<=0)&&!(++n>=te);)a=t.Item(1);return!r}()&&(m.MoveTo(G[r-1]),t(),m.MoveTo(e)),m.keepValue(),E(++v)),m.curRecord._CrossNo_=v)})),l.SubtotalCols>0&&t()}():function(){for(var e,r,o=G.length,a=0;U?l.curPeriod=i.periodRangeNext(l.curPeriod,l.HCrossPeriodType):(U=t(),k(U.begin),k(U.end),H(U.end),l.curPeriod=i.periodRangeBy(U.begin,l.HCrossPeriodType)),l.curPeriod.begin<U.end;)for(e=b[0].AsDateTime,b[0].AsDateTime=l.curPeriod.begin,E(++v),b[0].AsDateTime=e;o>a&&(m.MoveTo(G[a]),!((r=b[0].AsDateTime)<l.curPeriod.begin||r>=l.curPeriod.end));)m.curRecord._CrossNo_=v,a++}(),!l.HTotalAtFirst&&I(),M>0&&(z=w.splice(0,M),w=w.concat(z)),l.HPercentSums.forEach((function(e){function t(e){e.isToGenerate()&&((r=e.Controls.Add(5)).DataField=o)}var r,o;e.TotalSumBox||(o=e.DataFieldInfo.originObject.Name+nt,t(e.Group.Footer),!r&&t(e.Group.Header),r.Visible=!1,e.TotalSumBox=r)}))}}(),function(){function r(e,t){y.forEach((function(r,o){var a,i=n*e+r.DatafieldIndex;r.NumericField?(a=r.originObject.AsFloat,w[i].AsFloat+=a,r.CalcHTotalExclude&&r.TotalValue||(r.TotalValue+=a,t&&(t[e*y.length+o]+=a))):w[i].IsNull&&(w[i].Value=r.originObject.Value)}))}function o(){d.Append(),F.forEach((function(e){e.crossField.Value=e.originField.Value})),D.forEach((function(e){e.Value=e._hfval})),y.forEach((function(e){e.TotalValue=0}))}function a(){function e(e,r,o,l,s){var u=r-e,c=u;if(l.CalcHAverageA||l.CalcHCountA)for(t=e;r>t;t++)w[n*t+o.DatafieldIndex].IsNull&&--c;i[a].AsFloat=s,a++,l.CalcHAverage&&(u>0&&(i[a].AsFloat=s/u),a++),l.CalcHAverageA&&(c>0&&(i[a].AsFloat=s/c),a++),l.CalcHCount&&(i[a].AsFloat=u,a++),l.CalcHCountA&&(i[a].AsFloat=c,a++),(l.CalcHMin||l.CalcHMax)&&function(){var s,u,c=Number.MAX_VALUE,d=-Number.MAX_VALUE;for(t=e;r>t;++t)(s=w[n*t+o.DatafieldIndex]).IsNull||(u=s.AsFloat,isNaN(u)||(c>u&&(c=u),u>d&&(d=u)));l.CalcHMin&&(c<Number.MAX_VALUE&&(i[a].AsFloat=c),a++),l.CalcHMax&&(d>-Number.MAX_VALUE&&(i[a].AsFloat=d),a++)}()}var t,r,o,a=n*v,i=w;for(y.forEach((function(t){t.HTotalFlag.Flag&&(e(0,v,t,t.HTotalFlag,t.TotalValue),t.CalcTotalHPercent&&(i[a].AsFloat=1,a++),t.CalcTotalVPercent&&a++,t.EntireTotalValue+=t.TotalValue)})),t=0;v>t;++t)y.forEach((function(e){e.CalcHPercent&&(a=n*t+e.DatafieldIndex,0!=e.TotalValue?w[a+1].AsFloat=w[a].AsFloat/e.TotalValue:w[a+1].Clear())}));A.length&&(r=P.length/A.length,o=0,A.forEach((function(l,s){var u=q(y.length,0);for(t=o;l>t;++t)y.forEach((function(e,r){u[r]+=w[n*t+e.DatafieldIndex].AsFloat}));i=P,a=r*s,y.forEach((function(t,r){e(o,l,t,t.HSubtotalFlag,u[r])})),o=l}))),d.Post()}var i,s,c=q(v*y.length,0);u?function(){var n,l,s,u,c=t(),d=[],h=0;for(d.push({field:b[0],asc:1,case:1}),n=(i=m.sortRecords(d,1)).length;c.begin<=c.end;){for(;n>h&&(m.MoveTo(i[h]),!(b[0].AsDateTime>=c.begin));)h++;for(l=c.begin.getDay(),s=c.begin.getMonth(),o(),S.length&&(S[0].AsInteger=s+1,S[1].AsDateTime=c.begin),u=l;7>u;++u){for(D[u].AsDateTime=c.begin;n>h&&(m.MoveTo(i[h]),!(b[0].AsDateTime>c.begin));)r(u,e),h++;if(H(c.begin),c.begin>c.end||S.length&&s!==c.begin.getMonth())break}a()}}():(s=[],l.VResort&&(S.forEach((function(e){s.push({field:e,asc:l.VSortAsc,case:1})})),b.forEach((function(e){s.push({field:e,asc:l.HSortAsc,case:1})}))),(i=m.sortRecords(s,1)).forEach((function(e,t){(e<l.HAddedItemRecordOffsetBegin||e>=l.HAddedItemRecordOffsetEnd)&&(m.MoveTo(e),t&&!m.fieldsKeepedValueChanged(S)||(m.keepValue(),t&&a(),o())),m.curRecord._CrossNo_&&r(m.curRecord._CrossNo_-1,c)})),a(),y.some((function(e){return e.CalcVPercent||e.CalcTotalVPercent}))&&function(){var e,t,r,o,a,i,l;for(d.First();!d.Eof();){for(d.Edit(),e=0,t=0,r=0,o=0;v>o;++o)y.forEach((function(r,s){r.CalcVPercent&&(a=n*o+r.DatafieldIndex,i=w[a].AsFloat,l=c[o*y.length+s],r.CalcHPercent&&++a,++a,l&&(w[a].AsFloat=i/l),e+=i,t+=l)})),o===A[r]&&(y.forEach((function(o){o.CalcVPercent&&(a=n*r+o.DatafieldIndex+1+(o.CalcHPercent?1:0),t&&(P[a].AsFloat=e/t))})),r++);a=n*v,y.forEach((function(e){var t=e.HTotalFlag;a<w.length&&(i=w[a].AsFloat,t.CalcHTotal&&++a,t.CalcHAverage&&++a,t.CalcHAverageA&&++a,t.CalcHCount&&++a,t.CalcHCountA&&++a,t.CalcHMin&&++a,t.CalcHMax&&++a,e.CalcTotalHPercent&&++a,e.CalcTotalVPercent&&(e.EntireTotalValue&&(w[a].AsFloat=i/e.EntireTotalValue),++a))})),d.Post(),d.Next()}}())}(),s.RunningDetailGrid=c,c.attachData(),c.prepare()},unprepare:function(){},GroupEndProcess:function(e){this.HPercentSums.forEach((function(t){var r;t.Group===e&&(r=t.TotalSumBox.Value,t.DataSumBoxes.forEach((function(e){r?e.Value/=r:e.Value=0})),t.TotalSumBox.Value=1)}))},getClickedCellHCrossFieldValue:function(e){var t,r,o=this.report.RunningDetailGrid,a=o.clickedCell,n=a?a.getAttribute("_grcrossno"):0;return n&&((t=o.Recordset.Fields.Item(e+"_"+n))&&(r=t.Value)),r},getClickedCellHCrossPeriod:function(){var e,t=this,r=t.report.RunningDetailGrid,o=r.clickedCell,a=o?"_"+o.getAttribute("_grcrossno"):0;return a&&(e=i.periodRangeBy(r.Recordset.Fields.Item(t.HCrossFields+a).AsDateTime,t.HCrossPeriodType)),e},get Recordset(){var t=this.report,r=t.RunningDetailGrid;return r!=t.DetailGrid?r.Recordset:e},HBeginAddItem:function(){this.HAddedItemRecordOffsetBegin=this.report.RunningDetailGrid.Recordset.RecordCount},HEndAddItem:function(){this.HAddedItemRecordOffsetEnd=this.report.RunningDetailGrid.Recordset.RecordCount},VBeginAddItem:function(){this.VAddedItemRecordOffsetBegin=this.report.RunningDetailGrid.Recordset.RecordCount},VEndAddItem:function(){this.VAddedItemRecordOffsetEnd=this.report.RunningDetailGrid.Recordset.RecordCount},GetCurPeriodBeginDate:function(){return this.curPeriod.begin},GetCurPeriodEndDate:function(){return this.curPeriod.end}},Z(Tt,xe);var xt=96/2.54,bt=[3381606,39423,16737996,3394764,10079232,6737100,10040319,3407718,16737843,13421568,6723993,14535833,3342489,8965273,13369497,14535833,13395507,10092424,10066278,14522879],St=bt.length,vt=function(e){ue.call(this,e)};X(vt,ue),vt.prototype._createItem=function(){return new Pt(this.owner)};var yt=function(e,t){this.series=e,this.group=t},Ft=function(e,t,r){yt.call(this,e,t),this.rect=r};Ft.prototype={inRange:function(e,t){var r=this.rect,o=r.Width(),a=r.Height();return(4>o||4>a)&&(r=r.clone(),4>o&&(r.left-=2,r.right+=2),4>a&&(r.top-=2,r.bottom+=2)),r.PtInRect(e,t)},tooltipPos:function(){var e=this.rect;return{x:(e.left+e.right)/2,y:(e.top+e.bottom)/2}}};var wt=function(e,t,r,o,a,n,i){var l=this;yt.call(l,e,t),l.x=r,l.y=o,l.r=a,l.beginAngle=n,l.endAngle=i};wt.prototype={inRange:function(e,t){var r,o,a,n,i=this,l=(r=e-i.x,o=t-i.y,a=Math.sqrt(r*r+o*o),n=Math.atan2(o,r),0>o&&(n+=2*Math.PI),{angle:360-ne(n),distance:a});return i.beginAngle<=l.angle&&l.angle<i.endAngle&&l.distance<i.r},tooltipPos:function(){var e=this,t=-ie(e.beginAngle+e.endAngle)/2,r=e.r/2;return{x:e.x+Math.cos(t)*r,y:e.y+Math.sin(t)*r}}};var Dt=function(e,t,r,o,a){var n=this;yt.call(n,e,t),n.x=r,n.y=o,n.r=a};Dt.prototype={inRange:function(e,t){var r=this,o=e-r.x,a=t-r.y;return Math.sqrt(o*o+a*a)<=r.r},tooltipPos:function(){return{x:this.x+4,y:this.y-4-Rt.prototype.options.tooltipFontSize}}};var At=function(e){var t=this;xe.call(t,e),t.LinePen=new m,t.CoordLinePen=new m,t.Label="",t.Max=0,t.Min=0,t.Space=0,t.TextAngle=0,t.TextVisible=!0,t.TextFormat="0.##",t.LineVisible=!0,t.CoordLineVisible=!1,t.MarginBeginWeight=25,t.MarginEndWeight=25,t.Scales=[],t.CustomCoordLines=[]};At.prototype={children:["LinePen","CoordLinePen"],afterLoad:function(e){var t=this,r=t.report.viewer.alpha.chartStroke,o=t.report.isWR;t.LinePen.loadFromJSON(e.LinePen,r,o),t.CoordLinePen.loadFromJSON(e.CoordLinePen,r,o)},CalcLabelHeight:function(){var e=this;return e.Used&&e.Label?e.owner.fontHeight+2:0},CalcHorzAxisHeight:function(e){return this.DoCalcAxisSize(!0,e)},CalcVertAxisWidth:function(){return this.DoCalcAxisSize(!1,!1)},DoCalcAxisSize:function(e,t){var r,o=this,a=o.owner,n=[],i=o.owner.fontHeight,l=0;if(o.Used){if(o.TextVisible&&(!e||!a.IsDrawNegativeGraph())){if(t)n.push("1Agf");else if(o.IsValueAxis)if(o.Scales.length)o.Scales.forEach((function(e){n.push(e.Text)}));else for(r=o.DrawMin;r<o.DrawMax+o.GetScaleTiny();r+=o.DrawSpace)n.push(o.ScaleFormatParser.format(r));else for(r=0;r<a.GroupCount;r++)n.push(a.GroupLabels[r]);-270===o.TextAngle?(n.forEach((function(e){l=Math.max(l,e.length)})),l*=i):(n.forEach((function(e){l=Math.max(l,a.context.measureTextWidth(e))})),e&&(l=Math.abs(Math.sin(ie(o.TextAngle))*l)+1+i))}a.Chart3DReal&&a.IsHorzGraph()&&a.YAxis===o&&(l+=a.yView3DDepth),o.LineVisible&&(l+=4),l&&(l+=4)}return l},CalcGroupPos:function(e,t){var r=this,o=r.owner,a=o.IsHorzGraph()?o.CalcColumnBarCount():o.CalcBarCount(),n=r.MarginBeginWeight+r.MarginEndWeight+100*(o.GroupCount-1)+(a>0?o.BarWidthPercent:0),i=n?e*r.MarginBeginWeight/n:0,l=e-i-(n?e*r.MarginEndWeight/n:0),s=100*t,u=s+(a>0?o.BarWidthPercent:0),c={};return n-=r.MarginBeginWeight+r.MarginEndWeight,c.BeginPos=i,c.EndPos=i,n>0&&(c.BeginPos+=l*s/n,c.EndPos+=l*u/n),c.LabelMiddlePos=(c.BeginPos+c.EndPos)/2,c},DrawHorzAxisLabel:function(e){var t=this,r=t.owner.context;!e.IsRectEmpty()&&t.Label&&r.drawText(t.Label,(e.left+e.right-r.measureTextWidth(t.Label))/2,(e.top+e.bottom-t.owner.fontHeight)/2)},DrawVertAxisLabel:function(e){var t=this,r=t.owner.context;!e.IsRectEmpty()&&t.Label&&r.drawTextRotate(t.Label,(e.left+e.right-t.owner.fontHeight)/2,(e.top+e.bottom+r.measureTextWidth(t.Label))/2,90)},DrawAxisTextsPrepare:function(e){var t,r=this,o=r.owner,a=[];if(r.IsValueAxis)if(r.Scales.length)r.Scales.forEach((function(t){a.push({Text:t.Text,PosVal:r.CalcValuePos(t.PosVal,e)})}));else for(t=r.DrawMin;t<r.DrawMax+r.GetScaleTiny();t+=r.DrawSpace)a.push({Text:r.ScaleFormatParser.format(t),PosVal:r.CalcValuePos(t,e)});else for(t=0;t<o.GroupCount;t++)a.push({Text:o.GroupLabels[t]||"",PosVal:r.CalcGroupPos(e,t).LabelMiddlePos});return a},DrawHorzAxis:function(e,t,r){function o(e,t,r,o,a){var n,i,l,s,u=h.owner.context,c=r.length,d=h.owner.fontHeight;if(o?(i=e.bottom-1,h.LineVisible&&(i-=4),p.Chart3DReal&&(i-=p.yView3DDepth),t+=p.xView3DDepth):(i=e.top+1,h.LineVisible&&(i+=4)),-270===h.TextAngle)for(s=u.measureTextWidth("A"),n=e.left+t-s,o&&(i-=d*c),l=0;c>l;l++)u.drawText(r.charAt(l),n,i),i+=d;else s=u.measureTextWidth(r),n=e.left+t-Math.abs(s/2*Math.cos(ie(h.TextAngle)))+Math.abs(d/2*Math.sin(ie(h.TextAngle))),o&&(i-=d),a||(i-=d+8-1),u.drawTextRotate(r,n,i,h.TextAngle)}var a,n,i,l,s,u,c,d,h=this,p=h.owner,f=p.context,g=e.Width()-p.xView3DDepth,m=p.IsDrawNegativeGraph(),C=h.IsValueAxis,T=h.LinePen,x=T.clone(),b=T.clone();h.Used&&!e.IsRectEmpty()&&(x.Width=.5,b.Width=.5,b.Color=Y(T.Color),h.LineVisible&&(f.selectPen(T),i=(n=e.left)+p.xView3DDepth,s=(l=n+g)+p.xView3DDepth,c=(u=r?e.bottom:e.top)-p.yView3DDepth,d=r?t.bottom-2*p.yView3DDepth:t.top,f.DrawHorzLine(u,n,l),p.Chart3DReal&&(p.YAxis.Used||!p.Y2Axis.Used||p.IsHorzGraph()?(f.drawPolyLine([l,u,s,c,i,c],0),f.drawPolyLine([s,c,s,d,i,d],0)):(f.drawPolyLine([s,c,i,c,n,u],0),f.drawPolyLine([s,d,i,d,i,c],0))),f.restorePen()),a=h.DrawAxisTextsPrepare(g),f.selectPen(x),a.forEach((function(a,n){var i,l,s=p.IsScatterGraph()||!m||(h.IsValueAxis?a.PosVal>=0:p.Value(0,n)>=0),u=e.left+a.PosVal;h.LineVisible&&(r?(u+=p.xView3DDepth,i=(l=e.bottom-p.yView3DDepth)-4):(i=e.top+1,l=s?e.top+1+4:e.top+1-4),f.DrawVertLine(u,i,l),p.Chart3DReal&&!C&&(r&&(u-=p.xView3DDepth,i+=p.yView3DDepth+4),f.selectPen(b),f.drawLine(u,i,u+p.xView3DDepth,i-p.yView3DDepth),f.restorePen())),h.TextVisible&&o(e,a.PosVal,a.Text,r,s),h.CoordLineVisible&&!C&&h.IsValueAxis&&(f.selectPen(h.CoordLinePen),i=t.top+1,l=t.bottom-p.yView3DDepth,r&&(i-=p.yView3DDepth,l-=p.yView3DDepth),f.DrawVertLine(u+p.xView3DDepth,i,l),f.restorePen()),C=!1})),f.restorePen(),h.CustomCoordLines.forEach((function(a){var n=h.CalcValuePos(a.PosVal,g);a.Text&&o(e,n,a.Text,r,!0),f.selectPen(a.LinePen),f.DrawVertLine(e.left+n,t.top+1,t.bottom),f.restorePen()})))},DrawVertAxis:function(e,t,r,o){function a(e,t,r,o){var a=c.owner.context;a.drawText(r,o?e.left+(c.LineVisible?4:0):e.right-a.measureTextWidth(r)-(c.LineVisible?4:0),t-c.owner.fontHeight/2)}var n,i,l,s,u,c=this,d=c.owner,h=d.context,p=e.Height()-d.yView3DDepth,f=c.LinePen,g=f.clone(),m=f.clone();!e.IsRectEmpty()&&c.Used&&(g.Width=.5,m.Width=.5,m.Color=Y(f.Color),c.LineVisible&&(h.selectPen(f),n=r?e.left-d.xView3DDepth:e.right,i=e.bottom,o&&(i-=d.yView3DDepth),l=i-p,h.DrawVertLine(n,l,i+1),d.Chart3DReal&&(s=n+d.xView3DDepth,u=i-d.yView3DDepth,h.drawPolyLine([n,i,s,u,s,u-p,n,l],0)),h.restorePen()),h.selectPen(g),c.DrawAxisTextsPrepare(p).forEach((function(n,i){var l,s,u=c.IsValueAxis?e.bottom-n.PosVal:e.top+n.PosVal+(o?0:d.yView3DDepth),p=u;c.LineVisible&&n.PosVal!=c.DrawMin&&(l=e.right-4,s=e.right,r&&(l=e.left,s=e.left+4),h.DrawHorzLine(p,l,s),d.Chart3DReal&&(h.selectPen(m),r?(l=e.left-d.xView3DDepth,p+=d.yView3DDepth):l=e.right,h.drawLine(l,p,l+d.xView3DDepth,p-d.yView3DDepth),h.restorePen())),c.TextVisible&&a(e,u,n.Text,r),c.CoordLineVisible&&c.IsValueAxis&&(h.selectPen(c.CoordLinePen),p-=d.yView3DDepth,h.DrawHorzLine(p,t.left+d.xView3DDepth+f.Width,t.right),h.restorePen())})),h.restorePen(),c.CustomCoordLines.forEach((function(o){var n=e.bottom-c.CalcValuePos(o.PosVal,p);o.Text&&a(e,n,o.Text,r),h.selectPen(o.LinePen),h.DrawHorzLine(n-d.yView3DDepth,t.left+d.xView3DDepth+f.Width,t.right),h.restorePen()})))},PrepareDraw:function(){var e=this;e.Used=!1,e.IsValueAxis=!1,e.DrawMax=-Number.MAX_VALUE,e.DrawMin=Number.MAX_VALUE,e.DrawSpace=0,e.ScaleFormatParser=new d(e.TextFormat)},PrepareDrawRange:function(){var e=this;e.Max?e.DrawMax=e.Max:e.Scales.forEach((function(t){e.DrawMax=Math.max(e.DrawMax,t.PosVal)})),e.Min?e.DrawMin=e.Min:e.DrawMin>0&&e.DrawMax>0?e.DrawMin=0:e.DrawMin<0&&e.DrawMax<0?e.DrawMax=0:e.owner.NegativeAsZero&&(e.DrawMin=0),e.DrawMax<=e.DrawMin&&(e.DrawMin=0,e.DrawMax=100)},PrepareDrawSpace:function(e,t,r){var o,a=this;a.Space?a.DrawSpace=a.Space:(o=a.owner.fontHeight*t,a.DrawSpace=(a.DrawMax-a.DrawMin)*o/e,a.DrawSpace=function(e,t){var r,o,a=0;for(e>=1&&(t=0),r=0;t>r;r++)e*=10;for(o=e;o>1;)++a,o/=10;if(o=.15>o?.1:.3>o?.2:.75>o?.5:1,t>0&&(a-=t),a>0)for(r=0;a>r;r++)o*=10;else for(r=a;0>r;r++)o/=10;return o}(a.DrawSpace,a.ScaleFormatParser.positiveAnalyser.precision)),a.DrawMax<=a.DrawMin&&(a.DrawMax=a.DrawMin+1,a.DrawSpace=.2),a.DrawSpace<2*a.GetScaleTiny()&&(a.DrawSpace=2*a.GetScaleTiny()),a.Max||a.Min||r||(a.DrawMax>0&&(a.DrawMax=a.DrawSpace*Math.ceil(a.DrawMax/a.DrawSpace)),a.DrawMin<0&&(a.DrawMin=a.DrawSpace*Math.floor(a.DrawMin/a.DrawSpace)))},GetScaleTiny:function(){return(this.DrawMax-this.DrawMin)/1e4},CalcValuePos:function(e,t){var r=this;return(e-r.DrawMin)*t/(r.DrawMax-r.DrawMin)},get ScaleCount(){return this.Scales.length},AddCustomScale:function(e,t){this.Scales.push({PosVal:e,Text:t})},EmptyCustomScale:function(){this.Scales=[]},GetScaleText:function(e){return this.Scales[e].Text},GetScaleValue:function(e){return this.Scales[e].PosVal},AddCustomCoordLine:function(e,t,r,o,a){var n=new m;n.Width=r,n.Style=a,n.Color=o,this.CustomCoordLines.push({PosVal:e,Text:t,LinePen:n})},EmptyCustomCoordLine:function(){this.CustomCoordLines=[]}},Z(At,xe);var Pt=function(e){var t=this;xe.call(t,e),t.ChartType=1,t.ByY2Axis=!1,t.SeriesName="",t.XValueField="",t.YValueField="",t.ZValueField="",t.FillColor=0,t.FillColorAuto=!0,t.LabelText="",t.LabelAsGroup=!1,t.LabelInBar=!1,t.LabelTextAngle=0,t.TooltipText="",t.ValueFormat="0.##",t.MarkerStyle=3,t.MarkerSize=4,t.MarkerColor=16777215,t.MarkerColorAuto=!0,t.MarkerLegendShow=!0,t.BorderPen=new m,t.MarkerPen=new m};Pt.prototype={afterLoad:function(e){var t=this,o=t.report.viewer.alpha,a=o.chartGraph,n=o.chartStroke,i=t.report.isWR;"StepBarChart"===t.ChartType?t.ChartType=4:D(t,"ChartType",r.ChartType),D(t,"MarkerStyle",r.PointMarkerStyle),P(t,"FillColor",a),P(t,"MarkerColor",a),t.BorderPen.loadFromJSON(e.BorderPen,n,i),t.MarkerPen.loadFromJSON(e.MarkerPen,n,i)},PrepareDraw:function(){this.ValueFormatParser=new d(this.ValueFormat)},IsHorzGraph:function(){var e=this;return 11===e.ChartType||12===e.ChartType||13===e.ChartType},IsPercent100Graph:function(){var e=this;return 2===e.ChartType||10===e.ChartType||13===e.ChartType},IsBarChart:function(){var e=this;return 1===e.ChartType||4===e.ChartType||10===e.ChartType||11===e.ChartType||12===e.ChartType||13===e.ChartType},IsScatterGraph:function(){var e=this;return 5===e.ChartType||6===e.ChartType||8===e.ChartType||9===e.ChartType},CanGroupLabelChart:function(){return 1===this.ChartType||11===this.ChartType},HasPointMarker:function(){var e=this;return 3===e.ChartType||7===e.ChartType||5===e.ChartType||6===e.ChartType||8===e.ChartType||9===e.ChartType},Support3D:function(){var e=this;return 1===e.ChartType||4===e.ChartType||10===e.ChartType||11===e.ChartType||12===e.ChartType||13===e.ChartType||2===e.ChartType}},Z(Pt,xe);var Rt=function(e){var t=this;Ie.call(t,e),t.XAxis=new At(t),t.YAxis=new At(t),t.Y2Axis=new At(t),t.Series=new vt(t),t.Recordset=new Ke(t),t.TitleFont=new x(t.Font),t.ValueFont=new x(t.Font),t.Title="",t.Chart3D=!1,t.Chart3DViewAngle=35,t.LegendVisible=!0,t.LegendValueVisible=!1,t.LegendShowSum=!1,t.LegendAtBottom=!1,t.LegendColumnCount=0,t.LegendSumLabel="",t.SeriesField="",t.SeriesAuto=!0,t.GroupField="",t.GroupAuto=!0,t.GroupCount=5,t.SeriesCount=2,t.AbsNegativeValue=!1,t.NegativeBarColor=255,t.BarWidthPercent=70,t.NegativeAsZero=!1,t.SingleSeriesColored=!0,t.Bar3DAxisDepth=25,t.Pie3DHeightDepth=25,t.BubbleScalePerCm=0,t.SeriesLabels=[],t.GroupLabels=[],t.values=[]};Rt.prototype={ControlType:11,children:["Border","XAxis","YAxis","Y2Axis","Series"],options:{tooltipBoxColor:"rgba(0,0,0,.8)",tooltipBoxCorner:4,tooltipFontSize:14,tooltipFontStyle:"normal",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontColor:"#fff"},afterLoad:function(e){var t,r,o=this,a=o.report.viewer.alpha,n=a.chartGraph,i=a.chartStroke,l=o.report.isWR;if(Ie.prototype.afterLoad.call(o,e),P(o,"NegativeBarColor",n),o.XAxis.loadFromJSON(e.XAxis,i),o.YAxis.loadFromJSON(e.YAxis,i),o.Y2Axis.loadFromJSON(e.Y2Axis,i),o.Series.loadFromJSON(e.ChartSeries),o.Recordset.loadFromJSON(e.Recordset),o.TitleFont.loadFromJSON(e.TitleFont,l),o.ValueFont.loadFromJSON(e.ValueFont,l),o.prepareValues(),(t=e[o.getJsonMember("GroupLabel")])&&(o.GroupLabels=t.split("\r")),(t=e[o.getJsonMember("SeriesLabel")])&&(o.SeriesLabels=t.split("\r")),t=e[o.getJsonMember("Value")]){for(r=(t=t.split(",")).length;r-- >0;)t[r]=+t[r];for(o.values=[],r=0;r<o.SeriesCount;)o.values.push(t.slice(r++*o.GroupCount,r*o.GroupCount))}},assign:function(e){var t=this;Ie.prototype.assign.call(t,e),t.TitleFont.assign(e.TitleFont),t.ValueFont.assign(e.ValueFont),t.XAxis.assign(e.XAxis),t.YAxis.assign(e.YAxis),t.Y2Axis.assign(e.Y2Axis),t.Series.assign(e.Series),t.Recordset.assign(e.Recordset)},bindRecordset:function(){var e=this,t=e.Recordset;t.prepare(),e.oSeriesField=t.FieldByName(e.SeriesField),e.oGroupField=t.FieldByName(e.GroupField),e.Series.forEach((function(e){e.oYValueField=t.FieldByName(e.YValueField),e.IsScatterGraph()&&(e.oXValueField=t.FieldByName(e.XValueField),9===e.ChartType&&(e.oZValueField=t.FieldByName(e.ZValueField)))}))},unprepare:function(){Ie.prototype.unprepare.call(this),this.Recordset.unprepare()},loadDrawingData:function(){var e,t,r,o,a,n=this,i=n.origin,l=n.Recordset,s=n.owner.owner,u=n.runningNo,c=n.report,d=c.DetailGrid;n.bindRecordset(),n.Series.items.every((function(e){return e.oYValueField&&(!e.IsScatterGraph()||e.oXValueField&&(9!==e.ChartType||e.oZValueField))}))?(l.RecordCount||(d&&(o=d.Recordset),s.ByFields&&(a=s),u>=1e4&&(u=Math.floor(u/1e4),c=(s=(t=c.ownerSR).owner.owner).report,a||d?t._relations&&(--u,s.ByFields&&(s.recordset.MoveTo(u),u=s.beginNoField.AsInteger),c.DetailGrid.Recordset.MoveTo(u),r=1,t.attachRelationTable()):(s.ByFields&&(a=s),(d=c.DetailGrid)&&(o=d.Recordset))),i&&(e=i.Recordset),e&&e.RecordCount?a?function(t,r){var a,n=d.Groups.items,i=[],s="",u=[];for(t.recordset.MoveTo(r-1),o.MoveTo(t.beginNoField.AsInteger),a=t.index;a>=0;a--)s&&(s+=";"),s+=n[a].ByFields;for(e.decodeFields(s).forEach((function(e){i.indexOf(e)<0&&i.push(e)})),i.forEach((function(e){var t=o.Fields.itemByName(e.Name);t&&u.push({origin:e,detail:t})})),e.First();!e.Eof();)u.every((function(e){return!e.detail.valUeq(e.origin)}))&&l.appendRefRecord(e.curRecord),e.Next()}(a,u):l._dataTable=i._dataTable:function(e,t,r){var o=0,a=e.RecordCount;for(t&&(t.recordset.MoveTo(r-1),o=t.beginNoField.AsInteger,a=t.endNoField.AsInteger+1);a>o;)e.MoveTo(o++),l.appendRefRecord(e.curRecord)}(o,a,u),r&&t.detachRelationTable()),n.applyDataFromRecordset()):n.values||n.EmptyValues()},applyDataFromRecordset:function(){var t,r,o,a,n,i,l=this,s=l.Recordset,u=l.Series.items,c=u[0].IsScatterGraph();for(l.SeriesAuto&&l.oSeriesField&&(l.SeriesCount=0,l.SeriesLabels=[]),!c&&l.GroupAuto&&l.oGroupField&&(l.GroupCount=0,l.GroupLabels=[]),l.EmptyValues(),s.First();!s.Eof();)t=0,l.oSeriesField&&(r=l.oSeriesField.DisplayText,0>(t=l.GetSeriesIndexByLabel(r,!1))&&l.SeriesAuto&&(t=l.SeriesCount,l.SeriesLabels.push(r),++l.SeriesCount)),o=0,l.oGroupField&&!c&&(a=l.oGroupField.DisplayText,0>(o=l.GetGroupIndexByLabel(a,!1))&&l.GroupAuto&&(o=l.GroupCount,l.GroupLabels.push(a),++l.GroupCount)),u.forEach((function(r,a){a&&(t=a),c?l.AddXYZValue(t,r.oXValueField.AsFloat,r.oYValueField.AsFloat,r.oZValueField?r.oZValueField.AsFloat:e):(n=r.oYValueField.AsFloat,(i=l.Value(t,o))&&(n+=i),l.SetValue(t,o,n))})),s.Next()},showTooltip:function(t,r){var o=this,a=o.options,n=o.context;if(t||(t=e),o.activeShape!==t&&(o.activeShape=t,n.ctx.clearRect(0,0,o.canvas.width,o.canvas.height),o.draw(),t)){var i=o.graphSerieses[t.series];if(i.TooltipTextBuilder){var l,s=n.ctx.font,u=i.TooltipTextBuilder.generateChartDisplayText(t.series,t.group),c=t.tooltipPos(),d=a.tooltipFontSize+2,h=0;if(n.ctx.font=R(a.tooltipFontSize,a.tooltipFontStyle,a.tooltipTitleFontFamily),i.tooltipLines>1){l=[];for(var p,f,m=0;(p=u.indexOf("\n",m))>=0;)f=u.substring(m,p-("\r"===u.charAt(p-1)?1:0)),l.push(f),h=Math.max(h,n.measureTextWidth(f)),m=p+1;f=u.substr(m),l.push(f),h=Math.max(h,n.measureTextWidth(f))}else h=n.measureTextWidth(u);var C=new g(c.x,c.y,c.x+h,c.y+d*i.tooltipLines-2);if(C.InflateRect(a.tooltipBoxCorner,a.tooltipBoxCorner),C.OffsetRect(Math.min(o.canvas.width-C.right,0),Math.min(o.canvas.height-C.bottom,0)),n.selectFillStyle(a.tooltipBoxColor),n.roundRectangle(C.left,C.top,C.Width(),C.Height(),a.tooltipBoxCorner,a.tooltipBoxCorner,1),n.restoreFillStyle(),n.selectFillStyle(a.tooltipFontColor),l){var T=C.left+a.tooltipBoxCorner,x=C.top+a.tooltipBoxCorner;l.forEach((function(e){n.drawText(e,T,x),x+=d}))}else n.drawTextCenter(u,(C.left+C.right)/2,(C.top+C.bottom-a.tooltipFontSize)/2);n.restoreFillStyle(),n.ctx.font=s}}},prepareCanvas:function(){function e(e){var t,r,a=o.shapes.length;if(o.graphs.length>1)for(t=0;a>t;t++)if(!(r=o.shapes[t]).rect&&r.inRange(e.x,e.y))return r;for(t=0;a>t;t++)if((r=o.shapes[t]).inRange(e.x,e.y))return r;return 0}function t(e){for(var t,r=o.shapesL.length;r-- >0;)if((t=o.shapesL[r]).inRange(e.x,e.y))return t;return 0}var r,o=this,a=o.onclickGraph,n=o.onclickLegend,i=o.ondblclickGraph,l=o.ondblclickLegend,s=0;o.Chart3DReal=o.Chart3D&&o.Support3D(),o.xView3DDepth=0,o.yView3DDepth=0,o.Chart3DReal&&(r=ie(o.Chart3DViewAngle),o.xView3DDepth=Math.cos(r)*o.Bar3DAxisDepth,o.yView3DDepth=Math.sin(r)*o.Bar3DAxisDepth),o.loadDrawingData(),function(){var e,t,r=o.Series.items,a=r.length;for(e=0;a>e;e++)if((t=r[e]).LabelText&&(t.LabelTextBuilder=new p(o,t.LabelText)),t.TooltipText){t.TooltipTextBuilder=new p(o,t.TooltipText),t.tooltipLines=1;for(var n=0;(n=t.TooltipText.indexOf("\n",n))>=0;)++n,++t.tooltipLines;s=1}}(),function(){var e,t,r=o.Series.items,a=o.graphs=[],n=o.graphSerieses=[];for(e=0;e<o.SeriesCount;e++){t=e<r.length?r[e]:r[0],n.push(t);for(var i=0;i<a.length;i++)if(t.ChartType===n[a[i][0]].ChartType){a[i].push(e);break}i===a.length&&a.push([e])}}(),s&&oe(o,["mousemove","touchstart","touchmove","mouseout"],(function(t){var r,a;"mouseout"!==t.type&&(a=e(r=te(t))),o.showTooltip(a,r)})),(a||n)&&re(o.canvas,"click",(function(r){var i,l=te(r);a&&((i=e(l))&&a(r,o,i.series,i.group)),n&&((i=t(l))&&n(r,o,i.series,i.group))})),(i||l)&&re(o.canvas,"dblclick",(function(r){var a,n=te(r);i&&((a=e(n))&&i(r,o,a.series,a.group)),l&&((a=t(n))&&l(r,o,a.series,a.group))}))},draw:function(t){var r,o,a,n=this,i=n.canvas,l=i.width,s=i.height,u=n.context=new S(i.getContext("2d")),c=new g(0,0,l,s),d=n.graphs,h=n.graphSerieses,p=n.XAxis,f=n.YAxis,C=n.Y2Axis,T=0;n.fontHeight=B(n.getUsingFont()),n.valueFontHeight=B(n.getUsingValueFont()),u.selectFont(n.getUsingFont()),u.selectFillColor(n.ForeColor),n.report.singleChart&&(c.left+=n.PaddingLeft,c.top+=n.PaddingTop,c.right-=n.PaddingRight,c.bottom-=n.PaddingBottom),n.toUpdateShapes=t,t&&(n.shapes=[],n.shapesL=[]),function(){var e,t,i,u,c=n.IsScatterGraph(),g=n.Series.items,m=g[0].ChartType,x=10===m||13===m,b=0,S=0;for(p.PrepareDraw(),f.PrepareDraw(),C.PrepareDraw(),o=g.length,r=0;o>r;r++)g[r].PrepareDraw(this);p.Used=!0,p.IsValueAxis=!1,f.IsValueAxis=!0,C.IsValueAxis=!0,n.Title&&(T=B(n.getUsingTitleFont())+8),c?(p.IsValueAxis=!0,d.forEach((function(e){e.forEach((function(e){var t,o=n.values[e],a=o?o.length:0,i=p,l=n.YAxisOfSeries(h[e]);for(l.Used=!0,r=0;a>r;r++)(t=o[r]).y<l.DrawMin&&(l.DrawMin=t.y),t.y>l.DrawMax&&(l.DrawMax=t.y),t.x<i.DrawMin&&(i.DrawMin=t.x),t.x>i.DrawMax&&(i.DrawMax=t.x),b<t.z&&(b=t.z),S+=t.z}))})),p.PrepareDrawRange()):d.forEach((function(e){var t,r,o=h[e[0]].ChartType,a=4===o||10===o||12===o||13===o;for(t=0;t<n.GroupCount;t++)if(r=0,e.forEach((function(e){var o=n.Value(e,t),i=n.YAxisOfSeries(h[e]);a?r+=o:(i.Used=!0,n.AbsNegativeValue&&(o=Math.abs(o)),o<i.DrawMin&&(i.DrawMin=o),o>i.DrawMax&&(i.DrawMax=o))})),a){var i=h[e[0]],l=n.YAxisOfSeries(i);l.Used=!0,x?(l.DrawMin=0,l.DrawMax=100):(r<l.DrawMin&&(l.DrawMin=r),r>l.DrawMax&&(l.DrawMax=r))}})),f.Used||C.Used||(f.Used=!0),f.Used&&(a=f.DrawMax),C.Used&&a<C.DrawMax&&(a=C.DrawMax),f.PrepareDrawRange(),C.PrepareDrawRange(),e=s-T-p.CalcLabelHeight()-p.CalcHorzAxisHeight(!0),e=Math.max(e,1),f.PrepareDrawSpace(e,3,x),C.PrepareDrawSpace(e,3,x),c&&(t=l-f.CalcLabelHeight()-f.CalcVertAxisWidth()-C.CalcLabelHeight()-C.CalcVertAxisWidth(),t=Math.max(t,1),p.PrepareDrawSpace(t,6,!1),e=s-T-p.CalcLabelHeight()-p.CalcHorzAxisHeight(!1),e=Math.max(e,1),9===g[0].ChartType&&(n.DrawBubbleScalePerCm=n.BubbleScalePerCm,n.DrawBubbleScalePerCm<=0&&(i=t*e*.25/(xt*xt),n.DrawBubbleScalePerCm=S/i),u=Math.sqrt(b/n.DrawBubbleScalePerCm)*xt,0===f.Max&&(f.DrawMax+=(f.DrawMax-f.DrawMin)*(u/2)/e),0==p.Max&&(p.DrawMax+=(p.DrawMax-p.DrawMin)*(u/2)/t)))}(),n.LegendVisible&&n.SeriesCount&&function(t){function r(){var e=t.Series.items[0].ChartType;return 1===t.SeriesCount&&t.SingleSeriesColored&&(1===e||3===e||7===e||11===e)}function o(){return t.LegendValueVisible&&(!t.IsScatterGraph()||9===t.Series.items[0].ChartType)}function a(){return t.LegendShowSum&&o()}function n(){return(r()?t.GroupCount:t.SeriesCount)+(a()?1:0)}function i(e){return r()?e===t.GroupCount:e===t.SeriesCount}function l(e){return i(e)?t.LegendSumLabel||"合计":r()?t.GroupLabels[e]:t.getSeriesShowLabel(e)}function s(o){var a,n=t.graphSerieses[0];return i(o)?a=t.GetTotalValue():r()?a=t.Value(0,o):(a=t.GetSeriesTotalValue(o),n=t.graphSerieses[o]),a===e?"":n.ValueFormatParser.format(a)}function u(e){var t={series:-1,group:-1};return i(e)||(r()?t.group=e:t.series=e),t}function d(e,o){var a,n,i=t.context,l=t.GetGraphFillColor(e);r()||(a=(n=t.graphSerieses[e]).HasPointMarker()&&n.MarkerLegendShow)&&i.DrawPointMarker(o,n.MarkerStyle,n.MarkerPen,l),a||(i.selectFillColor(l),i.rectangle2(o,1),i.restoreFillStyle())}var h;t.LegendAtBottom?(h=function(e){var r,a,c,h,p,f,m,C=t.context,T=o(),x=t.LegendColumnCount,b=x>0?x:999,S=e.Width(),v=2*t.fontHeight,y=3*v/4,F=n(),w=S,D=[],A={Count:0,Width:0};if(!F)return 0;for(a=0;F>a;++a)r=8+y+4,r+=C.measureTextWidth(l(a)),T&&(r+=4+C.measureTextWidth(s(a))),(r>w||A.Count>=b)&&A.Width>0&&(D.push(A),A={Count:0,Width:0},w=S),A.Count++,A.Width+=r,w-=r;for(A.Count>0&&D.push(A),h=4+D.length*v,A=D[c=0],a=e.bottom-h+4,p=new g((e.left+e.right-A.Width)/2,e.bottom-h+4,0,a+v),a=0;F>a;++a)A.Count<=0&&(A=D[++c],p.left=(e.left+e.right-A.Width)/2,p.top=p.bottom,p.bottom+=v),A.Count--,p.left+=8,S=p.left,(F-1>a||!i(a))&&(r=(p.top+p.bottom-y)/2,d(a,new g(p.left,r,p.left+y,r+y))),p.left+=y,f=(p.top+p.bottom-t.fontHeight)/2,m=l(a),p.left+=4,p.right=p.left+C.measureTextWidth(m),C.drawText(m,p.left,f),p.left=p.right,T&&(m=s(a),p.left+=4,p.right=p.left+C.measureTextWidth(m),C.drawText(m,p.left,f),p.left=p.right),t.toUpdateShapes&&(b=u(a),t.shapesL.push(new Ft(b.series,b.group,new g(S,p.top,p.right,p.bottom))));return h}(c),c.bottom-=h+8):(h=function(e){var r,i,c,h,p,f,C,T,x,b,S,v,y,F,w=t.context,D=o(),A=a(),P=n(),R=t.LegendColumnCount,B=2*t.fontHeight,N=3*B/4,I=e.Height()-8,L=0,E=0,V=8,M=[],k=[];if(!P)return 0;for(h=0;P>h;++h)(f=w.measureTextWidth(l(h)))>L&&(L=f),V+=C=B,M.push(C),D&&((f=w.measureTextWidth(s(h)))>E&&(E=f));if(r=L+4,E>0&&(r+=E+4),0>=R&&(R=1,V>e.Height()))for(f=0,h=0;P>h;++h)f>I&&(R++,f=M[h]);if(I<M[0])return 0;for(h=0,f=0;R>f;f++)for(C=I;P>h&&C>M[h];)C-=M[h++];for((i=P>h)&&(f=P,A&&(h--,f--),M.splice(h,f-h)),f=M.length,C=R,T=Math.ceil(f/R),k=q(R,0),A&&(k[R-1]=T,f-=T,--C>0&&(T=Math.ceil(f/C))),h=0;C>h;h++)k[h]=Math.min(T,f),f-=k[h];for(C=0,h=0,f=0;R>f;f++){for(T=0,p=0;p<k[f];p++)T+=M[h++];T>C&&(C=T)}for(V=Math.min(e.Height(),C+8),(b=(x=4+N+4+r)*R+4)>2*e.Width()/3&&(L-=(C=x)-(x=((b=2*e.Width()/3)-4)/R)),f=e.right-b,C=(e.top+e.bottom-V)/2,S=new g(f,C,f+b,C+V),w.rectangle2(S),f=S.left+4,C=x-4,f+=(v=new g(f,0,f+N,0)).Width()+4,C-=v.Width()+4,f+=(y=new g(f,S.top+4,f+Math.min(C,L+4),0)).Width()+4,C-=y.Width()+4,F=new g(f,0,f+C,0),f=M.length-1,A&&f--,C=0,h=0;R>h;h++){for(y.top=S.top+4,p=0;p<k[h];++p)y.bottom=y.top+M[C],T=(y.top+y.bottom-t.fontHeight)/2,i&&f===C?w.drawText("... ...",v.left,T):(v.top=(y.top+y.bottom-N)/2,v.bottom=v.top+N,(c=A&&C===M.length-1)?C=P-1:d(C,v),w.drawText(l(C),y.left,T),D&&w.drawTextAlign(s(C),F.left,T,F.Width(),t.fontHeight,20),c&&(w.selectPen(new m(.5,0,0)),w.DrawHorzLine(y.top,v.left,F.right),w.restorePen())),t.toUpdateShapes&&(L=u(C),t.shapesL.push(new Ft(L.series,L.group,new g(v.left,v.top,F.right,v.bottom)))),y.top+=M[C++];v.left+=x,v.right+=x,y.left+=x,y.right+=x,F.left+=x,F.right+=x}return b}(c),c.right-=h+8)}(n),n.Title&&(u.selectFont(n.getUsingTitleFont()),u.drawTextCenter(n.Title,(c.left+c.right)/2,c.top+4),u.restoreFont()),c.top+=T,c.IsRectEmpty()||(2===n.Series.items[0].ChartType?n.DrawPie(c):n.IsHorzGraph()?function(e){var t,r,o,i,l,s,c,m,T=n.Series.items,x=p.CalcLabelHeight(),b=p.CalcVertAxisWidth(),S=f.CalcLabelHeight(),v=f.CalcHorzAxisHeight(!1),y=C.CalcLabelHeight(),F=C.CalcHorzAxisHeight(!1),w=0,D=0,A=!1;for(r=T.length,t=0;r>t;t++)if((o=T[t]).LabelTextBuilder&&!o.LabelInBar){A=!0;break}if(A&&(u.selectFont(n.getUsingValueFont()),w=u.measureTextWidth(o.ValueFormatParser.format(a)),n.IsDrawNegativeGraph()&&(D=w),u.restoreFont()),l=new g(e.left+x+b+D,e.top+S+v,e.right-w,e.bottom-y-F),c=new g(l.left,e.top,l.right,e.top+S),f.DrawHorzAxisLabel(c),m=new g(c.left,e.bottom-y,c.right,e.bottom),C.DrawHorzAxisLabel(m),c.top=c.bottom,c.bottom+=v,f.DrawHorzAxis(c,l,!0),m.bottom=m.top,m.top-=F,C.DrawHorzAxis(m,l,!1),s=new g(e.left,l.top,e.left+x,l.bottom),p.DrawVertAxisLabel(s),s.left=s.right,s.right+=b,n.Chart3D&&p.DrawVertAxis(s,l,!1,f.Used),!l.IsRectEmpty()&&n.GroupCount){for(u.selectFont(n.getUsingValueFont()),r=d.length,t=0;r>t;t++)switch(o=d[t],i=h[o[0]].ChartType){case 11:n.DrawColumnBar(o,l);break;case 12:case 13:n.DrawStackedColumnBar(o,i,l)}u.restoreFont()}!n.Chart3D&&p.DrawVertAxis(s,l,!1)}(c):function(e){var t,r,o,i,l,s,c,m,T=n.Series.items,x=p.CalcLabelHeight(),b=p.CalcHorzAxisHeight(!1),S=f.CalcLabelHeight(),v=f.CalcVertAxisWidth(),y=C.CalcLabelHeight(),F=C.CalcVertAxisWidth(),w=0,D=0,A=!1;for(r=T.length,t=0;r>t;t++)if((o=T[t]).LabelTextBuilder&&!o.LabelInBar){A=!0;break}if(!A&&n.Title||(w=B(n.getUsingValueFont())/(o.LabelTextBuilder?1:2),n.IsDrawNegativeGraph()&&(D=w),o.LabelTextAngle&&(u.selectFont(n.getUsingValueFont()),w=Math.max(Math.abs(u.measureTextWidth(o.ValueFormatParser.format(a))*Math.sin(ie(o.LabelTextAngle))),w),u.restoreFont())),l=new g(e.left+S+v,e.top+w,e.right-y-F,e.bottom-x-b-D),c=new g(e.left,e.top+w,e.left+S,e.bottom-x-b-D),f.DrawVertAxisLabel(c),m=new g(e.right-y,c.top,e.right,c.bottom),C.DrawVertAxisLabel(m),c.left=c.right,c.right+=v,f.DrawVertAxis(c,l,!1),m.right=m.left,m.left-=F,C.DrawVertAxis(m,l,!0),s=new g(e.left+S+v,e.bottom-x,e.right-y-F,e.bottom),p.DrawHorzAxisLabel(s),n.IsDrawNegativeGraph()?(s.top=c.bottom-f.CalcValuePos(0,c.Height()),s.bottom=s.top+b):(s.top=l.bottom,s.bottom=s.top+b),n.Chart3D&&p.DrawHorzAxis(s,l,!1),!l.IsRectEmpty()&&(n.IsScatterGraph()||n.GroupCount)){for(u.selectFont(n.getUsingValueFont()),r=d.length,t=0;r>t;t++)switch(o=d[t],i=h[o[0]].ChartType){case 1:n.DrawBar(o,l);break;case 4:case 10:n.DrawStackedBar(o,i,l);break;case 3:case 7:n.DrawLine(o,i,l);break;case 9:n.DrawBubble(o,l);break;default:n.DrawXYScatterGraph(o,i,l)}u.restoreFont()}!n.Chart3D&&p.DrawHorzAxis(s,l,!1)}(c)),u.restoreFillStyle(),u.restoreFont()},DrawPie:function(e){var t,r,o,a,n=this,i=n.context,l=0,s=0,u=e.Height(),c=e.Width(),d=c*u,h=Number.MAX_VALUE,p=-1,f=-1;for(t=0;t<n.GroupCount;t++){for(r=0;r<n.SeriesCount;r++)i.selectFont(n.getUsingValueFont()),n.graphSerieses[r].LabelTextBuilder&&(l=Math.max(l,i.measureTextWidth(n.GetDrawValueText(r,t)))),i.restoreFont();s=Math.max(s,i.measureTextWidth(n.GroupLabel(t)))}for(t=1;t<=n.GroupCount;t++)r=Math.floor((n.GroupCount+t-1)/t),h>(o=d-(o=Math.min(c/r,u/t))*o*n.GroupCount)&&(h=o,p=r,f=t);for(i.selectFont(n.getUsingValueFont()),o=0;o<n.GroupCount;o++)t=Math.floor(o/p),r=o%p,a=new g(e.left+c*r/p,e.top+u*t/f,e.left+c*(r+1)/p,e.top+u*(t+1)/f),n.Chart3DReal?i.drawTextCenter("三维饼图暂不支持!!!",(a.left+a.right)/2,(a.top+a.bottom-16)/2):n.DrawOne2DPie(o,a,l,s);i.restoreFont()},DrawOne2DPie:function(e,t,r){var o,a,n,i,l,s,u=this,c=u.context,d=u.fontHeight,h=u.valueFontHeight,p=!1,f=u.SeriesCount,m=0,C=[];for(o=0;f>o;o++)m+=u.Value(o,e),u.graphSerieses[o].LabelTextBuilder&&(p=!0);if(!(0>=m||(n=t.Width()-2*r-8,i=t.Height()-d-2*h-8,0>=n||0>=i||(a=Math.min(n,i)/2,p?t.InflateRect(-4,-4):t.InflateRect(a-n/2,a-i/2),t.bottom-=d,t.IsRectEmpty())))){for(u.DrawLabelText(u.GroupLabel(e),(t.left+t.right)/2,t.bottom),n=(t.left+t.right)/2,i=(t.top+t.bottom)/2,l=0,o=0;f>o;o++)s=l+360*u.Value(o,e)/m,u.toUpdateShapes&&u.shapes.push(new wt(o,e,n,i,a,l,s)),c.selectFillColor(u.GetGraphFillColor(o)),c.pie(n,i,a,l,s,1),c.restoreFillStyle(),p&&C.push((l+s)/2),l=s;p&&function(){var r,p,m,T,x,b,S=u.getUsingValueFont(),v=S.Italic?d(S):0,y=new g(0,0,0,0);for(s=0,o=0;f>o;o++)l=ie(C[o]),p=n+Math.cos(l)*a,m=i-Math.sin(l)*a,b=u.GetDrawValueText(o,e),x=c.measureTextWidth(b)+v,r=new g(p,m,p+x,m+h),l<Math.PI/2?(r.OffsetRect(2,-h),1===s&&r.top<y.bottom&&(T=y.right-r.left+2,r.right+T<t.right?r.OffsetRect(T,0):r.OffsetRect(0,y.bottom-r.top),c.drawLine(p,m,r.left,r.bottom-x.cy/3)),s=1):l<Math.PI?(r.OffsetRect(-x-2,-h),2===s&&r.top<y.bottom&&(T=r.right-y.left+2,r.left-T>t.left?r.OffsetRect(-T,0):r.OffsetRect(0,y.bottom-r.top),c.drawLine(p,m,r.right,r.bottom-x.cy/3)),s=2):l<1.5*Math.PI?(r.OffsetRect(-x-2,0),3===s&&r.bottom>y.top&&(T=r.right-y.left+2,r.left-T>t.left?r.OffsetRect(-T,0):r.OffsetRect(0,r.bottom-y.top),c.drawLine(p,m,r.right,r.top+x.cy/3)),s=3):(r.OffsetRect(2,0),4===s&&r.bottom>y.top&&(T=y.right-r.left+2,r.right-T<t.right?r.OffsetRect(T,0):r.OffsetRect(0,r.bottom-y.top),c.drawLine(p,m,r.left,r.top+x.cy/3)),s=4),u.DrawLabelText(b,(r.left+r.right)/2,r.top),y=r}()}},DrawColumnBar:function(e,t){var r,o,a,n,i,l,s,u,c,d,h,p,f,m=this,C=m.context,T=m.graphSerieses,x=m.CalcColumnBarCount(),b=m.CalcFirtColumnBarIndex(e),S=t.Width()-m.xView3DDepth,v=t.Height()-m.yView3DDepth,y=m.IsDrawNegativeGraph()?m.YAxis.CalcValuePos(0,S):t.left+1,F=e.length,w=m.IsDrawNegativeGraph(),D=[];for(n=0;n<m.GroupCount;n++)for(c=(u=m.XAxis.CalcGroupPos(v,n)).EndPos-u.BeginPos,r=t.top+u.BeginPos,m.Y2Axis.Used&&(r+=m.yView3DDepth),o=F;o-- >0;)l=T[i=e[o]],a=m.Value(i,n),(d=m.AbsNegativeValue&&0>a)&&(a=-a),f=new g(0,r+c*(b+o)/x,0,r+c*(b+o+1)/x),p=m.YAxisOfSeries(l).CalcValuePos(a,S),w?(f.left=t.left+y,f.right=Math.min(t.left+p,t.right),y>p&&(p=f.left,f.left=f.right,f.right=p)):(f.left=t.left,f.right=Math.min(t.left+Math.max(0,p),t.right)),D.push(f),m.toUpdateShapes&&m.shapes.push(new Ft(i,n,f)),h=d?m.NegativeBarColor:m.GetGraphFillColor(m.IsColorSingleBar()?n:i),m.DrawRectBar(f,h,l.BorderPen,!0,!0,a>=0);for(n=0;n<m.GroupCount;n++)if((l=T[e[0]]).LabelAsGroup){for(s=m.GetDrawValueText(e[0],n),p=-9999,o=0;F>o;o++)p<(f=D[n*F+o]).right&&(p=f.right);m.DrawValueText(l,s,p+4+C.measureTextWidth(s)/2,(D[n*F].top+D[n*F+F-1].bottom+m.valueFontHeight)/2)}else for(o=0;F>o;o++)(l=T[i=e[o]]).LabelTextBuilder&&(s=m.GetDrawValueText(i,n),f=D[n*F+o],l.LabelInBar?m.DrawHorzBarText(s,f):m.DrawValueText(l,s,f.right+4+C.measureTextWidth(s)/2,(f.top+f.bottom+m.valueFontHeight)/2))},DrawStackedColumnBar:function(e,t,r){var o,a,n,i,l,s,u,c,d,h,p,f,m,C,T=this,x=T.context,b=T.graphSerieses,S=T.CalcColumnBarCount(),v=T.CalcFirtColumnBarIndex(e),y=r.Width()-T.xView3DDepth,F=r.Height()-T.yView3DDepth,w=e.length,D=[];for(n=0;n<T.GroupCount;n++){for(u=(s=T.XAxis.CalcGroupPos(F,n)).EndPos-s.BeginPos,d=r.top+s.BeginPos,T.Y2Axis.Used&&(d+=T.yView3DDepth),f=d+u*v/S,m=d+u*(v+1)/S,h=r.left,o=0;w>o;o++)l=b[i=e[o]],a=T.Value(i,n),13===t&&(a*=100/T.CalcGroupTotalValue(e,n)),p=Math.max(0,T.YAxisOfSeries(l).CalcValuePos(a,y)),C=new g(h,f,Math.min(r.right,h+p),m),D.push(C),T.toUpdateShapes&&T.shapes.push(new Ft(i,n,C)),c=T.GetGraphFillColor(i),T.DrawRectBar(C,c,l.BorderPen,!0,o===w-1,!0),h+=p;if(l.LabelInBar)for(o=0;w>o;o++)(l=b[i=e[o]]).LabelTextBuilder&&T.DrawHorzBarText(T.GetDrawValueText(i,n),D[n*w+o]);else l=b[i=e[0]],a=T.GetDrawValueText(i,n),T.DrawValueText(l,a,h+4+x.measureTextWidth(a)/2,(f+m+T.valueFontHeight)/2)}},DrawBar:function(e,t){var r,o,a,n,i,l,s,u,c,d,h,p,f,m=this,C=m.graphSerieses,T=m.CalcBarCount(),x=m.CalcFirtBarIndex(e),b=m.IsDrawNegativeGraph(),S=t.Height()-m.yView3DDepth,v=b?m.YAxis.CalcValuePos(0,S):t.bottom+1,y=e.length,F=[];for(n=0;n<m.GroupCount;n++)for(c=(u=m.XAxis.CalcGroupPos(t.Width()-m.xView3DDepth,n)).EndPos-u.BeginPos,a=x,r=0;y>r;r++)l=C[i=e[r]],o=m.Value(i,n),(d=m.AbsNegativeValue&&0>o)&&(o=-o),f=new g(t.left+u.BeginPos+c*a/T,0,t.left+u.BeginPos+c*(a+1)/T,0),p=m.YAxisOfSeries(l).CalcValuePos(o,S),b?(f.top=Math.max(t.bottom-p,t.top),f.bottom=t.bottom-v,v>p&&(p=f.top,f.top=f.bottom,f.bottom=p)):(f.top=t.bottom-p,f.bottom=t.bottom),F.push(f),m.toUpdateShapes&&m.shapes.push(new Ft(i,n,f)),h=d?m.NegativeBarColor:m.GetGraphFillColor(m.IsColorSingleBar()?n:i),m.DrawRectBar(f,h,l.BorderPen,!1,!0,o>=0),++a;for(n=0;n<m.GroupCount;n++)if((l=C[i=e[0]]).LabelAsGroup){for(s=m.GetDrawValueText(i,n),p=9999,r=0;y>r;r++)p>(f=F[n*y+r]).top&&(p=f.top);m.DrawValueText(l,s,(F[n*y].left+F[n*y+y-1].right+m.xView3DDepth)/2,p-2-m.yView3DDepth)}else for(r=0;y>r;r++)(l=C[i=e[r]]).LabelTextBuilder&&(s=m.GetDrawValueText(i,n),f=F[n*y+r],l.LabelInBar?m.DrawVertBarText(s,f):(p=f.top-2-m.yView3DDepth,m.IsDrawNegativeGraph()&&t.bottom-v<f.bottom&&(p=f.bottom+m.valueFontHeight),m.DrawValueText(l,s,(f.left+f.right+m.xView3DDepth)/2,p)))},DrawStackedBar:function(e,t,r){var o,a,n,i,l,s,u,c,d,h,p,f,m,C=this,T=C.graphSerieses,x=C.CalcBarCount(),b=C.CalcFirtBarIndex(e),S=r.Width()-C.xView3DDepth,v=r.Height()-C.yView3DDepth,y=e.length,F=[];for(n=0;n<C.GroupCount;n++){for(u=(s=C.XAxis.CalcGroupPos(S,n)).EndPos-s.BeginPos,h=r.left+s.BeginPos+u*b/x,p=r.left+s.BeginPos+u*(b+1)/x,f=r.bottom,o=0;y>o;o++)l=T[i=e[o]],a=C.Value(i,n),10===t&&(a*=100/C.CalcGroupTotalValue(e,n)),d=C.YAxisOfSeries(l).CalcValuePos(a,v),m=new g(h,Math.min(Math.max(f-d,r.top),f),p,f),F.push(m),C.toUpdateShapes&&C.shapes.push(new Ft(i,n,m)),c=C.GetGraphFillColor(i),C.DrawRectBar(m,c,l.BorderPen,!1,o===y-1,!0),f-=d;if(l.LabelInBar)for(o=0;y>o;o++)(l=T[i=e[o]]).LabelTextBuilder&&C.DrawVertBarText(C.GetDrawValueText(i,n),F[n*y+o]);else l=T[i=e[0]],C.DrawValueText(l,C.GetDrawValueText(i,n),(h+p+C.xView3DDepth)/2,f-2-C.yView3DDepth)}},DrawRectBar:function(e,t,r,o,a,n){function i(e,t){s.selectFillColor(e),s.selectPen(new m(1,e,1)),s.drawPolyLine(t,1,1),s.restorePen(),s.restoreFillStyle()}var l=this,s=l.context,u=Y(t),c=j(t),d=[];l.Chart3DReal&&(d.length=8,d[0]=e.right-1,d[1]=e.top,d[2]=d[0]+l.xView3DDepth,d[3]=d[1]-l.yView3DDepth,(a||o)&&(d[4]=d[2]-e.Width(),d[5]=d[3],d[6]=e.left,d[7]=d[1],i(u,d)),!a&&o||(d[4]=d[2],d[5]=e.bottom-l.yView3DDepth,d[6]=e.right-1,d[7]=e.bottom,i(c,d))),l.Chart3DReal?(s.selectFillColor(t),s.rectangle2(e,1),s.restoreFillStyle()):s.drawBar(e,r,t,o?n?1:3:n?0:2)},DrawLine:function(e,t,r){var o,a,n,i,l,s,u,c,d=this,h=d.context,p=e.length,f=[];for(o=0;p>o;o++)f.push([]);for(a=0;a<d.GroupCount;a++)for(u=r.left+d.XAxis.CalcGroupPos(r.Width()-d.xView3DDepth,a).LabelMiddlePos,o=0;p>o;o++){n=e[o],i=d.graphSerieses[n];var g={x:u,y:r.bottom-d.YAxisOfSeries(i).CalcValuePos(d.Value(n,a),r.Height())};f[o].push(g),d.toUpdateShapes&&d.shapes.push(new Dt(n,a,g.x,g.y,i.MarkerSize))}for(o=0;p>o;o++)(7===t?d.DrawCurveLine:d.DrawPolyLine).call(d,f[o],e[o]);for(o=0;p>o;o++)d.DrawPointsMarker(f[o],e[o]);for(a=0;a<d.GroupCount;a++)for(o=0;p>o;o++)n=e[o],(i=d.graphSerieses[n]).LabelTextBuilder&&(c=r.bottom-d.YAxisOfSeries(i).CalcValuePos(d.Value(n,a),r.Height()),-1!==i.MarkerStyle&&(c-=i.MarkerSize/2),l=d.GetDrawValueText(n,a),s=h.measureTextWidth(l),u=f[o][a].x+s/2,d.GroupCount>1&&(u-=s*a/(d.GroupCount-1)),d.DrawValueText(i,l,u,c))},DrawBubble:function(e,t){var r,o,a,n,i,l,s,u,c,d=this,h=e.length,p=[],f=[];for(r=0;h>r;r++)for(n=e[r],i=d.graphSerieses[n],u=[],c=[],p.push(u),f.push(c),s=d.ValueCount(n),a=0;s>a;a++){o=d.Value(n,a),l=Math.sqrt(o.z/d.DrawBubbleScalePerCm)*xt/2;var g={x:t.left+d.XAxis.CalcValuePos(o.x,t.Width()),y:t.bottom-d.YAxisOfSeries(i).CalcValuePos(o.y,t.Height())};u.push(g),c.push(l),d.toUpdateShapes&&d.shapes.push(new Dt(n,a,g.x,g.y,l)),i.LabelTextBuilder&&d.DrawValueText(i,d.GetDrawValueText(n,a),g.x,g.y-l)}for(r=0;h>r;r++)n=e[r],d.DrawPointsMarker(p[n],n,f[n])},DrawXYScatterGraph:function(e,t,r){var o,a,n,i,l,s,u,c=this,d=e.length,h=[];for(o=0;d>o;o++)for(i=e[o],l=c.graphSerieses[i],u=[],h.push(u),s=c.ValueCount(i),n=0;s>n;n++){a=c.Value(i,n);var p={x:r.left+c.XAxis.CalcValuePos(a.x,r.Width()),y:r.bottom-c.YAxisOfSeries(l).CalcValuePos(a.y,r.Height())};u.push(p),c.toUpdateShapes&&c.shapes.push(new Dt(i,n,p.x,p.y,l.MarkerSize)),l.LabelTextBuilder&&c.DrawValueText(l,c.GetDrawValueText(i,n),p.x,p.y-l.MarkerSize)}if(6===t||8===t)for(o=0;d>o;o++)i=e[o],l=c.graphSerieses[i],(8===t?c.DrawCurveLine:c.DrawPolyLine).call(c,h[i],i);for(o=0;d>o;o++)i=e[o],c.DrawPointsMarker(h[i],i)},DrawPolyLine:function(e,t){var r,o,a=this,n=a.context,i=e.length,l=[];for(r=0;i>r;r++)l.push(e[r].x,e[r].y);(o=a.graphSerieses[t].BorderPen.clone()).Color=a.GetGraphFillColor(t),n.selectPen(o),n.drawPolyLine(l),n.restorePen()},DrawCurveLine:function(e,t){function r(e,t,r){var o=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),a=Math.sqrt(Math.pow(r.x-t.x,2)+Math.pow(r.y-t.y,2)),n=o+a,i=n>0?.4*o/n:1,l=n>0?.4*a/n:1;return{inner:{x:t.x-i*(r.x-e.x),y:t.y-i*(r.y-e.y)},outer:{x:t.x+l*(r.x-e.x),y:t.y+l*(r.y-e.y)}}}var o,a,n,i,l=this,s=l.context,u=e.length,c=[];if(u>1){for(i=r(n=e[0],n,e[1]),c.push(n,i.outer),o=1;u-1>o;o++)n=e[o],i=r(e[o-1],n,e[o+1]),c.push(i.inner,n,i.outer);n=e[o],i=r(e[o-1],n,n),c.push(i.inner,n),(a=l.graphSerieses[t].BorderPen.clone()).Color=l.GetGraphFillColor(t),s.selectPen(a),s.polyBezier(c),s.restorePen()}},DrawPointsMarker:function(e,r,o){var a,n=this,i=n.context,l=n.graphSerieses[r],s=e.length;if(-1!==l.MarkerStyle)for(a=0;s>a;a++)i.DrawPointMarker(t(e[a].x,e[a].y,o?o[a]:l.MarkerSize),l.MarkerStyle,l.MarkerPen,l.MarkerColorAuto?n.GetGraphFillColor(r):l.MarkerColor)},DrawValueText:function(e,t,r,o){var a,n=this.context,i=this.valueFontHeight;e.LabelTextAngle?(a=ie(e.LabelTextAngle),r-=(n.measureTextWidth(t)*Math.cos(a)+Math.abs(i*Math.sin(a)))/2,o-=Math.abs(i*Math.cos(a)),n.drawTextRotate(t,r,o,e.LabelTextAngle)):n.drawTextCenter(t,r,o-i)},DrawLabelText:function(e,t,r){this.context.drawTextCenter(e,t,r)},DrawVertBarText:function(e,t){var r=this.context;r.drawTextRotate(e,(t.left+t.right-this.fontHeight)/2,(t.top+t.bottom+r.measureTextWidth(e))/2,90)},DrawHorzBarText:function(e,t){var r=this.context,o=r.measureTextWidth(e),a=this.fontHeight,n=(t.left+t.right-o)/2,i=(t.top+t.bottom-a)/2;r.drawText(e,n,i)},CalcBarCount:function(){var e,t,r,o=this,a=o.graphs.length,n=0;for(e=0;a>e;e++)t=o.graphs[e],1===(r=o.graphSerieses[t[0]].ChartType)?n+=t.length:4!==r&&10!==r||n++;return n},CalcColumnBarCount:function(){var e,t,r,o=this,a=o.graphs.length,n=0;for(e=0;a>e;e++)t=o.graphs[e],11===(r=o.graphSerieses[t[0]].ChartType)?n+=t.length:12!==r&&13!==r||n++;return n},CalcFirtBarIndex:function(e){var t,r,o,a=this.graphs,n=a.length,i=0;for(t=0;n>t&&(r=a[t])!==e;t++)1===(o=this.graphSerieses[r[0]].ChartType)?i+=r.length:4!==o&&10!==o||++i;return i},CalcFirtColumnBarIndex:function(e){var t,r,o,a=this.graphs,n=a.length,i=0;for(t=0;n>t&&(r=a[t])!==e;t++)11===(o=this.graphSerieses[r[0]].ChartType)?i+=r.length:12!==o&&13!==o||++i;return i},CalcGroupTotalValue:function(e,t){var r,o=e.length,a=0;for(r=0;o>r;r++)a+=this.Value(e[r],t);return a},IsScatterGraph:function(){return this.Series.items[0].IsScatterGraph()},IsHorzGraph:function(){return this.Series.items[0].IsHorzGraph()},IsColorSingleBar:function(){return 1==this.SeriesCount&&this.SingleSeriesColored},IsDrawNegativeGraph:function(){var e=this;return!e.Series.items.some((function(e){return e.ByY2Axis}))&&e.YAxis.DrawMax>=0&&e.YAxis.DrawMin<0&&!e.AbsNegativeValue},Support3D:function(){return this.Series.items.every((function(e){return e.Support3D()}))},YAxisOfSeries:function(e){return e.ByY2Axis?this.Y2Axis:this.YAxis},getSeriesShowLabel:function(e){var t=this;return t.SeriesLabels[e]||(t.graphSerieses[e]?t.graphSerieses[e].SeriesName:"")},getUsingTitleFont:function(){return this.TitleFont.UsingFont()},getUsingValueFont:function(){return this.ValueFont.UsingFont()},GetGraphFillColor:function(e){var t,r,o,a,n=this,i=n.graphSerieses[e],l=n.FillColors?n.FillColors.length:St;return n.IsColorSingleBar()||i.FillColorAuto?(t=Math.floor(e/l),r=e%l,o=n.FillColors?n.FillColors[r]:z(bt[r],n.report.viewer.alpha.chartGraph),t>0&&(a=J(o),o=U((a.r+73*r+196*t)%255,(a.g+197*r+120*t)%255,(a.b+117*r+90*t)%255,a.a)),o):i.FillColor},GetSeriesIndexByLabel:function(e,t){var r=this.SeriesLabels.indexOf(e);return 0>r&&t&&(r=+e,(!isNaN(r)||r>=this.SeriesCount)&&(r=-1)),r},GetGroupIndexByLabel:function(e,t){var r=this.GroupLabels.indexOf(e);return 0>r&&t&&(r=+e,(!isNaN(r)||r>=this.GroupCount)&&(r=-1)),r},GetDrawValueText:function(e,t){var r=this.graphSerieses[e];return r.LabelTextBuilder?r.LabelTextBuilder.generateChartDisplayText(e,t):""},GetGroupTotalValue:function(e,t){var r,o=e.length,a=0;if(!this.IsScatterGraph())for(r=0;o>r;r++)a+=this.Value(e[r],t);return a},GetSeriesTotalValue:function(e){var t,r,o=this,a=0;if(o.IsScatterGraph())for(r=o.ValueCount(e),t=0;r>t;t++)a+=o.Value(e,t).z;else for(t=0;t<o.GroupCount;t++)a+=o.Value(e,t);return a},GetTotalValue:function(){var e,t=0;for(e=0;e<this.SeriesCount;e++)t+=this.GetSeriesTotalValue(e);return t},prepareValues:function(){for(var e=this,t=e.values.length;t++<e.SeriesCount;)e.values.push([])},get AsChart(){return this},GroupLabel:function(e){return this.GroupLabels[e]},SetGroupLabel:function(e,t){this.GroupLabels[e]=t},SeriesLabel:function(e){return this.SeriesLabels[e]},SetSeriesLabel:function(e,t){this.SeriesLabels[e]=t},Value:function(t,r){var o;return this.prepareValues(),(o=this.values[t][r])===e&&(o=0),o},SetValue:function(e,t,r){this.prepareValues(),this.values[e][t]=r},ValueCount:function(e){return this.prepareValues(),this.values[e].length},get FillColorCount(){return this.FillColors?this.FillColors.length:0},getFillColor:function(t){return this.FillColors?this.FillColors[t]:e},AddFillColor:function(e){var t=this;t.FillColors||(t.FillColors=[]),t.FillColors.push(e)},EmptyFillColors:function(){delete self.FillColors},LoadDataFromXML:function(e,t,r,o){function a(){return i.textContent}var n,i,l,s,u,c=this,d=ee(e);if(!dom)return 0;for(o&&(c.GroupCount=0,c.GroupLabels=[]),r&&(c.SeriesCount=0,c.SeriesLabels=[]),c.values=[],n=d.childNodes[0].firstChild,nodeText=n.hasOwnProperty("text");n;){if(i=n.firstChild,t&&(l=a(),i=i.nextSibling,0>(s=c.GetSeriesIndexByLabel(l,!r))&&r&&(s=c.SeriesCount,c.SeriesCount++,c.SeriesLabels.push(l)),0>s))throw 0;if(l=a(),i=i.nextSibling,0>(u=c.GetGroupIndexByLabel(l,!o))&&o&&(u=c.GroupCount,c.GroupCount++,c.GroupLabels.push(l)),0>u)throw 0;if(t)c.SetValue(s,u,+a()+c.Value(s,u));else for(s=0;i;)c.SetValue(s,u,+a()+c.Value(s,u)),s++,i=i.nextSibling;n=n.nextSibling}return 1},DoLoadXYZDataFromXML:function(e,t,r){function o(){return n.textContent}var a,n,i,l,s,u,c,d=this,h=ee(e);if(!dom)return 0;for(t&&(d.SeriesCount=0,d.SeriesLabels=[]),d.values=[],a=h.childNodes[0].firstChild,nodeText=a.hasOwnProperty("text");a;){if(n=a.firstChild,FirstSeries?(i=o(),0>(c=d.GetSeriesIndexByLabel(i,!t))&&t&&(c=m_SeriesCount,++m_SeriesCount,m_SeriesLabels[c]=i),n=n.nextSibling):c=0,0>c)throw 0;l=+o(),n=n.nextSibling,s=+o(),r||(n=n.nextSibling,u=+o()),d.AddXYZValue(c,l,s,u),a=a.nextSibling}return 1},LoadXYDataFromXML:function(e,t){return this.DoLoadXYZDataFromXML(e,t,1)},LoadXYZDataFromXML:function(e,t){return DoLoadXYZDataFromXML(e,t,0)},AddXYZValue:function(e,t,r,o){this.prepareValues(),this.values[e].push({x:t,y:r,z:o})},EmptyValues:function(){this.values=[],this.prepareValues()}},Z(Rt,Ie),gr.dom.Report=at}(),function(e,t){var r=gr.helper,o=gr.common,a=gr.const_,n=r.penStyleText,i=r.fontCSSText,l=r.pixelsToHtml,s=r.colorValue2Html,u=r.assignObject,c=r.compareObject,d=r.parseXML,h=r.xmlToReportDataJSON,p=r.addEvent,f=o.HtmlStyles,g=function(e){var t,r,o=this;o.obj=e,e.FreeCell?e.isSingleDockControl()&&((r=e.Controls.items[0]).TextFormat&&(o.TextFormat={},o.TextFormat.ForeColor=r.ForeColor,u(o.TextFormat,r.TextFormat)),(t=o.padding={}).Left=r.PaddingLeft,t.Right=r.PaddingRight,t.Top=r.PaddingTop,t.Bottom=r.PaddingBottom):(o.TextFormat={},u(o.TextFormat,e.TextFormat),o.TextFormat.ForeColor=e.ForeColor,(t=o.padding={}).Left=e.PaddingLeft,t.Right=e.PaddingRight,t.Top=e.PaddingTop,t.Bottom=e.PaddingBottom),e.BorderCustom?(o.border={},u(o.border,e.Border)):o.ownerGrid=e.getOwnerGrid(),o.toFillBack=e.toFillBack(),o.toFillBack&&(o.BackColor=e.BackColor)};g.prototype={compare:function(e){var t=this,r=new g(e);return c(t.padding,r.padding)&&c(t.TextFormat,r.TextFormat)&&c(t.border,r.border)&&t.toFillBack===r.toFillBack&&t.BackColor===r.BackColor&&t.ownerGrid===r.ownerGrid},getStyleName:function(){return"-gr-cell"+this.index},getStyles:function(){var e=this,t=new f;return e.TextFormat&&(t.addTextFormat(e,1),t.addObjectPadding(e)),e.border?t.addBorder(e.border):t.addCellBorder(e.ownerGrid),e.toFillBack&&t.addBackColor(e.BackColor),t}};var m=function(e){var t=this,r=t.padding={},o=e.getUsingFont();t.obj=e,t.asCell=!!e.cell,e.TextFormat&&(t.TextFormat={},t.TextFormat.ForeColor=e.ForeColor,u(t.TextFormat,e.TextFormat)),r.Left=e.PaddingLeft,r.Right=e.PaddingRight,r.Top=e.PaddingTop,r.Bottom=e.PaddingBottom,t.border={},u(t.border,e.Border),t.toFillBack=e.toFillBack(),t.toFillBack&&(t.BackColor=e.BackColor),t.textdecoration={Underline:o.Underline,Strikethrough:o.Strikethrough}};m.prototype={compare:function(e){var t=this,r=new m(e);return c(t.padding,r.padding)&&c(t.TextFormat,r.TextFormat)&&c(t.border,r.border)&&c(t.textdecoration,r.textdecoration)&&t.toFillBack===r.toFillBack&&t.BackColor===r.BackColor&&t.asCell===r.asCell},getStyleName:function(){return"-gr-ctrl"+this.index},getStyles:function(){var e=this,t=new f,r=e.textdecoration;return!e.asCell&&t.add("position","absolute"),t.addObjectPadding(e),t.addBorder(e.border),e.TextFormat&&t.addTextFormat(e,e.asCell),e.toFillBack&&t.addBackColor(e.BackColor),(r.Underline||r.Strikethrough)&&t.add("text-decoration",(r.Underline?"underline":"")+(r.Underline&&r.Strikethrough?" ":"")+(r.Strikethrough?"line-through":"")),t}};var C=function(e){var t=this;t.Left=e.pxRect.left,t.Top=e.pxRect.top,t.Width=e.getContentWidth(),t.Height=e.getContentHeight()};C.prototype={compare:function(e){var t=this;return t.Left===e.pxRect.left&&t.Top===e.pxRect.top&&t.Width===e.getContentWidth()&&t.Height===e.getContentHeight()},getStyleName:function(){return"-gr-pos"+this.index},getStyles:function(){var e=this,t=new f;return t.add("left",l(e.Left)),t.add("top",l(e.Top)),t.add("width",l(e.Width)),t.add("height",l(e.Height)),t}};var T=function(e){var t=this,r=e.cells?e:0;t.section=e,t.isLastRow=1,t.Height=e.CanShrink?0:e.pxHeight,r&&(e=r.section,t.isLastRow=e.tableRows[e.tableRows.length-1]===r),e.Font.font&&(t.Font={},u(t.Font,e.Font.font)),e.owner.Header&&(t.detailgrid=e.owner.owner),!e.toFillBack()||r&&!t.detailgrid||(t.BackColor=e.BackColor)};T.prototype={compare:function(e){var t,r,o=this,a=e.cells?e:0,n=e.CanShrink?0:e.pxHeight,i=1;return a&&(i=(e=e.section).tableRows[e.tableRows.length-1]===a),t=e.toFillBack()&&(!a||e.owner.Header),r=e.Font.font,o.Height===n&&(r&&o.Font&&c(r,o.Font)||!r&&!o.Font)&&(t&&o.BackColor&&o.BackColor===e.BackColor||!t&&!o.BackColor)&&(e.owner.Header&&e.owner.owner===o.detailgrid||!e.owner.Header&&!o.detailgrid)&&o.isLastRow===i},getStyleName:function(){return"-gr-section"+this.index},getStyles:function(){var e=this,t=e.section,r=t.pctHeight,o=e.Height,a=new f,i=e.detailgrid;return(r||o)&&a.add("height",r?r+"%":l(o)),(r||!t.cells&&t.report.viewer.options.reportFitWidth)&&a.add("width","100%"),e.Font&&(a.items=a.items.concat(x.prototype.getStyles.call(e.Font).items)),e.BackColor&&a.addBackColor(e.BackColor),e.isLastRow&&i&&i.ShowRowLine&&a.add("border-bottom",n(i.ColLinePen)),a}};var x=function(e){var t=this;t.Size=e.Size,t.Bold=e.Bold,t.Italic=e.Italic,t.Name=e.Name};x.prototype={compare:function(e){var t=this;return t.Size===e.Size&&t.Bold===e.Bold&&t.Italic===e.Italic&&t.Name===e.Name},getStyleName:function(){return"-gr-fs"+this.index},getStyles:function(){var e=new f;return e.add("font",i(this)),e}};var b=function(e){this.htmlStyles=e};b.prototype={getStyleName:function(){return"-gr-cs"+this.index},getStyles:function(){return this.htmlStyles}};var S=function(e,t){var r=this;r.items=[],r.viewer=e,r.classStyle=t};S.prototype={toString:function(){for(var e,t=this.items,r=t.length,o="";r-- >0;)e=t[r],o+="."+this.viewer._getCSSName(e)+"{"+e.getStyles().getText()+"}";return o},select:function(e,t){return this.viewer._getCSSName(this.selectItem(e,t))},selectItem:function(e,t){var r,o,a=this,n=a.items.length;if(t&&t.compare(e))return t;for(r=0;n>r;r++)if((o=a.items[r]).compare(e))return o;return(o=new a.classStyle(e)).index=n,a.items.push(o),o}};var v=function(e){var t,r=0,o=e.length;if("string"!=typeof e)return 0;for(;o>r&&(t=e[r],/\s/g.test(t));)r++;return o>r&&"{"!==t&&"<"!==t},y=function(e,t,r,o,a){var n=this;n.running=!1,n.generated=!1,n.events={},n.viewerNo=e,n.viewerHolderID=t,n.reportSource=r,n.dataSource=o,n.alpha={background:1,border:.8,stroke:.8,pen:.8,text:.8,chartGraph:0,chartStroke:1},n.options={controlPosition:gr.enum_.controlLayout.auto,reportFitWidth:!1,reportFitHeight:!1,detailgridResize:gr.enum_.detailgridResize.asDesign,singleChartFill:!0,fixedHeaderFooter:!1,fixedFitTo:"window",selectionHighlight:!0,selectionCell:!1,selectionTextColor:"rgba(255,255,255,1)",selectionBackColor:"rgba(20,20,127,1)",hoverEnabled:!0,hoverBackColor:"#eee",hoverTextColor:"#000"},n.attachOptions(a),n.report=new gr.dom.Report(n)};y.prototype={attachOptions:function(e){this.stop(),e&&u(this.options,e)},loadReport:function(e,r,o){var a,n=this,i=n.report,l=e;if(r=r||r===t,o=o||o===t){try{l.responseText!==t&&(l=l.responseText),n._rawReport=l,i.load(l),n.events.onReportLoaded&&n.events.onReportLoaded(n)}catch(s){o=0,a="解析报表模板"}o&&(n.reportPrepared=!0,r&&!n.waitData&&n.generate())}else a="获取报表模板";!o&&n.displayError(a,e,1)},loadData:function(e,r,o){var a,n=this,i=e;if(r=r||r===t,o=o||o===t){try{if(i.responseText!==t&&(i=i.responseText),n._rawData=i,"string"==typeof i)if(""===i)i={};else if("{"===i.charAt(0))i=JSON.parse(i);else{if(i=i.replace(/\r\n/g,""),!(i=d(i)))throw 0;i=h(i)}n.tables=i}catch(l){o=0,a="解析报表数据"}o&&(n.dataPrepared=!0,r&&n.generate())}else a="获取报表数据";!o&&n.displayError(a,e,0)},start:function(){var t=this;t.waitData&&(t.waitData=0),t.generated||t.running||(t.running=!0,t.events.onGenerateBegin&&t.events.onGenerateBegin(t),t.reportPrepared=t.reportPrepared||!t._rs,t.dataPrepared=t.dataPrepared||!t._ds,t.reportPrepared&&t.dataPrepared?(t.events.onReportLoaded&&t.events.onReportLoaded(t),!t.waitData&&t.generate()):(t.reportPrepared||(t._rs.url?e.rubylong.ajax(t._rs,(function(e,r){t.loadReport(e,1,r)}),t):t.loadReport(t._rs)),t.dataPrepared||(t._ds.url?e.rubylong.ajax(t._ds,(function(e,r){t.loadData(e,1,r)}),t):t.loadData(t._ds))))},stop:function(e,r){var o,a=this,n=a.report;return!a.running&&(a.generated&&(e||(n.Clear(),a.reportPrepared=!1,a._rawReport=t),r||(a.tables=t,a.dataPrepared=!1,a._rawData=t),a.viewerHolderID&&((o=document.getElementById(a.viewerHolderID))&&(o.innerHTML="")),n.unprepare(),a.generated=!1),!0)},update:function(){this.stop(1,1),this.generate()},generate:function(){var t,r,o=this,n=o.report,i=o.options.fixedFitTo,l=document.getElementById(o.viewerHolderID);if(o.stop(1,1),o.reportPrepared&&o.dataPrepared){try{if(l.innerHTML="",DEBUG&&(o.stylesText=""),o._detailgrids=[],o._domevents=[],o.html="",o.fontStyles=new S(o,x),o.controlStyles=new S(o,m),o.cellStyles=new S(o,g),o.sectionStyles=new S(o,T),o.positionStyles=new S(o,C),o.customStyles=new S(o,b),l.classList.add(o.selectFont2(n.Font.font)),16777215!==n.BackColor&&(l.style.backgroundColor=s(n.BackColor)),o.html=n.generateHtml(),o.generateStyles(),l.innerHTML=o.html,n.toFillHolder&&(l.style.height="100%"),n.singleChart&&(l.style.backgroundColor=s(n.singleChart.BackColor)),n.startCanvas(),n.fixedHeaderFooter&&function(){function t(t){var r=e.innerWidth-document.body.clientWidth;r||(r=16),a.setAttribute("style","max-height:"+(e.innerHeight-s-r)+"px")}var r=l.getElementsByClassName(o._getCSSName(o.fixedDivClass)),a=l.getElementsByClassName(o._getCSSName(o.bodyDivClass))[0],n=r[0],s=n?n.clientHeight:0,u=n.clientWidth-a.clientWidth;17!=u&&u>0&&(n&&n.setAttribute("style","padding-right:"+u+"px"),(n=r[1])&&n.setAttribute("style","padding-right:"+u+"px")),(n=r[1])&&(s+=n.clientHeight),"holder"==i?a.setAttribute("style","max-height:"+(l.clientHeight-s)+"px"):(p(e,"resize",t),t())}(),o._detailgrids.forEach((function(e,t){var r=document.getElementById(o._getDetailGridID(t));p(r,"mousedown",(function(t){e.onmousedown(t)}))})),n._has_cb)for(r=(t=document.querySelectorAll("."+a.CSS_CB)).length;r-- >0;)p(t[r],"click",(function(e){n.onCheckBoxClick(e)}));o._domevents.forEach((function(e,r){for(r=(t=document.querySelectorAll("."+o._getEventCSSName(r+1))).length;r-- >0;)if(1===e.type)p(t[r],"click",(function(t){e.fun(t,e.obj)}));else p(t[r],"dblclick",(function(t){e.fun(t,e.obj)}))})),DEBUG&&(document.getElementById("htmlText")&&(document.getElementById("htmlText").innerText=o.html),document.getElementById("stylesText")&&(document.getElementById("stylesText").innerText=o.stylesText))}catch(u){l.innerHTML="生成报表时发生异常错误!<br />Error Code: "+u.number+"<br />Error Name: "+u.name+"<br />Error Message: "+u.message}o.running=!1,o.generated=!0,o.events.onGenerateEnd&&o.events.onGenerateEnd(o)}},generateStyles:function(){function e(e){var t=">tbody>tr";e&&(t+=">td"),t+=":hover",s+="."+a.CSS_DG+t+(n?":not(."+a.CSS_SH+")":"")+" {background-color:"+o.hoverBackColor+";color:"+o.hoverTextColor+";}\n"}var t=this,r=t.report,o=t.options,n=o.selectionHighlight,i=a.ID_REPORT_STYLE+t.viewerNo,l=document.getElementById(i),s=r.toFillHolder?"html,body{height:100%;}\n*{margin:0;padding:0;}":"";l||((l=document.createElement("STYLE")).id=i,document.head.appendChild(l)),r._has_cb&&(s+="."+a.CSS_CB+"{}\n"),s+="."+a.CSS_DG+"{table-layout:fixed;}\n",o.hoverEnabled&&(e(0),e(1)),n&&(s+="."+a.CSS_SH+"{ background-color:"+o.selectionBackColor+";color:"+o.selectionTextColor+";}\n"),l.innerHTML=[t.fontStyles,t.positionStyles,t.sectionStyles,t.cellStyles,t.controlStyles,t.customStyles,t.getDomEventStyles(),s].join("")},getDomEventStyles:function(){for(var e=this._domevents.length,t="";e>0;)t+="."+this._getEventCSSName(e--)+"{}\n";return t},addCustomStyle:function(e){var t=this.customStyles.items,r=new b(e);return r.index=t.length,t.push(r),r},selectCell:function(e){return this.cellStyles.select(e,e.defaultStyle)},selectCellItem:function(e){return this.cellStyles.selectItem(e)},selectControl:function(e){return this.controlStyles.select(e,e.defaultStyle)},selectControlItem:function(e){return this.controlStyles.selectItem(e)},selectSection:function(e){return this.sectionStyles.select(e,e.defaultStyle)},selectSectionItem:function(e){return this.sectionStyles.selectItem(e)},selectPosition:function(e){return this.positionStyles.select(e,e.defaultPositionStyle)},selectPositionItem:function(e){return this.positionStyles.selectItem(e)},selectFont:function(e,t){return this.fontStyles.select(e,t)},selectFont2:function(e){return this._getCSSName(this.selectFontItem(e))},selectFontItem:function(e){return this.fontStyles.selectItem(e)},displayError:function(e,r,o){var n,i=this,l=r.responseText!==t,s=l?o?i._rs:i._ds:t,u=document.getElementById(i.viewerHolderID);n='<div style="background-color:#bbffbb"><h3>'+e+"失败，锐浪HTML5报表("+a.VERSION+")</h3>",s&&(n+='<div>URL: <a href="'+s.url+'">'+s.url+"</a></div>"),l?(n+="<div>HTTP Status: "+r.status+"</div><div>HTTP Status Text: "+r.statusText+"</div>",r.responseText&&(n+="<div>HTTP Response Text: <pre>"+r.responseText+"</pre></div>")):n+="string"==typeof r?"<div>Loaded Text: <pre>"+r+"</pre></div>":"<div>Loaded Json Object: <pre>"+JSON.stringify(r)+"</pre></div>",n+="</div>",u.innerHTML=n},_getEventCSSName:function(e){var t=this.viewerNo,r="_grec"+e;return t&&(r+="-"+t),r},_getCSSName:function(e){var t=this.viewerNo,r=e.getStyleName();return t&&(r+="-"+t),r},_getDetailGridID:function(e){var t=this.viewerNo,r=a.ID_DETAILGRID+e;return t&&(r+="-"+t),r},get reportURL(){var e=this._rs;return e?e.url:""},set reportURL(e){this._rs={},this._rs.url=e},get dataURL(){var e=this._ds;return e?e.url:""},set dataURL(e){this._ds={},this._ds.url=e},get reportSource(){return this._rs},set reportSource(e){var t=this;e&&(t._rs={},function(e){return"string"==typeof e&&"_WR_"==e.substr(0,4)?0:v(e)}(e)?t._rs.url=e:e.url?u(t._rs,e):t._rs=e)},get dataSource(){return this._ds},set dataSource(e){var t=this;e&&(t._ds={},v(e)?t._ds.url=e:e.url?u(t._ds,e):t._ds=e)},get reportText(){var e=this._rawReport;return"string"!=typeof e&&(e=JSON.stringify(e)),e},get dataText(){var e=this._rawData;return"string"!=typeof e&&(e=JSON.stringify(e)),e}},e.rubylong={grhtml5:{controlLayout:gr.enum_.controlLayout,detailgridResize:gr.enum_.detailgridResize,barcodeURL:"/html5/General/Barcode.ashx",Viewer:y,helper:r,utility:gr.utility,holderIDs:[],insertReportViewer:function(t,r,o,a){var n=e.rubylong.grhtml5.holderIDs,i=n.indexOf(t);return 0>i&&(i=n.length,n.push(t)),new y(i,t,r,o,a)},createReport:function(){return new gr.dom.Report}},ajax:function(e,t,r,o){var a,n,i=new XMLHttpRequest;if(i.onreadystatechange=function(){4==i.readyState&&i.status>0&&t.call(r,i,200==i.status)},i.onerror=function(){t.call(r,i,0)},"string"==typeof e&&(e={url:e}),e.method||(e.method=(n=e.url,o||(/.grf|.txt|.xml|.json/.test(n)?"GET":"POST"))),i.open(e.method,e.url,!0),(a=e.headers)&&"object"==typeof a)for(var l in a)i.setRequestHeader(l,a[l]);i.send(e.data)}},"classList"in document.documentElement||Object.defineProperty(HTMLElement.prototype,"classList",{get:function(){function e(e){return function(r){var o=t.className.split(/\s+/g),a=o.indexOf(r);e(o,a,r),t.className=o.join(" ")}}var t=this;return{add:e((function(e,t,r){~t||e.push(r)})),remove:e((function(e,t){~t&&e.splice(t,1)})),toggle:e((function(e,t,r){~t?e.splice(t,1):e.push(r)})),contains:function(e){return!!~t.className.split(/\s+/g).indexOf(e)},item:function(e){return t.className.split(/\s+/g)[e]||null}}}})}(window);const dataFrom$1="",emptyFlag$1=!1,errorCode$1="0",errorMessage$1="处理成功",success$1=!0,value$1={matchInfoList:[{subMatchList:[{awayTeamAbbName:"菜名1",awayTeamAllName:"菜名1.1",awayTeamCode:"",awayTeamId:751,backColor:"336600",businessDate:"2023-11-06",homeTeamAbbName:"菜名2",homeTeamAllName:"菜名2.1",homeTeamCode:"",homeTeamId:2674,leagueAbbName:"菜系（类）1",leagueAllName:"菜系（类）1.1",leagueId:"1",lineNum:"",matchDate:"2023-11-06",matchId:1021643,matchName:"",matchNum:1001,matchNumStr:"周一001",matchStatus:"Selling",matchTime:"20:00",matchWeek:"",oddsList:[{a:"1.40",d:"4.10",goalLine:"",goalLineF:"",h:"5.55",matchId:0,matchNum:0,odds:"",poolCode:"HAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"TTG",poolId:0,updateDate:"",updateTime:""},{a:"2.31",d:"3.45",goalLine:"+1.00",goalLineF:"",h:"2.40",matchId:0,matchNum:0,odds:"",poolCode:"HHAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"HAFU",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"CRS",poolId:0,updateDate:"",updateTime:""}],poolList:[{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"TTG",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HHAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAFU",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"CRS",poolPrimaryId:0,poolStatus:"Selling"}],poolStatus:"",remark:"",sellStatus:"1",weekday:"周一"},{awayTeamAbbName:"菜3",awayTeamAllName:"菜3.1",awayTeamCode:"",awayTeamId:1009,backColor:"336600",businessDate:"2023-11-06",homeTeamAbbName:"菜4",homeTeamAllName:"菜4.1",homeTeamCode:"",homeTeamId:1034781,leagueAbbName:"类2",leagueAllName:"类2.1",leagueId:"1",lineNum:"",matchDate:"2023-11-06",matchId:1021644,matchName:"",matchNum:1002,matchNumStr:"周一002",matchStatus:"Selling",matchTime:"22:00",matchWeek:"",oddsList:[{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"TTG",poolId:0,updateDate:"",updateTime:""},{a:"2.25",d:"4.55",goalLine:"+3.00",goalLineF:"",h:"2.11",matchId:0,matchNum:0,odds:"",poolCode:"HHAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"HAFU",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"CRS",poolId:0,updateDate:"",updateTime:""}],poolList:[{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"TTG",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HHAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAFU",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"CRS",poolPrimaryId:0,poolStatus:"Selling"}],poolStatus:"",remark:"",sellStatus:"1",weekday:"周一"},{awayTeamAbbName:"菜5",awayTeamAllName:"菜5.1",awayTeamCode:"",awayTeamId:507,backColor:"006633",businessDate:"2023-11-06",homeTeamAbbName:"菜6",homeTeamAllName:"菜6.1",homeTeamCode:"",homeTeamId:511,leagueAbbName:"类3",leagueAllName:"类3.1",leagueId:"62",lineNum:"",matchDate:"2023-11-07",matchId:1021647,matchName:"",matchNum:1005,matchNumStr:"周一005",matchStatus:"Selling",matchTime:"04:00",matchWeek:"",oddsList:[{a:"1.85",d:"3.10",goalLine:"-1.00",goalLineF:"",h:"3.62",matchId:0,matchNum:0,odds:"",poolCode:"HHAD",poolId:0,updateDate:"",updateTime:""},{a:"4.66",d:"3.00",goalLine:"",goalLineF:"",h:"1.69",matchId:0,matchNum:0,odds:"",poolCode:"HAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"HAFU",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"CRS",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"TTG",poolId:0,updateDate:"",updateTime:""}],poolList:[{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HHAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAFU",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"CRS",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"TTG",poolPrimaryId:0,poolStatus:"Selling"}],poolStatus:"",remark:"",sellStatus:"1",weekday:"周一"}],weekday:"周一",matchCount:5},{subMatchList:[{awayTeamAbbName:"菜7",awayTeamAllName:"菜7.1",awayTeamCode:"",awayTeamId:15,backColor:"F75000",businessDate:"2023-11-07",homeTeamAbbName:"菜8",homeTeamAllName:"菜8.1",homeTeamCode:"",homeTeamId:140,leagueAbbName:"类4",leagueAllName:"类4.1",leagueId:"69",lineNum:"",matchDate:"2023-11-08",matchId:1021684,matchName:"",matchNum:2002,matchNumStr:"周二002",matchStatus:"Selling",matchTime:"01:45",matchWeek:"",oddsList:[{a:"1.42",d:"4.25",goalLine:"-1.00",goalLineF:"",h:"5.00",matchId:0,matchNum:0,odds:"",poolCode:"HHAD",poolId:0,updateDate:"",updateTime:""},{a:"2.38",d:"3.35",goalLine:"",goalLineF:"",h:"2.38",matchId:0,matchNum:0,odds:"",poolCode:"HAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"HAFU",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"CRS",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"TTG",poolId:0,updateDate:"",updateTime:""}],poolList:[{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HHAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAFU",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"CRS",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"TTG",poolPrimaryId:0,poolStatus:"Selling"}],poolStatus:"",remark:"",sellStatus:"1",weekday:"周二"},{awayTeamAbbName:"菜9",awayTeamAllName:"菜9.1",awayTeamCode:"",awayTeamId:211,backColor:"F75000",businessDate:"2023-11-07",homeTeamAbbName:"菜10",homeTeamAllName:"菜10.1",homeTeamCode:"",homeTeamId:172,leagueAbbName:"类1",leagueAllName:"类1.1",leagueId:"69",lineNum:"",matchDate:"2023-11-08",matchId:1021687,matchName:"",matchNum:2005,matchNumStr:"周二005",matchStatus:"Selling",matchTime:"04:00",matchWeek:"",oddsList:[{a:"1.85",d:"3.90",goalLine:"-2.00",goalLineF:"",h:"2.93",matchId:0,matchNum:0,odds:"",poolCode:"HHAD",poolId:0,updateDate:"",updateTime:""},{a:"8.50",d:"5.30",goalLine:"",goalLineF:"",h:"1.20",matchId:0,matchNum:0,odds:"",poolCode:"HAD",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"HAFU",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"CRS",poolId:0,updateDate:"",updateTime:""},{a:"",d:"",goalLine:"",goalLineF:"",h:"",matchId:0,matchNum:0,odds:"",poolCode:"TTG",poolId:0,updateDate:"",updateTime:""}],poolList:[{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HHAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:0,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAD",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"HAFU",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"CRS",poolPrimaryId:0,poolStatus:"Selling"},{cbtAllUp:1,cbtSingle:1,cbtValue:1,intAllUp:0,intSingle:0,intValue:2,poolCode:"TTG",poolPrimaryId:0,poolStatus:"Selling"}],poolStatus:"",remark:"",sellStatus:"1",weekday:"周二"}],weekday:"周二",matchCount:5}],matchDateList:[{businessDate:"2023-11-06",businessDateCn:"周一",matchDate:"",matchDateCn:""},{businessDate:"2023-11-07",businessDateCn:"周二",matchDate:"",matchDateCn:""},{businessDate:"2023-11-08",businessDateCn:"周三",matchDate:"",matchDateCn:""},{businessDate:"2023-11-09",businessDateCn:"周四",matchDate:"",matchDateCn:""}],leagueList:[{leagueId:"1",leagueName:"类1.1",leagueNameAbbr:"类1"},{leagueId:"25",leagueName:"类2.1",leagueNameAbbr:"类2"},{leagueId:"40",leagueName:"类3",leagueNameAbbr:"类3.1"},{leagueId:"62",leagueName:"类4",leagueNameAbbr:"类4.1"}],totalCount:25,lastUpdateTime:"2023-11-06 14:10:25"},data1={dataFrom:dataFrom$1,emptyFlag:emptyFlag$1,errorCode:errorCode$1,errorMessage:errorMessage$1,success:success$1,value:value$1},dataFrom="",emptyFlag=!1,errorCode="0",errorMessage="处理成功",success=!0,value={oddsHistory:{awayTeamAllName:"菜1",awayTeamAbbName:"菜1.1",homeTeamAllName:"菜2",crsList:[{s05s00:"1000","s-1sd":"350.0",s02s00f:"0","s-1sh":"200.0",s01s00:"19.00",s05s02:"1000",s05s01:"1000","s-1sa":"25.00",s00s03f:"0",s02s04f:"0",s04s01f:"0",s03s00f:"0",s01s03f:"0",s02s04:"45.00",s02s05:"90.00",s02s02:"20.00",s02s03:"31.00",s05s01f:"0",s02s00:"45.00",s02s01:"21.00",s02s05f:"0",s00s02f:"0",s02s01f:"0",s04s00f:"0",goalLine:"",s03s01f:"0","s-1sdf":"0","s-1shf":"0",s01s02f:"0",s03s03:"80.00",s05s00f:"0",updateDate:"2023-11-06",s03s01:"65.00",s03s02:"70.00",s03s00:"120.0",s00s01f:"0",s02s02f:"0",s00s05f:"0",s00s01:"6.20",s00s00:"13.00",s00s03:"8.50",s01s01f:"0",s00s02:"6.20",s00s05:"34.00",s00s04:"15.00",s01s05f:"0",s03s02f:"0",s04s02:"350.0",s04s01:"350.0",s04s00:"600.0",s00s00f:"0",updateTime:"09:10:23",s00s04f:"0","s-1saf":"0",s02s03f:"0",s04s02f:"0",s01s02:"7.50",s01s01:"9.50",s01s04:"21.00",s01s00f:"0",s01s03:"11.50",s05s02f:"0",s01s05:"45.00",s03s03f:"0",s01s04f:"0"},{s05s00:"900.0","s-1sd":"350.0",s02s00f:"-1","s-1sh":"175.0",s01s00:"18.00",s05s02:"900.0",s05s01:"900.0","s-1sa":"26.00",s00s03f:"0",s02s04f:"1",s04s01f:"-1",s03s00f:"0",s01s03f:"0",s02s04:"48.00",s02s05:"100.0",s02s02:"19.00",s02s03:"31.00",s05s01f:"-1",s02s00:"42.00",s02s01:"20.00",s02s05f:"1",s00s02f:"0",s02s01f:"-1",s04s00f:"-1",goalLine:"",s03s01f:"0","s-1sdf":"0","s-1shf":"-1",s01s02f:"0",s03s03:"80.00",s05s00f:"-1",updateDate:"2023-11-06",s03s01:"65.00",s03s02:"70.00",s03s00:"120.0",s00s01f:"0",s02s02f:"-1",s00s05f:"1",s00s01:"6.20",s00s00:"13.00",s00s03:"8.50",s01s01f:"-1",s00s02:"6.20",s00s05:"36.00",s00s04:"16.00",s01s05f:"1",s03s02f:"0",s04s02:"300.0",s04s01:"300.0",s04s00:"500.0",s00s00f:"0",updateTime:"13:46:49",s00s04f:"1","s-1saf":"1",s02s03f:"0",s04s02f:"-1",s01s02:"7.50",s01s01:"9.00",s01s04:"22.00",s01s00f:"-1",s01s03:"11.50",s05s02f:"-1",s01s05:"48.00",s03s03f:"0",s01s04f:"1"},{s05s00:"800.0","s-1sd":"350.0",s02s00f:"-1","s-1sh":"175.0",s01s00:"16.00",s05s02:"800.0",s05s01:"800.0","s-1sa":"30.00",s00s03f:"1",s02s04f:"0",s04s01f:"-1",s03s00f:"-1",s01s03f:"1",s02s04:"48.00",s02s05:"100.0",s02s02:"18.00",s02s03:"31.00",s05s01f:"-1",s02s00:"35.00",s02s01:"18.00",s02s05f:"0",s00s02f:"1",s02s01f:"-1",s04s00f:"-1",goalLine:"",s03s01f:"-1","s-1sdf":"0","s-1shf":"0",s01s02f:"0",s03s03:"80.00",s05s00f:"-1",updateDate:"2023-11-06",s03s01:"50.00",s03s02:"50.00",s03s00:"100.0",s00s01f:"0",s02s02f:"-1",s00s05f:"0",s00s01:"6.20",s00s00:"13.00",s00s03:"9.25",s01s01f:"-1",s00s02:"6.75",s00s05:"36.00",s00s04:"18.00",s01s05f:"0",s03s02f:"-1",s04s02:"200.0",s04s01:"200.0",s04s00:"400.0",s00s00f:"0",updateTime:"17:03:08",s00s04f:"1","s-1saf":"1",s02s03f:"0",s04s02f:"-1",s01s02:"7.50",s01s01:"8.50",s01s04:"25.00",s01s00f:"-1",s01s03:"12.00",s05s02f:"-1",s01s05:"48.00",s03s03f:"0",s01s04f:"1"},{s05s00:"800.0","s-1sd":"350.0",s02s00f:"-1","s-1sh":"175.0",s01s00:"16.00",s05s02:"800.0",s05s01:"800.0","s-1sa":"35.00",s00s03f:"0",s02s04f:"1",s04s01f:"0",s03s00f:"0",s01s03f:"0",s02s04:"50.00",s02s05:"100.0",s02s02:"18.00",s02s03:"31.00",s05s01f:"0",s02s00:"28.00",s02s01:"16.00",s02s05f:"0",s00s02f:"0",s02s01f:"-1",s04s00f:"0",goalLine:"",s03s01f:"0","s-1sdf":"0","s-1shf":"0",s01s02f:"0",s03s03:"80.00",s05s00f:"0",updateDate:"2023-11-06",s03s01:"50.00",s03s02:"50.00",s03s00:"100.0",s00s01f:"1",s02s02f:"0",s00s05f:"0",s00s01:"6.50",s00s00:"13.00",s00s03:"9.25",s01s01f:"-1",s00s02:"6.75",s00s05:"36.00",s00s04:"21.00",s01s05f:"0",s03s02f:"0",s04s02:"200.0",s04s01:"200.0",s04s00:"400.0",s00s00f:"0",updateTime:"17:11:55",s00s04f:"1","s-1saf":"1",s02s03f:"0",s04s02f:"0",s01s02:"7.50",s01s01:"8.00",s01s04:"25.00",s01s00f:"0",s01s03:"12.00",s05s02f:"0",s01s05:"48.00",s03s03f:"0",s01s04f:"0"}],homeTeamAbbName:"菜2.1",hhadList:[{a:"2.02",updateDate:"2023-11-06",df:"0",d:"3.45",af:"0",h:"2.83",updateTime:"09:10:23",hf:"0",goalLine:"+1"},{a:"2.10",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.68",updateTime:"13:44:00",hf:"-1",goalLine:"+1"},{a:"2.19",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.55",updateTime:"16:53:01",hf:"-1",goalLine:"+1"},{a:"2.27",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.45",updateTime:"16:55:36",hf:"-1",goalLine:"+1"},{a:"2.33",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.38",updateTime:"17:06:29",hf:"-1",goalLine:"+1"},{a:"2.41",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.30",updateTime:"18:36:14",hf:"-1",goalLine:"+1"},{a:"2.53",updateDate:"2023-11-06",df:"0",d:"3.45",af:"1",h:"2.20",updateTime:"19:11:30",hf:"-1",goalLine:"+1"},{a:"2.41",updateDate:"2023-11-06",df:"0",d:"3.45",af:"-1",h:"2.30",updateTime:"19:30:10",hf:"1",goalLine:"+1"},{a:"2.31",updateDate:"2023-11-06",df:"0",d:"3.45",af:"-1",h:"2.40",updateTime:"19:32:51",hf:"1",goalLine:"+1"}],ttgList:[{s3:"3.70",s4:"5.25",updateDate:"2023-11-06",s5:"8.50",s6f:"0",s6:"18.00",s7f:"0",s4f:"0",s7:"32.00",s5f:"0",s2f:"0",s3f:"0",s0f:"0",s1f:"0",updateTime:"09:10:23",goalLine:"",s0:"13.00",s1:"5.25",s2:"3.70"},{s3:"3.70",s4:"5.25",updateDate:"2023-11-06",s5:"9.00",s6f:"0",s6:"18.00",s7f:"0",s4f:"0",s7:"32.00",s5f:"1",s2f:"-1",s3f:"0",s0f:"0",s1f:"1",updateTime:"14:12:03",goalLine:"",s0:"13.00",s1:"5.50",s2:"3.50"},{s3:"3.55",s4:"5.50",updateDate:"2023-11-06",s5:"9.25",s6f:"1",s6:"19.00",s7f:"0",s4f:"1",s7:"32.00",s5f:"1",s2f:"-1",s3f:"-1",s0f:"0",s1f:"0",updateTime:"15:18:21",goalLine:"",s0:"13.00",s1:"5.50",s2:"3.45"},{s3:"3.45",s4:"5.70",updateDate:"2023-11-06",s5:"9.50",s6f:"1",s6:"20.00",s7f:"1",s4f:"1",s7:"33.00",s5f:"1",s2f:"-1",s3f:"-1",s0f:"0",s1f:"1",updateTime:"17:11:25",goalLine:"",s0:"13.00",s1:"5.60",s2:"3.35"},{s3:"3.55",s4:"5.50",updateDate:"2023-11-06",s5:"9.00",s6f:"-1",s6:"18.00",s7f:"-1",s4f:"-1",s7:"30.00",s5f:"-1",s2f:"1",s3f:"1",s0f:"0",s1f:"0",updateTime:"19:25:06",goalLine:"",s0:"13.00",s1:"5.60",s2:"3.50"},{s3:"3.55",s4:"5.50",updateDate:"2023-11-06",s5:"8.70",s6f:"-1",s6:"17.00",s7f:"-1",s4f:"0",s7:"27.00",s5f:"-1",s2f:"1",s3f:"0",s0f:"0",s1f:"0",updateTime:"19:30:47",goalLine:"",s0:"13.00",s1:"5.60",s2:"3.65"}],leagueAbbName:"类1",leagueId:"1",singleList:[{single:0,poolCode:"HAD"},{single:1,poolCode:"TTG"},{single:0,poolCode:"HHAD"},{single:1,poolCode:"HAFU"},{single:1,poolCode:"CRS"}],leagueAllName:"类1.1",hadList:[{a:"1.28",updateDate:"2023-11-06",df:"0",d:"4.40",af:"0",h:"7.65",updateTime:"09:10:23",hf:"0",goalLine:""},{a:"1.28",updateDate:"2023-11-06",df:"1",d:"4.55",af:"0",h:"7.20",updateTime:"13:27:59",hf:"-1",goalLine:""},{a:"1.32",updateDate:"2023-11-06",df:"-1",d:"4.40",af:"1",h:"6.45",updateTime:"13:44:17",hf:"-1",goalLine:""},{a:"1.35",updateDate:"2023-11-06",df:"-1",d:"4.25",af:"1",h:"6.15",updateTime:"16:53:01",hf:"-1",goalLine:""},{a:"1.38",updateDate:"2023-11-06",df:"-1",d:"4.10",af:"1",h:"5.85",updateTime:"16:55:53",hf:"-1",goalLine:""},{a:"1.40",updateDate:"2023-11-06",df:"-1",d:"4.00",af:"1",h:"5.70",updateTime:"17:06:15",hf:"-1",goalLine:""},{a:"1.43",updateDate:"2023-11-06",df:"0",d:"4.00",af:"1",h:"5.25",updateTime:"18:35:56",hf:"-1",goalLine:""},{a:"1.47",updateDate:"2023-11-06",df:"-1",d:"3.90",af:"1",h:"4.95",updateTime:"19:11:23",hf:"-1",goalLine:""},{a:"1.43",updateDate:"2023-11-06",df:"1",d:"4.00",af:"-1",h:"5.25",updateTime:"19:30:03",hf:"1",goalLine:""},{a:"1.40",updateDate:"2023-11-06",df:"1",d:"4.10",af:"-1",h:"5.55",updateTime:"19:32:43",hf:"1",goalLine:""}],homeTeamId:2674,awayTeamId:751,matchId:1021643,hafuList:[{aa:"1.92",dd:"7.00",hh:"14.50",updateDate:"2023-11-06",adf:"0",ad:"21.00",dhf:"0",dh:"17.00",aaf:"0",ah:"60.00",ddf:"0",hhf:"0",daf:"0",updateTime:"09:10:23",hdf:"0",haf:"0",goalLine:"",ha:"28.00",hd:"21.00",da:"3.80",ahf:"0"},{aa:"1.97",dd:"7.00",hh:"13.50",updateDate:"2023-11-06",adf:"-1",ad:"20.00",dhf:"-1",dh:"15.50",aaf:"1",ah:"60.00",ddf:"0",hhf:"-1",daf:"0",updateTime:"12:49:35",hdf:"-1",haf:"0",goalLine:"",ha:"28.00",hd:"20.00",da:"3.80",ahf:"0"},{aa:"2.00",dd:"7.00",hh:"12.00",updateDate:"2023-11-06",adf:"0",ad:"20.00",dhf:"-1",dh:"14.50",aaf:"1",ah:"50.00",ddf:"0",hhf:"-1",daf:"1",updateTime:"16:53:01",hdf:"0",haf:"0",goalLine:"",ha:"28.00",hd:"20.00",da:"3.95",ahf:"-1"},{aa:"2.06",dd:"6.75",hh:"11.50",updateDate:"2023-11-06",adf:"-1",ad:"18.50",dhf:"0",dh:"14.50",aaf:"1",ah:"50.00",ddf:"-1",hhf:"-1",daf:"1",updateTime:"16:56:37",hdf:"-1",haf:"0",goalLine:"",ha:"28.00",hd:"18.50",da:"4.00",ahf:"0"},{aa:"2.10",dd:"6.75",hh:"10.00",updateDate:"2023-11-06",adf:"0",ad:"18.50",dhf:"-1",dh:"13.00",aaf:"1",ah:"40.00",ddf:"0",hhf:"-1",daf:"1",updateTime:"18:36:44",hdf:"0",haf:"1",goalLine:"",ha:"29.00",hd:"18.50",da:"4.25",ahf:"-1"},{aa:"2.20",dd:"6.50",hh:"9.50",updateDate:"2023-11-06",adf:"-1",ad:"18.00",dhf:"-1",dh:"12.00",aaf:"1",ah:"40.00",ddf:"-1",hhf:"-1",daf:"0",updateTime:"19:11:42",hdf:"-1",haf:"0",goalLine:"",ha:"29.00",hd:"18.00",da:"4.25",ahf:"0"},{aa:"2.10",dd:"6.75",hh:"10.00",updateDate:"2023-11-06",adf:"1",ad:"18.50",dhf:"1",dh:"13.00",aaf:"-1",ah:"40.00",ddf:"1",hhf:"1",daf:"0",updateTime:"19:31:04",hdf:"1",haf:"0",goalLine:"",ha:"29.00",hd:"18.50",da:"4.25",ahf:"0"},{aa:"2.00",dd:"6.85",hh:"11.50",updateDate:"2023-11-06",adf:"1",ad:"19.00",dhf:"1",dh:"14.00",aaf:"-1",ah:"40.00",ddf:"1",hhf:"1",daf:"0",updateTime:"19:34:39",hdf:"1",haf:"0",goalLine:"",ha:"29.00",hd:"19.00",da:"4.25",ahf:"0"}]},matchResultList:[],sectionsNo999:""},data2={dataFrom:dataFrom,emptyFlag:emptyFlag,errorCode:errorCode,errorMessage:errorMessage,success:success,value:value};export{data2 as a,data1 as d};
