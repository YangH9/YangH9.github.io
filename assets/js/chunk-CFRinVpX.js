import{f as e,p as l,z as t,j as a,a as n,b as u,c as o,w as s,r,o as m,l as c,y as i,d,F as v,k as f,x as h,v as p,a0 as C,a1 as g,e as _,q as w,s as y,_ as x}from"./index-CxMgZ7OK.js";import{B as k}from"./chunk-C9B8R0dj.js";import{l as b}from"./chunk-BLn3XIeU.js";const A={class:"container"},M={key:0,class:"d_inline ml_2"},j={class:"w_100 d_flex content_between"},X={class:"mines_box"},Y={class:"mines_title"},z={class:"mines_title_num"},T={class:"mines_title_time"},F={class:"mines_body"},H=["onClick","onContextmenu"],D=(e=>(w("data-v-d06b74cc"),e=e(),y(),e))((()=>d("div",{class:"w_100 text_left"},[d("p",null,"规则"),d("p",null,"电脑：左键开地，右键放旗子"),d("p",null,"手机：点击开地，插旗模式级")],-1))),U=x({__name:"minesweeper",setup(w){const y=e("level2"),x=l({level1:{rowCount:9,colCount:9,mCount:10},level2:{rowCount:16,colCount:16,mCount:40},level3:{rowCount:16,colCount:30,mCount:99},custom:{rowCount:15,colCount:15,mCount:20}}),U=l({rowCount:0,colCount:0,mCount:0}),$=e([]),B=l({start:0,end:0,fistXY:[],lastXY:[],timer:null}),E=e([]),O=e([]),R=e([]),S=t((()=>{const{start:e,end:l,timer:t}=B;return e?~~((Date.now()-e)/1e3):l?~~((l-e)/1e3):0})),q=()=>{const{rowCount:e,colCount:l,mCount:t}=x[y.value];U.rowCount=e,U.colCount=l,U.mCount=t,(()=>{const{rowCount:e,colCount:l,mCount:t}=U,a={open:!1,flag:!1,mask:!1},u=Array.from({length:e},(()=>Array.from({length:l},(()=>({num:0,text:()=>"",...a}))))),o=[];Array.from({length:t},((e,t)=>~~(t/l)<u.length&&(u[~~(t/l)][~~(t%l)]={num:9,text:()=>n(r("AThunderboltFilled"),null,null),...a}))),Array.from({length:e},((e,t)=>{Array.from({length:l},((e,l)=>{9===u[t][l].num&&o.push([t,l])}))})),$.value=u,E.value=o,O.value=[]})(),clearTimeout(B.timer),B.start=0,B.end=0,B.fistXY=[],B.lastXY=[],R.value=[]};q();const I=()=>{B.end=Date.now(),clearTimeout(B.timer),E.value.forEach((e=>{L(e)}))},L=e=>{const{rowCount:l,colCount:t}=U,[a,n]=e;$.value[a][n].flag?($.value[a][n].flag=!1,O.value=O.value.filter((l=>l.join("-")!==e.join("-")))):$.value[a][n].open?$.value[a][n].open&&($.value[a][n].mask=!0,setTimeout((()=>{$.value[a][n].mask=!1}),300)):($.value[a][n].open=!0,9!==$.value[a][n].num||B.end?Array.from({length:9},((e,u)=>{const o=a+(u%3-1),s=n+(~~(u/3)-1);o>=0&&o<l&&s>=0&&s<t&&(0===$.value[a][n].num||0===$.value[o][s].num)&&!$.value[o][s].flag&&L([o,s])})):(I(),B.lastXY=e))},G=e=>{0===B.start&&(B.fistXY=e,(()=>{const{fistXY:e}=B,{rowCount:l,colCount:t}=U,a=b.cloneDeep($.value),n=[];if(Array.from({length:l*t},(()=>{let e=~~(Math.random()*l),n=~~(Math.random()*t),u=~~(Math.random()*l),o=~~(Math.random()*t);[a[e][n].num,a[u][o].num]=[a[u][o].num,a[e][n].num],[a[e][n].text,a[u][o].text]=[a[u][o].text,a[e][n].text]})),9===a[e[0]][e[1]].num){const[n,u]=e;Array.from({length:l*t},(()=>1)).some(((e,l)=>{const o=~~(l/t),s=~~(l%t);return 0===a[o][s].num&&9===a[n][u].num&&([a[n][u].num,a[o][s].num]=[a[o][s].num,a[n][u].num],[a[n][u].text,a[o][s].text]=[a[o][s].text,a[n][u].text],!0)}))}Array.from({length:l},((e,u)=>{Array.from({length:t},((e,o)=>{9===a[u][o].num&&(n.push([u,o]),Array.from({length:9},((e,n)=>{const s=u+(n%3-1),r=o+(~~(n/3)-1);s>=0&&s<l&&r>=0&&r<t&&9!==a[s][r].num&&(a[s][r].num++,a[s][r].text=()=>a[s][r].num)})))}))})),$.value=a,E.value=n})(),(()=>{B.start=Date.now();const e=()=>{clearTimeout(B.timer),B.timer=setTimeout((()=>{e()}),1e3)};e()})()),B.end||(L(e),R.value.push(e))},J=e=>{switch(e){case 1:return"blue";case 2:return"green";case 3:return"red";case 4:return"purple";case 5:return"orange";case 6:return"pink";case 7:return"gray";case 8:return"cyan";default:return"black"}},K=({num:e,shadow:l})=>{void 0!==l&&(l=!0);const t=["M168.64699648 438.77532017l-63.01871122 55.82224525-29.91811299-31.66071531c-13.29311689-13.55750495-22.382562-31.69806381-23.59442248-45.25655162-0.64377017-7.53653385 0.07567985-16.5876476 0.64377017-27.19167259l18.25457005-205.19068495c2.00699036-28.66792114 8.48204057-40.71182906 29.27434283-61.84419922l37.3416185-39.23558051 56.95940875 64.87532473-25.94246361 289.68183422z","M129.10967941 883.8829308l-74.41884894 63.39711046-28.668904-34.72820645c-8.33166373-9.0520966-13.93688706-21.13335301-15.11041622-34.69085795-0.53074182-6.05930245 0.34006791-13.5584878 1.17352915-21.13237016l19.31507085-227.837635c2.68810903-21.13138731 8.74741149-37.75736627 21.28372986-49.76294281l51.61955632-48.28767711 51.39153391 52.7940683-26.58623378 300.24752788z","M217.04671908 129.51206133l-59.87554019-63.39711046 30.41052347-31.69904667C205.49718736 14.79909682 218.56228185 8.77812571 244.20202604 8.77812571h273.09418662c24.1625128 0 38.25075957 6.02195396 53.55086684 25.63876135l28.32785325 30.22279812-78.84857744 64.87335901H217.04770195z","M492.71696924 452.37115646l55.21680644 61.88253056-67.26071435 58.81405656 H180.38720213l-56.4669983-58.85238791 67.03367479-61.88253057 h301.76210777z","M452.9506469 894.48597296l60.55764174 70.93462717-30.82823694 27.1543241c-20.9053306 19.61779025-29.72940479 22.64695004-68.92665394 22.64695006 H161.7542328c-37.72001776 0-53.20981608-4.54472256-68.35758079-22.64695006l-23.36738292-25.6770927 81.19661855-72.41087572 H452.9506469z","M536.98771707 147.57694034l77.33399753-64.87434187 25.10900239 28.66988686c10.11161453 12.08027355 15.67948937 24.16152995 16.73999016 36.20445501 0.64377017 7.53653385-0.18969105 15.0730677-0.90914108 24.16251281L636.81828778 392.00320579c-4.24102029 37.72001776-11.853234 54.34599671-32.87257577 72.44920708l-36.31846623 33.1752952-56.46699829-58.85337077 25.82845242-291.19641411z","M497.44941714 592.68455098l67.14670315-60.32961931 33.21362655 34.69085796c9.96025483 10.56569365 15.6785065 24.12418146 17.00437821 39.23558052 0.79611273 9.01278239 0.07567985 18.1022275-0.53074182 28.668904l-19.69248724 223.2919296c-0.45506196 12.08125641-2.68909188 21.13237015-3.82527254 25.63876135-2.23402992 9.0520966-7.57486521 16.62597895-22.98898369 30.18348391l-37.72001774 34.72918931-58.47398865-64.91267322 25.86678377-291.19641412z"];let a={"-":[3],0:[0,1,2,4,5,6],1:[5,6],2:[1,2,3,4,5],3:[2,3,4,5,6],4:[0,3,5,6],5:[0,2,3,4,6],6:[0,1,2,3,4,6],7:[2,5,6],8:[0,1,2,3,4,5,6],9:[0,2,3,4,5,6]};return`${e}`.split("").map((e=>{return o=e,u=l?n(v,null,[n("path",{d:t.join(" "),opacity:"0.4"},null),n("path",{d:(a[o]||[]).map((e=>t[e])).join(" ")},null)]):n("path",{d:(a[o]||[]).map((e=>t[e])).join(" ")},null),n("svg",{viewBox:"0 0 667 1024",xmlns:"http://www.w3.org/2000/svg",width:"0.651em",height:"1em"},[u]);var u,o}))};return(e,l)=>{const t=r("a-radio-button"),w=r("a-radio-group"),b=r("a-input-number"),U=r("a-button"),R=r("a-checkbox"),I=r("AFrownOutlined"),L=r("ASmileOutlined"),N=r("EFlag"),P=r("el-icon"),Q=r("a-card"),V=_("calcHeight");return m(),a("div",A,[n(k,{overlayShow:""}),u((m(),o(Q,{title:"扫雷",hoverable:!0},{extra:s((()=>[n(w,{value:y.value,"onUpdate:value":l[0]||(l[0]=e=>y.value=e),"button-style":"solid",onChange:q},{default:s((()=>[n(t,{value:"level1"},{default:s((()=>[c("基础")])),_:1}),n(t,{value:"level2"},{default:s((()=>[c("中级")])),_:1}),n(t,{value:"level3"},{default:s((()=>[c("专家")])),_:1}),n(t,{value:"custom"},{default:s((()=>[c("自定义")])),_:1})])),_:1},8,["value"]),"custom"===y.value?(m(),a("div",M,[n(b,{value:x.custom.colCount,"onUpdate:value":l[1]||(l[1]=e=>x.custom.colCount=e),min:10,max:30,"addon-before":"横",class:"mr_2",style:{width:"100px"}},null,8,["value"]),n(b,{value:x.custom.rowCount,"onUpdate:value":l[2]||(l[2]=e=>x.custom.rowCount=e),min:10,max:30,"addon-before":"竖",class:"mr_2",style:{width:"100px"}},null,8,["value"]),n(b,{value:x.custom.mCount,"onUpdate:value":l[3]||(l[3]=e=>x.custom.mCount=e),min:1,max:100,"addon-before":"雷",class:"mr_2",style:{width:"100px"}},null,8,["value"]),n(U,{type:"primary",onClick:q},{default:s((()=>[c("确定")])),_:1})])):i("",!0)])),default:s((()=>[d("div",j,[n(R,{value:"flag"},{default:s((()=>[c("插旗")])),_:1}),n(R,{value:"mark"},{default:s((()=>[c("标记")])),_:1})]),d("div",X,[d("div",Y,[d("div",z,[n(K,{num:("   "+(E.value.length-O.value.length)).slice(-3),shadow:""},null,8,["num"])]),d("div",{class:"mines_title_icon",onClick:q},[B.lastXY.length?(m(),o(I,{key:0,style:{background:"#ffff00",borderRadius:"50%"}})):(m(),o(L,{key:1,style:{background:"#ffff00",borderRadius:"50%"}}))]),d("div",T,[n(K,{num:`   ${S.value}`.slice(-3),shadow:""},null,8,["num"])])]),d("div",F,[(m(!0),a(v,null,f($.value,((e,l)=>(m(),a("div",{key:l,class:"mines_row"},[(m(!0),a(v,null,f(e,((e,t)=>(m(),a("div",{key:t,class:"mines_col"},[d("div",{class:h(["mines_item",e.open?"":"close",(e.mask,"mask"),B.end?"over":"",B.lastXY.join("-")===`${l}-${t}`?"fail":""]),style:p({color:e.flag?"#000":J(e.num)}),onClick:e=>G([l,t]),onContextmenu:C((e=>(e=>{if(!B.end){const[l,t]=e;!$.value[l][t].flag&&E.value.length>O.value.length&&($.value[l][t].flag=!0,O.value.push(e))}})([l,t])),["prevent","stop"])},[e.open?(m(),o(g(e.text),{key:0})):i("",!0),e.flag?(m(),o(P,{key:1,color:"#dd0c0c"},{default:s((()=>[n(N)])),_:1})):i("",!0)],46,H)])))),128))])))),128))])]),D])),_:1})),[[V,{height:21,dom:".ant-card-body"}]])])}}},[["__scopeId","data-v-d06b74cc"]]);export{U as default};
